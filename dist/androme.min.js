!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).androme={})}(this,function(e){"use strict";var t,i,n;!function(e){e[e.NONE=0]="NONE",e[e.DOM_TRAVERSE=2]="DOM_TRAVERSE",e[e.EXTENSION=4]="EXTENSION",e[e.RENDER=8]="RENDER",e[e.ALL=14]="ALL"}(t||(t={})),function(e){e[e.NONE=0]="NONE",e[e.BOX_STYLE=2]="BOX_STYLE",e[e.BOX_SPACING=4]="BOX_SPACING",e[e.FONT_STYLE=8]="FONT_STYLE",e[e.VALUE_STRING=16]="VALUE_STRING",e[e.IMAGE_SOURCE=32]="IMAGE_SOURCE",e[e.ASSET=56]="ASSET",e[e.ALL=126]="ALL"}(i||(i={})),function(e){e[e.NONE=0]="NONE",e[e.CONSTRAINT=2]="CONSTRAINT",e[e.LAYOUT=4]="LAYOUT",e[e.ALIGNMENT=8]="ALIGNMENT",e[e.AUTOFIT=16]="AUTOFIT",e[e.OPTIMIZATION=32]="OPTIMIZATION",e[e.CUSTOMIZATION=64]="CUSTOMIZATION",e[e.ACCESSIBILITY=128]="ACCESSIBILITY",e[e.LOCALIZATION=256]="LOCALIZATION",e[e.POSITIONAL=46]="POSITIONAL",e[e.NONPOSITIONAL=464]="NONPOSITIONAL",e[e.ALL=510]="ALL"}(n||(n={}));var s=Object.freeze({get APP_SECTION(){return t},get NODE_RESOURCE(){return i},get NODE_PROCEDURE(){return n}});const r=new Map([[2,"marginTop"],[4,"marginRight"],[8,"marginBottom"],[16,"marginLeft"],[32,"paddingTop"],[64,"paddingRight"],[128,"paddingBottom"],[256,"paddingLeft"]]),a=["ADDRESS","ARTICLE","ASIDE","BLOCKQUOTE","CANVAS","DD","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","H1","H2","H3","H4","H5","H6","HEADER","LI","MAIN","NAV","OL","OUTPUT","P","PRE","SECTION","TFOOT","TH","THEAD","TR","UL","VIDEO"],o=["A","ABBR","ACRONYM","B","BDO","BIG","BR","BUTTON","CITE","CODE","DFN","EM","I","IFRAME","IMG","INPUT","KBD","LABEL","MAP","OBJECT","Q","S","SAMP","SCRIPT","SELECT","SMALL","SPAN","STRIKE","STRONG","SUB","SUP","TEXTAREA","TIME","TT","U","VAR","PLAINTEXT"],l={ACCESSIBILITY:"androme.accessibility",CSS_GRID:"androme.css-grid",EXTERNAL:"androme.external",FLEXBOX:"androme.flexbox",GRID:"androme.grid",LIST:"androme.list",RELATIVE:"androme.relative",SPRITE:"androme.sprite",SUBSTITUTE:"androme.substitute",TABLE:"androme.table",VERTICAL_ALIGN:"androme.verticalalign",WHITESPACE:"androme.whitespace"},c={CSS_URL:/url\("?(.*?)"?\)/,LINK_HREF:/url\("?#(.*?)"?\)/,URI:/^[A-Za-z]+:\/\//,UNIT:/^(?:\s*(-?[\d.]+)(px|em|ch|pc|pt|vw|vh|vmin|vmax|mm|cm|in))+$/};var h=Object.freeze({CSS_SPACING:r,ELEMENT_BLOCK:a,ELEMENT_INLINE:o,EXT_NAME:l,REGEX_PATTERN:c});const d="ABCDEFGHIJKLMNOPQRSTUVWXYZ",u=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];function p(e,t,...i){return e.sort((e,n)=>{for(const s of i){const i=f(e,n,s,!0);if(i&&i[0]!==i[1])return 1===t?i[0]>i[1]?1:-1:i[0]<i[1]?1:-1}return 0})}function f(e,t,i,n){const s=i.split(".");let r=e,a=t;for(const e of s){if(void 0===r[e]||void 0===a[e])return(void 0!==r[e]||void 0!==a[e])&&(void 0!==r[e]?[1,0]:[0,1]);r=r[e],a=a[e]}if(n){const e=parseInt(r),t=parseInt(a);if(!isNaN(e)&&!isNaN(t))return[e,t];if(!isNaN(e))return[1,0];if(!isNaN(t))return[0,1]}return[r,a]}function g(e,t=!0){return""!==e?t?e.charAt(0).toUpperCase()+e.substring(1).toLowerCase():e.charAt(0).toLowerCase()+e.substring(1):e}function m(e,t="-"){const i=e.replace(RegExp(`^${t}+`),"").match(RegExp(`(${t}[a-z])`,"g"));return i&&i.forEach(t=>e=e.replace(t,t[1].toUpperCase())),e}function b(e){return e?e.replace(/[^\w]/g,"_").trim():""}function y(e,t="deg"){let i=parseFloat(e);switch(t){case"rad":i*=180/Math.PI;break;case"grad":i/=400;case"turn":i*=360}return i}function v(e){return e&&parseInt(e)||0}function x(e){return e&&parseFloat(e)||0}function S(e,t){if(e){if(k(e))return`${Math.round(e)}px`;if((e=e.trim()).endsWith("px")||e.endsWith("%")||"auto"===e)return e;const i=e.match(c.UNIT);if(i){let e=parseFloat(i[1]);switch(i[2]){case"em":case"ch":e*=t||16;break;case"pc":e*=12;case"pt":e*=4/3;break;case"vw":e*=window.innerWidth/100;break;case"vh":e*=window.innerHeight/100;break;case"vmin":e*=Math.min(window.innerWidth,window.innerHeight)/100;break;case"vmax":e*=Math.max(window.innerWidth,window.innerHeight)/100;break;case"mm":e/=10;case"cm":e/=2.54;case"in":e*=96*window.devicePixelRatio}return`${e}px`}}return"0px"}function A(e,t=0){return e<1?`${0===t?Math.round(100*e):parseFloat((100*e).toFixed(t))}%`:"100%"}function E(e){let t="";for(;e>=d.length;){const i=Math.floor(e/d.length);i>1&&i<=d.length?(t+=d.charAt(i-1),e-=i*d.length):i>d.length&&(t+=E(i*d.length),e-=i*d.length);const n=e%d.length;t+=d.charAt(n),e-=n+d.length}return t=d.charAt(e)+t}function w(e){const t=(""+e).split("");let i="",n=3;for(;n--;)i=(u[parseInt(t.pop()||"")+10*n]||"")+i;return"M".repeat(parseInt(t.join("")))+i}function _(e){return`${isNaN(e=parseFloat(e))?0:Math.round(e)}px`}function T(e){return isNaN(e=parseFloat(e))?"0%":e<1?A(e):`${Math.round(e)}%`}function I(e,t){return(e&t)===t}function k(e){return"number"==typeof e||/^-?\d+(\.\d+)?$/.test(e.trim())}function C(e){return"string"==typeof e&&""!==e}function N(e){return Array.isArray(e)&&e.length>0}function B(e){return c.UNIT.test(e)}function M(e){return/^\d+(\.\d+)?%$/.test(e)}function R(e,t,i=","){return!!e&&e.split(i).map(e=>e.trim()).includes(t)}function F(e,t,i){let n,s=!1;if(e&&"object"==typeof e){n=e;const i=t.split(".");let r=0;do{n=n[i[r]]}while(null!=n&&++r<i.length&&"string"!=typeof n&&"number"!=typeof n&&"boolean"!=typeof n);s=null!=n&&r===i.length}switch(i){case"object":return s?n:null;case"number":return s&&!isNaN(parseInt(n))?parseInt(n):0;case"boolean":return s&&!0===n;default:return s?""+n:""}}function L(e){if(!c.URI.test(e)){let t=location.pathname.split("/");if(t.pop(),"/"===e.charAt(0))e=location.origin+e;else if(e.startsWith("../")){const i=[];let n=0;e.split("/").forEach(e=>{".."===e?n++:i.push(e)}),(t=t.slice(0,Math.max(t.length-n,0))).push(...i),e=location.origin+t.join("/")}else e=`${location.origin+t.join("/")}/${e}`}return e}function D(e){return e?e.trim():""}function P(e,t){return e?V(O(e,t),t):""}function V(e,t){return e?e.replace(RegExp(`^${t}+`,"g"),""):""}function O(e,t){return e?e.replace(RegExp(`${t}+$`,"g"),""):""}function G(e,t="\t"){return t.repeat(e)}function H(e,t="/"){return e.substring(e.lastIndexOf(t)+1)}function $(e){return e.length?Math.min.apply(null,e):Number.MAX_VALUE}function W(e){return e.length?Math.max.apply(null,e):-1*Number.MAX_VALUE}function z(e,t){const i=[];if("object"==typeof t)for(const n in t){const s=t[n];X(e[s])&&i.push([s,e[s]])}else{let n=e=>e===t;/^\*.+\*$/.test(t)?n=(e=>-1!==e.indexOf(t.replace(/\*/g,""))):/^\*/.test(t)?n=(e=>e.endsWith(t.replace(/\*/,""))):/\*$/.test(t)&&(n=(e=>e.startsWith(t.replace(/\*/,""))));for(const t in e)n(t)&&i.push([t,e[t]])}return i}function X(e){return null!=e&&""!==(""+e).trim()}function U(e,t){return e===t||Math.floor(e)===Math.floor(t)||Math.ceil(e)===Math.ceil(t)||Math.ceil(e)===Math.floor(t)||Math.floor(e)===Math.ceil(t)}function j(e,t){for(const i in t)X(e[i])||(e[i]=t[i])}function Y(e,t){const i=[];for(let n=0;n<e.length;n++)t(e[n],n,e)&&i.push(e[n]);return i}function q(e,t){const i=[],n=[];for(let s=0;s<e.length;s++){const r=e[s];t(r,s,e)?i.push(r):n.push(r)}return[i,n]}function K(e,t){return e.map((i,n)=>t(i,n,e)).filter(e=>X(e))}function Z(e,...t){return p(e,1,...t)}var Q=Object.freeze({formatString:function(e,...t){for(let i=0;i<t.length;i++)e=e.replace(`{${i}}`,t[i]);return e},capitalize:g,convertUnderscore:function(e){const t=(e=e.charAt(0).toLowerCase()+e.substring(1)).match(/([a-z][A-Z])/g);return t&&t.forEach(t=>e=e.replace(t,`${t[0]}_${t[1].toLowerCase()}`)),e},convertCamelCase:m,convertWord:b,convertAngle:y,convertInt:v,convertFloat:x,convertPX:S,convertPercent:A,convertAlpha:E,convertRoman:w,convertEnum:function(e,t,i){for(const n of Object.keys(t))if(e===t[n])return i[n];return""},formatPX:_,formatPercent:T,hasBit:I,isNumber:k,isString:C,isArray:N,isUnit:B,isPercent:M,includes:R,optional:F,optionalAsObject:function(e,t){return F(e,t,"object")},optionalAsString:function(e,t){return F(e,t,"string")},optionalAsNumber:function(e,t){return F(e,t,"number")},optionalAsBoolean:function(e,t){return F(e,t,"boolean")},resolvePath:L,trimNull:D,trimString:P,trimStart:V,trimEnd:O,repeat:G,indexOf:function(e,...t){for(const i of t){const t=e.indexOf(i);if(-1!==t)return t}return-1},lastIndexOf:H,minArray:$,maxArray:W,hasSameValue:function(e,t,...i){for(const n of i){const i=f(e,t,n,!1);if(!i||i[0]!==i[1])return!1}return!0},searchObject:z,hasValue:X,withinRange:function(e,t,i=0){return t>=e-i&&t<=e+i},withinFraction:U,assignWhenNull:j,defaultWhenNull:function(e,...t){let i=e;for(let e=0;e<t.length-1;e++){const n=t[e];if(e===t.length-2)X(i[n])||(i[n]=t[e+1]);else{if(!C(n))break;if("object"==typeof i[n])i=i[n];else{if(void 0!==i[n])break;i[n]={},i=i[n]}}}},filterArray:Y,partition:q,flatArray:function(e){let t=e;for(;t.some(e=>Array.isArray(e));)t=[].concat.apply([],t.filter(e=>e));return t},flatMap:K,sortAsc:Z,sortDesc:function(e,...t){return p(e,2,...t)}});class J{constructor(e){this._children=[],Array.isArray(e)&&this.retain(e)}[Symbol.iterator](){const e=this._children;let t=0;return{next:()=>t<e.length?{done:!1,value:e[t++]}:{done:!0,value:void 0}}}item(e,t){return void 0===e||void 0===t?void 0===e?this._children[this._children.length-1]:this._children[e]:e>=0&&e<this._children.length?(this._children[e]=t,t):void 0}append(e){return this._children.push(e),this}remove(e){for(let t=0;t<this._children.length;t++)if(e===this._children[t])return this._children.splice(t,1);return[]}contains(e){return this._children.includes(e)}retain(e){return this._children=e,this}duplicate(){return this._children.slice(0)}clear(){return this._children.length=0,this}each(e){return this._children.forEach(e),this}find(e,t){return this._children.find("string"==typeof e?i=>i[e]===t:e)}filter(e){return this._children.filter(e)}map(e){return this._children.map(e)}flatMap(e){return this._children.map(e).filter(e=>e)}partition(e){return q(this._children,e)}sort(e){return this._children.sort(e),this}every(e){return this.length>0&&this._children.every(e)}some(e){return this._children.some(e)}get children(){return this._children}get length(){return this._children.length}}function ee(e){let t=2;return-1!==navigator.userAgent.indexOf("Edge")?t=8:-1!==navigator.userAgent.indexOf("Firefox")?t=16:-1===navigator.userAgent.indexOf("Chrome")&&-1!==navigator.userAgent.indexOf("Safari")&&(t=4),I(e,t)}function te(e,t,i,n,s){if(void 0===n&&(n=he(e)),"inherit"===i&&(i=be(e.parentElement,t)),"initial"!==i){if(i!==n[t])switch(t){case"backgroundColor":case"borderTopColor":case"borderRightColor":case"borderBottomColor":case"borderLeftColor":case"color":case"fontSize":case"fontWeight":return n[t]||i;case"width":case"height":case"minWidth":case"maxWidth":case"minHeight":case"maxHeight":case"lineHeight":case"verticalAlign":case"textIndent":case"columnGap":case"top":case"right":case"bottom":case"left":case"marginTop":case"marginRight":case"marginBottom":case"marginLeft":case"paddingTop":case"paddingRight":case"paddingBottom":case"paddingLeft":return/^[A-Za-z\-]+$/.test(i)||M(i)?i:S(i,s)}return i}return""}function ie(e,t){const i={};if(Ie(e)||e instanceof SVGElement){t=m(t,"\\.");for(const n in e.dataset)n.length>t.length&&n.startsWith(t)&&(i[g(n.substring(t.length),!1)]=e.dataset[n])}return i}function ne(){return{top:0,left:0,right:0,bottom:0}}function se(){return Object.assign({width:0,height:0},{top:0,left:0,right:0,bottom:0})}function re(e,t=!1){const i=document.createElement(t?"div":"span"),n=i.style;return n.position="static",n.margin="0px",n.padding="0px",n.border="none",n.cssFloat="none",n.clear="none",n.display="none",i.className="__css.placeholder",e instanceof HTMLElement&&e.appendChild(i),i}function ae(e){Array.from(document.getElementsByClassName(e)).forEach(e=>e.parentElement&&e.parentElement.removeChild(e))}function oe(e,t,i,n=!1){return n?M(e)?v(e)/100:parseFloat(S(e,i))/t:M(e)?Math.round(t*(v(e)/100)):parseInt(S(e,i))}function le(e){const t=document.createRange();t.selectNodeContents(e);const i=Array.from(t.getClientRects()).filter(e=>!(0===Math.round(e.width)&&U(e.left,e.right)));let n=se(),s=0;if(i.length){n=ce(i[0]);const t=new Set([n.top]),r=new Set([n.bottom]);for(let e=1;e<i.length;e++){const s=i[e];t.add(s.top),r.add(s.bottom),n.width+=s.width,n.right=Math.max(s.right,n.right),n.height=Math.max(s.height,n.height)}t.size>1&&r.size>1&&(n.top=$(Array.from(t)),n.bottom=W(Array.from(r)),i[i.length-1].top>=i[0].bottom&&e.textContent&&(""!==e.textContent.trim()||/^\s*\n/.test(e.textContent))&&(s=i.length-1))}return Object.assign(n,{multiLine:s})}function ce(e){return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}}function he(e,t=!0){if(e){if(t){const t=Ne(e,"style");if(t)return t;{const t=Me(e);if(t){if(t.style)return t.style;if(t.plainText)return t.unsafe("styleMap")}}}if("#"!==e.nodeName.charAt(0)){const t=getComputedStyle(e);return Ce(e,"style",t),t}return{}}return{display:"none"}}function de(e){const t=e.match(c.CSS_URL);return t?L(t[1]):""}function ue(e,t,...i){return!("#"===e.nodeName.charAt(0)||!i.includes(he(e)[t]))||!!e.parentElement&&i.includes(he(e.parentElement)[t])}function pe(e,t){if(e.parentElement&&Ie(e)){const i=Me(e),n=he(e);if(i&&n)return n[t]===he(e.parentElement)[t]&&!i.cssInitial(t)}return!1}function fe(e,t){let i="";if("object"==typeof e.style&&(i=e.style[t]),!i){const n=Ne(e,"styleMap");n&&(i=n[t])}return i||""}function ge(e,t,i=!1){const n=Me(e),s=m(t);return n&&n.cssInitial(s)||fe(e,s)||ye(e,t)||i&&he(e)[s]||""}function me(e,t){let i=e,n="";for(;i&&(""===(n=ge(i,t))||"inherit"===n);)i=i.parentElement;return n}function be(e,t,i,n){let s="";if(e){let r=e.parentElement;for(;r&&(void 0===n||!n.includes(r.tagName))&&(("inherit"===(s=he(r)[t])||i&&i.some(e=>-1!==s.indexOf(e)))&&(s=""),r!==document.body&&!s);)r=r.parentElement}return s||""}function ye(e,t){if(e){const i=e.attributes.getNamedItem(t);if(i)return i.value.trim()}return""}function ve(e,t,i,n=!1,s=!1){const r={top:0,left:0,right:0,bottom:0,horizontal:"left",vertical:"top",originalX:"",originalY:""},a="center"===e?["center","center"]:e.split(" ");return 4===a.length?a.forEach((e,a)=>{switch(a){case 0:r.horizontal=e;break;case 2:r.vertical=e;break;case 1:case 3:const o=oe(e,1===a?t.width:t.height,i,s);1===a?n?"right"===r.horizontal?(r.originalX=M(e)?T(100-parseInt(e)):_(t.width-parseInt(S(e,i))),r.right=o,r.left=s?1-o:t.width-o):(r.left=o,r.originalX=e):"center"!==r.horizontal&&(r[r.horizontal]=o):n?"bottom"===r.vertical?(r.originalY=M(e)?T(100-parseInt(e)):_(t.height-parseInt(S(e,i))),r.bottom=o,r.top=s?1-o:t.height-o):(r.top=o,r.originalY=e):"center"!==r.vertical&&(r[r.vertical]=o)}}):2===a.length&&a.forEach((e,a)=>{const o=0===a?t.width:t.height,l=0===a?"left":"top",c=0===a?"originalX":"originalY",h=oe(e,o,i,s);if(M(e))r[l]=h,r[c]=e;else if(/^[a-z]+$/.test(e)){if(r[0===a?"horizontal":"vertical"]=e,n)switch(e){case"left":case"top":r[c]="0%";break;case"right":case"bottom":r[l]=s?1:o,r[c]="100%";break;case"center":r[l]=s?.5:Math.round(o/2),r[c]="50%"}}else r[l]=h,r[c]=e}),r}function xe(e,t=!1){if(e instanceof HTMLElement)for(let i=e.childNodes.length-1;i>=0;i--){const n=Me(e.childNodes[i]);if(n&&(!n.excluded||t&&n.lineBreak))return n.element}return null}function Se(e,t=!0){function i(e){return e.some(e=>{if("#text"===e.nodeName){if(Ae(e,t)||ue(e,"whiteSpace","pre","pre-wrap")&&e.textContent&&""!==e.textContent)return!0}else if(e instanceof HTMLElement&&ke(e)&&e.childNodes.length&&i(Array.from(e.childNodes)))return!0;return!1})}return i("#text"===e.nodeName?[e]:Array.from(e.childNodes))}function Ae(e,t=!1){if(e&&"#text"===e.nodeName&&e.textContent){if(t){const t=e.textContent;let i=!1;for(let e=0;e<t.length;e++)switch(t.charCodeAt(e)){case 9:case 10:case 13:case 32:continue;default:i=!0}return i&&""!==t}return""!==e.textContent.trim()}return!1}function Ee(e,t=!1,i=!1){if(e){let n=e.textContent||"";if(i&&(n=n.trim()),e instanceof HTMLElement&&e.children.length&&Array.from(e.children).some(e=>"BR"===e.tagName))return!0;if(!t&&/\n/.test(n)){const t=Me(e),i=t?t.css("whiteSpace"):he(e).whiteSpace||"";return["pre","pre-wrap"].includes(i)||"#text"===e.nodeName&&ue(e,"whiteSpace","pre","pre-wrap")}}return!1}function we(e,t=!0){const i=Me(e);return!!i&&("BR"===i.tagName||t&&i.excluded&&i.blockStatic)}function _e(e){for(e=e.previousSibling;e;){const t=Me(e);if(t&&(!t.excluded||t.lineBreak))return t.element;e=e.previousSibling}return null}function Te(e){for(e=e.nextSibling;e;){const t=Me(e);if(t&&(!t.excluded||t.lineBreak))return t.element;e=e.nextSibling}return null}function Ie(e){return e instanceof HTMLElement||e instanceof SVGSVGElement}function ke(e){const t=e.getBoundingClientRect();return 0!==t.width&&0!==t.height&&!(t.left<0&&t.top<0&&Math.abs(t.left)>=t.width&&Math.abs(t.top)>=t.height)}function Ce(e,t,i){e[`__${t}`]=i}function Ne(e,t){return e[`__${t}`]||void 0}function Be(e,...t){for(const i of t)delete e[`__${i}`]}function Me(e){return C(e.className)&&e.className.startsWith("androme")?void 0:Ne(e,"node")}var Re=Object.freeze({isUserAgent:ee,checkStyleAttribute:te,getDataSet:ie,newBoxRect:ne,newRectDimension:se,newBoxModel:function(){return{marginTop:0,marginRight:0,marginBottom:0,marginLeft:0,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0}},createElement:re,removeElementsByClassName:ae,convertClientUnit:oe,getRangeClientRect:le,assignBounds:ce,getStyle:he,getBoxSpacing:function(e){const t={},i=Me(e)||he(e);for(const e of r.values())t[e]=v(i[e]);return t},cssResolveUrl:de,cssParent:ue,cssFromParent:pe,cssInline:fe,cssAttribute:ge,cssInheritAttribute:me,cssInheritStyle:be,getNamedItem:ye,getBackgroundPosition:ve,getFirstChildElement:function(e,t=!1){if(e instanceof HTMLElement)for(let i=0;i<e.childNodes.length;i++){const n=Me(e.childNodes[i]);if(n&&(!n.excluded||t&&n.lineBreak))return n.element}return null},getLastChildElement:xe,hasFreeFormText:Se,isPlainText:Ae,hasLineBreak:Ee,isLineBreak:we,getElementsBetween:function(e,t,i=!1,n=!1){if(!e||e.parentElement===t.parentElement){const s=t.parentElement;if(s){const r=Array.from(s.childNodes),a=e?r.findIndex(t=>t===e):0,o=r.findIndex(e=>e===t);if(-1!==a&&-1!==o&&a!==o){let e=r.slice(Math.min(a,o)+1,Math.max(a,o));return e=e.filter(i?e=>"#comment"!==e.nodeName:e=>"#"!==e.nodeName.charAt(0)||Ae(e)),n&&(e=e.filter(e=>Me(e))),e}}}return[]},getPreviousElementSibling:_e,getNextElementSibling:Te,hasComputedStyle:Ie,withinViewportOrigin:ke,setElementCache:Ce,getElementCache:Ne,deleteElementCache:Be,getElementAsNode:Me});class Fe extends J{constructor(e){super(e),this._currentId=0}static actualParent(e){for(const t of e)if(t.naturalElement&&t.actualParent)return t.actualParent}static baseline(e,t=!1){let i=e.filter(e=>{if(e.baseline||B(e.verticalAlign)&&"0px"!==e.verticalAlign){const t=e.cssInitial("position");return"absolute"!==t&&"fixed"!==t}return!1});i.length&&(e=i),(i=e.filter(e=>e.textElement||"text-top"!==e.verticalAlign&&"text-bottom"!==e.verticalAlign)).length&&(e=i),t&&(e=e.filter(e=>e.baseElement&&!e.imageElement));const n=W(e.map(e=>e.lineHeight)),s=W(e.map(e=>e.bounds.height));return e.filter(e=>n>s?e.lineHeight===n:e.bounds.height===s).sort((e,t)=>{if(e.groupParent||e.length>0||!e.baseline&&t.baseline)return 1;if(t.groupParent||t.length>0||e.baseline&&!t.baseline)return-1;if(!e.imageElement||!t.imageElement){if(e.multiLine||t.multiLine){if(e.lineHeight&&t.lineHeight)return e.lineHeight<=t.lineHeight?1:-1;if(e.fontSize===t.fontSize)return e.htmlElement||!t.htmlElement?-1:1}if(e.containerType!==t.containerType)return e.textElement||e.imageElement?-1:t.textElement||t.imageElement?1:e.containerType<t.containerType?-1:1;if(t.imageElement)return-1;if(e.imageElement)return 1;if(e.fontSize===t.fontSize)return e.htmlElement&&!t.htmlElement?-1:!e.htmlElement&&t.htmlElement?1:e.siblingIndex>=t.siblingIndex?1:-1;if(e.fontSize!==t.fontSize&&e.fontSize>0&&t.fontSize>0)return e.fontSize>t.fontSize?-1:1}return 0})}static floated(e){return new Set(e.map(e=>e.float).filter(e=>"none"!==e))}static cleared(e,t=!0){if(t&&e.length>1){e.slice(0).sort(this.siblingIndex);const t=this.actualParent(e);if(t){const i=[],n=e[e.length-1];let s=!1;for(let r=0;r<t.element.childNodes.length;r++){const a=Me(t.element.childNodes[r]);if(a&&(a===e[0]&&(s=!0),s&&i.push(a),a===n))break}i.length>=e.length&&(e=i)}}const i=new Map,n=new Set,s={left:null,right:null};for(const t of e)if(t.pageFlow){const e=t.css("clear");if(n.size){("both"===e?[s.left,s.right]:"left"===e?[s.left,null]:"right"===e?[null,s.right]:[]).forEach(e=>{e&&!t.floating&&t.linear.top>e.linear.bottom&&n.has(e.float)&&(n.delete(e.float),s[e.float]=null)}),"both"===e?(i.set(t,2===n.size?"both":n.values().next().value),n.clear(),s.left=null,s.right=null):n.has(e)&&(i.set(t,e),n.delete(e),s[e]=null)}t.floating&&(n.add(t.float),s[t.float]=t)}return i}static floatedAll(e){return this.floated(e.actualChildren.filter(e=>e.pageFlow))}static clearedAll(e){return this.cleared(e.actualChildren.filter(e=>e.pageFlow),!1)}static linearX(e){const t=e.filter(e=>e.pageFlow).sort(Fe.siblingIndex);switch(t.length){case 0:return!1;case 1:return!0;default:const e=this.actualParent(t);if(e){const i=this.clearedAll(e);for(let e=1;e<t.length;e++)if(t[e].alignedVertically(t[e].previousSiblings(),void 0,i))return!1;let n=Number.MAX_VALUE,s=-Number.MAX_VALUE,r=-Number.MAX_VALUE,a=Number.MAX_VALUE;for(const e of t)n=Math.min(n,e.linear.left),s=Math.max(s,e.linear.right),e.floating&&("left"===e.float?r=Math.max(r,e.linear.right):a=Math.min(a,e.linear.left));for(let e=0,i=0,o=0,l=0,c=0;e<t.length;e++){const h=t[e];if(Math.floor(h.linear.left)<=n&&i++,Math.ceil(h.linear.right)>=s&&o++,h.floating||(h.linear.left===r&&l++,h.linear.right===a&&c++),0===e)continue;if(2===i||2===o||2===l||2===c)return!1;const d=t[e-1];if(d.floating&&h.linear.top>=d.linear.bottom||U(h.linear.left,d.linear.left))return!1}return!0}return!1}}static linearY(e){const t=e.filter(e=>e.pageFlow).sort(Fe.siblingIndex);switch(t.length){case 0:return!1;case 1:return!0;default:const e=this.actualParent(t);if(e){const i=this.clearedAll(e);for(let e=1;e<t.length;e++)if(!t[e].alignedVertically(t[e].previousSiblings(),t,i))return!1;return!0}return!1}}static partitionRows(e){const[t,i]=(()=>{const t=this.actualParent(e);return t?[t.actualChildren,this.clearedAll(t)]:[e,this.cleared(e)]})(),n=[];let s=[];for(let r=0;r<t.length;r++){const a=t[r],o=a.previousSiblings();0===r||0===o.length?e.includes(a)&&s.push(a):a.alignedVertically(o,s,i)?(s.length&&n.push(s),s=e.includes(a)?[a]:[]):e.includes(a)&&s.push(a),r===t.length-1&&s.length&&n.push(s)}return n}static siblingIndex(e,t){return e.siblingIndex>=t.siblingIndex?1:-1}append(e,t=!0){return super.append(e),t&&this.afterAppend&&this.afterAppend.call(this,e),this}reset(){return this._currentId=0,this.clear(),this}get visible(){return this.children.filter(e=>e.visible)}get elements(){return this.children.filter(e=>e.visible&&e.styleElement)}get nextId(){return++this._currentId}}class Le extends J{constructor(e,t,i=0,n=0,s=0,r){super(r),this.parent=e,this.node=t,this.containerType=i,this.alignmentType=n,this.itemCount=s,this.rowCount=0,this.columnCount=0,this.renderType=0,this.renderPosition=!1}init(){this.floated=this.getFloated(),this.cleared=this.getCleared(),this.linearX=this.isLinearX()}initParent(){this.floated=this.getFloated(!0),this.cleared=this.getCleared(!0),this.linearX=this.isLinearX()}setType(e,...t){this.containerType=e;for(const e of t)this.add(e)}add(e){return this.alignmentType|=e,this.alignmentType}retain(e){return super.retain(e),this.itemCount=e.length,this}delete(e){return I(this.alignmentType,e)&&(this.alignmentType^=e),this.alignmentType}getFloated(e=!1){return e?Fe.floatedAll(this.parent):Fe.floated(this.children)}getCleared(e=!1){return e?Fe.clearedAll(this.parent):Fe.cleared(this.children)}isLinearX(){return Fe.linearX(this.children)}isLinearY(){return Fe.linearY(this.children)}set floated(e){e.size?this.add(64):this.delete(64),this.every(e=>"right"===e.float)?this.add(512):this.delete(512),this._floated=e}get floated(){return this._floated||this.getFloated()}set cleared(e){this._cleared=e}get cleared(){return this._cleared||this.getCleared()}get visible(){return this.children.filter(e=>e.visible)}set linearX(e){this._linearX=e}get linearX(){return this._linearX||this.isLinearX()}set linearY(e){this._linearY=e}get linearY(){return this._linearY||this.isLinearY()}}const De="0123456789ABCDEF",Pe={Pink:{value:"#FFC0CB"},LightPink:{value:"#FFB6C1"},HotPink:{value:"#FF69B4"},DeepPink:{value:"#FF1493"},PaleVioletRed:{value:"#DB7093"},MediumVioletRed:{value:"#C71585"},LightSalmon:{value:"#FFA07A"},Salmon:{value:"#FA8072"},DarkSalmon:{value:"#E9967A"},LightCoral:{value:"#F08080"},IndianRed:{value:"#CD5C5C"},Crimson:{value:"#DC143C"},Firebrick:{value:"#B22222"},DarkRed:{value:"#8B0000"},Red:{value:"#FF0000"},OrangeRed:{value:"#FF4500"},Tomato:{value:"#FF6347"},Coral:{value:"#FF7F50"},Orange:{value:"#FFA500"},DarkOrange:{value:"#FF8C00"},Yellow:{value:"#FFFF00"},LightYellow:{value:"#FFFFE0"},LemonChiffon:{value:"#FFFACD"},LightGoldenrodYellow:{value:"#FAFAD2"},PapayaWhip:{value:"#FFEFD5"},Moccasin:{value:"#FFE4B5"},PeachPuff:{value:"#FFDAB9"},PaleGoldenrod:{value:"#EEE8AA"},Khaki:{value:"#F0E68C"},DarkKhaki:{value:"#BDB76B"},Gold:{value:"#FFD700"},Cornsilk:{value:"#FFF8DC"},BlanchedAlmond:{value:"#FFEBCD"},Bisque:{value:"#FFE4C4"},NavajoWhite:{value:"#FFDEAD"},Wheat:{value:"#F5DEB3"},Burlywood:{value:"#DEB887"},Tan:{value:"#D2B48C"},RosyBrown:{value:"#BC8F8F"},SandyBrown:{value:"#F4A460"},Goldenrod:{value:"#DAA520"},DarkGoldenrod:{value:"#B8860B"},Peru:{value:"#CD853F"},Chocolate:{value:"#D2691E"},SaddleBrown:{value:"#8B4513"},Sienna:{value:"#A0522D"},Brown:{value:"#A52A2A"},Maroon:{value:"#800000"},DarkOliveGreen:{value:"#556B2F"},Olive:{value:"#808000"},OliveDrab:{value:"#6B8E23"},YellowGreen:{value:"#9ACD32"},LimeGreen:{value:"#32CD32"},Lime:{value:"#00FF00"},LawnGreen:{value:"#7CFC00"},Chartreuse:{value:"#7FFF00"},GreenYellow:{value:"#ADFF2F"},SpringGreen:{value:"#00FF7F"},MediumSpringGreen:{value:"#00FA9A"},LightGreen:{value:"#90EE90"},PaleGreen:{value:"#98FB98"},DarkSeaGreen:{value:"#8FBC8F"},MediumAquamarine:{value:"#66CDAA"},MediumSeaGreen:{value:"#3CB371"},SeaGreen:{value:"#2E8B57"},ForestGreen:{value:"#228B22"},Green:{value:"#008000"},DarkGreen:{value:"#006400"},Aqua:{value:"#00FFFF"},Cyan:{value:"#00FFFF"},LightCyan:{value:"#E0FFFF"},PaleTurquoise:{value:"#AFEEEE"},Aquamarine:{value:"#7FFFD4"},Turquoise:{value:"#40E0D0"},DarkTurquoise:{value:"#00CED1"},MediumTurquoise:{value:"#48D1CC"},LightSeaGreen:{value:"#20B2AA"},CadetBlue:{value:"#5F9EA0"},DarkCyan:{value:"#008B8B"},Teal:{value:"#008080"},LightSteelBlue:{value:"#B0C4DE"},PowderBlue:{value:"#B0E0E6"},LightBlue:{value:"#ADD8E6"},SkyBlue:{value:"#87CEEB"},LightSkyBlue:{value:"#87CEFA"},DeepSkyBlue:{value:"#00BFFF"},DodgerBlue:{value:"#1E90FF"},Cornflower:{value:"#6495ED"},SteelBlue:{value:"#4682B4"},RoyalBlue:{value:"#4169E1"},Blue:{value:"#0000FF"},MediumBlue:{value:"#0000CD"},DarkBlue:{value:"#00008B"},Navy:{value:"#000080"},MidnightBlue:{value:"#191970"},Lavender:{value:"#E6E6FA"},Thistle:{value:"#D8BFD8"},Plum:{value:"#DDA0DD"},Violet:{value:"#EE82EE"},Orchid:{value:"#DA70D6"},Fuchsia:{value:"#FF00FF"},Magenta:{value:"#FF00FF"},MediumOrchid:{value:"#BA55D3"},MediumPurple:{value:"#9370DB"},BlueViolet:{value:"#8A2BE2"},DarkViolet:{value:"#9400D3"},DarkOrchid:{value:"#9932CC"},DarkMagenta:{value:"#8B008B"},Purple:{value:"#800080"},RebeccaPurple:{value:"#663399"},Indigo:{value:"#4B0082"},DarkSlateBlue:{value:"#483D8B"},SlateBlue:{value:"#6A5ACD"},MediumSlateBlue:{value:"#7B68EE"},White:{value:"#FFFFFF"},Snow:{value:"#FFFAFA"},Honeydew:{value:"#F0FFF0"},MintCream:{value:"#F5FFFA"},Azure:{value:"#F0FFFF"},AliceBlue:{value:"#F0F8FF"},GhostWhite:{value:"#F8F8FF"},WhiteSmoke:{value:"#F5F5F5"},Seashell:{value:"#FFF5EE"},Beige:{value:"#F5F5DC"},OldLace:{value:"#FDF5E6"},FloralWhite:{value:"#FFFAF0"},Ivory:{value:"#FFFFF0"},AntiqueWhite:{value:"#FAEBD7"},Linen:{value:"#FAF0E6"},LavenderBlush:{value:"#FFF0F5"},MistyRose:{value:"#FFE4E1"},Gainsboro:{value:"#DCDCDC"},LightGray:{value:"#D3D3D3"},Silver:{value:"#C0C0C0"},DarkGray:{value:"#A9A9A9"},Gray:{value:"#808080"},DimGray:{value:"#696969"},LightSlateGray:{value:"#778899"},SlateGray:{value:"#708090"},DarkSlateGray:{value:"#2F4F4F"},LightGrey:{value:"#D3D3D3"},DarkGrey:{value:"#A9A9A9"},Grey:{value:"#808080"},DimGrey:{value:"#696969"},LightSlateGrey:{value:"#778899"},SlateGrey:{value:"#708090"},DarkSlateGrey:{value:"#2F4F4F"},Black:{value:"#000000"}},Ve=/[A-Za-z\d]{3,}/,Oe=/rgba?\((\d+), (\d+), (\d+)(?:, ([\d.]+))?\)/,Ge=[];for(const e in Pe){const t=Pe[e];t.name=e;const i=Ue(t.value);i&&(t.rgba=i,t.hsl=He(t.rgba),Ge.push(t))}function He({r:e=0,g:t=0,b:i=0}){const n=Math.min(e/=255,t/=255,i/=255),s=Math.max(e,t,i);let r=(s+n)/2,a=r;const o=r;if(s===n)r=0,a=0;else{const l=s-n;switch(a=o>.5?l/(2-s-n):l/(s+n),s){case e:r=(t-i)/l+(t<i?6:0);break;case t:r=(i-e)/l+2;break;case i:r=(e-t)/l+4}r/=6}return{h:360*r,s:100*a,l:100*o}}function $e(e,t){if(e.hsl&&t.hsl){let i=e.hsl.h,n=t.hsl.h;return i===n&&(i=e.hsl.s)===(n=t.hsl.s)&&(i=e.hsl.l,n=t.hsl.l),i>=n?1:-1}return 0}function We(e){for(const t in Pe)if(t.toLowerCase()===e.trim().toLowerCase())return Pe[t]}function ze(e,t="1",i=!1){if(e&&("transparent"!==e||i)){let n;if(""===t.trim()&&(t="1"),"#"===e.charAt(0))n=Ue(e);else if("initial"===e)n={r:0,g:0,b:0,a:1};else if("transparent"===e)n={r:0,g:0,b:0,a:0};else if(e.startsWith("rgb")){const i=e.match(Oe);if(i){const e=i[4]?parseFloat(i[4]):function(e){const t=parseFloat(e);return t<1?t:1}(t);n={r:parseInt(i[1]),g:parseInt(i[2]),b:parseInt(i[3]),a:e}}}else{const i=We(e);i&&i.rgba&&((n=i.rgba).a=parseFloat(t))}if(n&&(n.a>0||i)){const e=Xe(n.r)+Xe(n.g)+Xe(n.b),t=function(e){return e<1?Xe(255*e):"FF"}(n.a),i=n.a;return{valueAsRGB:`#${e}`,valueAsRGBA:`#${e+t}`,valueAsARGB:`#${t+e}`,alpha:i,rgba:n,opaque:i<1,visible:i>0}}}}function Xe(...e){let t="";for(const i of e){let e="string"==typeof i?parseInt(i):i;t+=isNaN(e)?"00":De.charAt(((e=Math.max(0,Math.min(e,255)))-e%16)/16)+De.charAt(e%16)}return t}function Ue(e){if(e=e.replace(/#/g,"").trim(),Ve.test(e)){let t=255;switch(e.length){case 4:t=parseInt(e.charAt(3).repeat(2),16);case 3:e=e.charAt(0).repeat(2)+e.charAt(1).repeat(2)+e.charAt(2).repeat(2);break;case 5:e+=e.charAt(4);break;default:e.length>=8&&(t=parseInt(e.substring(6,8),16)),e=e.substring(0,6)}if(6===e.length)return{r:parseInt(e.substring(0,2),16),g:parseInt(e.substring(2,4),16),b:parseInt(e.substring(4),16),a:t}}}function je(e){return`rgb${e.a<255?"a":""}(${e.r}, ${e.g}, ${e.b}${e.a<255?`, ${(e.a/255).toPrecision(2)}`:""})`}Ge.sort($e);var Ye=Object.freeze({findColorName:We,findColorShade:function(e){let t=Ge.findIndex(t=>t.value===e);if(-1!==t)return Ge[t];{const i=Ue(e);if(i){const e=He(i);if(e){const i=Ge.slice(0);return i.push({name:"",value:"",hsl:e,rgba:{r:-1,g:-1,b:-1,a:1}}),i.sort($e),t=i.findIndex(e=>""===e.name),i[Math.min(t+1,i.length-1)]}}return}},parseColor:ze,reduceColor:function(e,t){const i=Ue(e);if(i){const e=t<0?0:255;return i.r=Math.round((e-i.r)*(t=Math.abs(t)))+i.r,i.g=Math.round((e-i.g)*t)+i.g,i.b=Math.round((e-i.b)*t)+i.b,ze(je(i))}},convertHex:Xe,convertRGBA:Ue,formatRGBA:je});function qe(e,t=":"){return`{${t+""+e}}`}function Ke(e,t,i,n=!1){const s="number"==typeof t?qe(t):t;return e.replace(s,(n?s:"")+i+(n?"":s))}function Ze(e,t,i){if(t>=0){let n=-1;return e.split("\n").map(e=>{const s=i.exec(e);return s?(-1===n&&(n=s[2].length),s[1]+G(t+(s[2].length-n))+s[3]):e}).join("\n")}return e}function Qe(e){return e.replace(/&#(\d+);/g,(e,t)=>String.fromCharCode(parseInt(t))).replace(/\u00A0/g,"&#160;").replace(/\u2002/g,"&#8194;").replace(/\u2003/g,"&#8195;").replace(/\u2009/g,"&#8201;").replace(/\u200C/g,"&#8204;").replace(/\u200D/g,"&#8205;").replace(/\u200E/g,"&#8206;").replace(/\u200F/g,"&#8207;")}var Je=Object.freeze({formatPlaceholder:qe,replacePlaceholder:Ke,replaceIndent:Ze,replaceTab:function(e,t=4,i=!1){return t>0&&(e=i?e.split("\n").map(e=>{const i=e.match(/^(\t+)(.*)$/);return i?" ".repeat(t*i[1].length)+i[2]:e}).join("\n"):e.replace(/\t/g," ".repeat(t))),e},replaceEntity:Qe,replaceCharacter:function(e){return e.replace(/&nbsp;/g,"&#160;").replace(/&(?!#?[A-Za-z0-9]{2,};)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;")},parseTemplate:function(e){const t={__root:e};let i,n=!1,s=e.length,r="";for(;;){if(n){const e=n[0].replace(RegExp(`^${n[1]}\\n`),"").replace(RegExp(`${n[1]}$`),"");for(const e in t)t[e]=t[e].replace(RegExp(n[0],"g"),`{%${n[2]}}`);t[n[2]]=e,s-=n[0].length,r=n[2]}if(null===n||0===s){if(!r)break;if(!(e=t[r]))break;s=e.length,r="",n=null}if(n||(i=/(!(\w+))\n[\w\W]*\n*\1/g),!i)break;n=i.exec(e)}return t},createTemplate:function e(t,i,n){let s=void 0===n?t.__root.trim():t[n];for(const n in i){let r="";if(N(i[n])){for(let s=0;s<i[n].length;s++)r+=e(t,i[n][s],""+n);r=O(r,"\\n")}else r=i[n];let a="";C(r)&&(a=N(i[n])?"%":"[&~]",s=s.replace(RegExp(`{${a+n}}`,"g"),r)),(!1===r||Array.isArray(r)&&0===r.length||a&&"%"!==a)&&(s=s.replace(RegExp(`{%${n}}\\n*`,"g"),"")),""===a&&RegExp(`{&${n}}`).test(s)&&(s="")}return void 0===n&&(s=s.replace(/\n{%\w+}\n/g,"\n")),s.replace(/\s*([\w:]+="[^"]*)?{~\w+}"?/g,"")},getTemplateSection:function(e,...t){let i=e;for(const e of t){const[t,n="0"]=e.split("-");if(!i[t]||!i[t][parseInt(n)])return{};i=i[t][parseInt(n)]}return i}});const et="(?:\\s*(rgba?\\(\\d+, \\d+, \\d+(?:, [\\d.]+)?\\)|#[a-zA-Z\\d]{3,}|[a-z]+)\\s*(\\d+%|(-?[\\d.]+))?,?\\s*)",tt=/(.+?)?\s*at (.+?)$/,it="(-?[\\d.]+)(deg|rad|turn|grad)";function nt(e,t){let i=e[t];return Array.from(e.children).forEach(e=>{const n=Me(e);n&&(n.excluded||X(n.dataset.target))&&n[t]&&""!==n[t].trim()&&(i=i.replace(n[t],""))}),i}function st(e,t,i=!1){const n=[],s=RegExp(et,"g");let r;for(;null!==(r=s.exec(e));){const e=ze(r[1],t);if(e&&e.visible){const t={color:e.valueAsRGBA,opacity:e.alpha,offset:""};i?r[3]&&r[4]&&(t.offset=""+y(r[3],r[4])):r[2]&&(t.offset=r[2]),n.push(t)}}const a=n[n.length-1];""===a.offset&&(a.offset=i?"360":"100%");let o=0;for(let e=0;e<n.length;e++){const t=n[e];if(""===t.offset){if(0===e)t.offset="0";else{for(let i=e+1,s=2;i<n.length-1;i++,s++)if(""!==n[i].offset){t.offset=""+(o+parseInt(n[i].offset))/s;break}""===t.offset&&(t.offset=""+(o+parseInt(a.offset)/(n.length-1)))}i||(t.offset+="%")}o=parseInt(t.offset)}if(i&&o<360||!i&&o<100){const e=Object.assign({},n[n.length-1]);e.offset=i?"360":"100%",n.push(e)}return n}function rt(e){if(e){const t=RegExp(it).exec(e.trim());if(t)return y(t[1],t[2])}return 0}function at(e,t){const i=e.renderParent;switch(e.multiLine&&i&&!i.layoutVertical&&(t=t.replace(/^\s*\n/,"")),e.css("whiteSpace")){case"nowrap":t=t.replace(/\n/g," ");break;case"pre":case"pre-wrap":i&&!i.layoutVertical&&(t=t.replace(/^\n/,"")),t=(t=t.replace(/\n/g,"\\n")).replace(/\s/g,"&#160;");break;case"pre-line":t=(t=t.replace(/\n/g,"\\n")).replace(/\s+/g," ");break;default:const n=e.baseElement;return n&&(n.previousSibling&&we(n.previousSibling)&&(t=t.replace(/^\s+/,"")),n.nextSibling&&we(n.nextSibling)&&(t=t.replace(/\s+$/,""))),[t,!1]}return[t,!0]}class ot{constructor(e,t){this.application=e,this.cache=t}static generateId(e,t,i){const n=t;let s=i;1===i&&(t+=`_${""+s}`);const r=this.ASSETS.ids.get(e)||[];for(;;){if(!r.includes(t)){r.push(t);break}t=`${n}_${""+ ++s}`}return this.ASSETS.ids.set(e,r),t}static getStoredName(e,t){for(const[i,n]of ot.STORED[e].entries())if(JSON.stringify(t)===JSON.stringify(n))return i;return""}static insertStoredAsset(e,t,i){const n=ot.STORED[e];if(n){let s=this.getStoredName(e,i);if(""===s&&((k(t)||/^\d/.test(t))&&(t=`__${t}`),X(i))){let e=0;do{s=t,e>0&&(s+=`_${e}`),n.has(s)||n.set(s,i),e++}while(n.has(s)&&n.get(s)!==i)}return s}return""}static isBorderVisible(e){return!!e&&!("none"===e.style||"0px"===e.width||""===e.color||9===e.color.length&&e.color.endsWith("00"))}static hasDrawableBackground(e){return!!e&&(this.isBorderVisible(e.borderTop)||this.isBorderVisible(e.borderRight)||this.isBorderVisible(e.borderBottom)||this.isBorderVisible(e.borderLeft)||!!e.backgroundImage||!!e.borderRadius||!!e.backgroundGradient)}finalize(e){}reset(){for(const e in ot.ASSETS)ot.ASSETS[e]=new Map;for(const e in ot.STORED)ot.STORED[e]=new Map;this.fileHandler&&this.fileHandler.reset()}setBoxStyle(){for(const e of this.cache.elements){const t={background:null,borderTop:null,borderRight:null,borderBottom:null,borderLeft:null,borderRadius:null,backgroundColor:null,backgroundSize:null,backgroundImage:null,backgroundRepeat:null,backgroundPositionX:null,backgroundPositionY:null};for(const n in t){const s=e.css(n);switch(n){case"borderTop":case"borderRight":case"borderBottom":case"borderLeft":{let i=e.css(`${n}Color`);switch(i.toLowerCase()){case"initial":i="#000000";break;case"inherit":case"currentcolor":i=be(e.element,`${n}Color`)}let s=e.css(`${n}Width`)||"1px";const r=e.css(`${n}Style`)||"none";"inset"===r&&"0px"===s&&(s="1px");const a=ze(i,e.css("opacity"));t[n]={width:s,style:r,color:"none"!==r&&a?a.valueAsRGBA:""};break}case"borderRadius":{const[i,n,s,r]=[e.css("borderTopLeftRadius"),e.css("borderTopRightRadius"),e.css("borderBottomLeftRadius"),e.css("borderBottomRightRadius")];t.borderRadius=i===n&&n===s&&s===r?0===v(i)?void 0:[i]:[i,n,s,r];break}case"backgroundColor":if(!e.has("backgroundColor")&&(s===e.cssAscend("backgroundColor",!1,!0)||e.documentParent.visible&&pe(e.element,"backgroundColor")))t.backgroundColor="";else{const i=ze(s,e.css("opacity"));t.backgroundColor=i?i.valueAsRGBA:""}break;case"background":case"backgroundImage":if("none"!==s&&!e.hasBit("excludeResource",i.IMAGE_SOURCE)){const i=[],n=e.css("opacity");let r,a=RegExp(`(linear|radial|conic)-gradient\\(((?:to [a-z ]+|(?:from )?-?[\\d.]+(?:deg|rad|turn|grad)|circle|ellipse|closest-side|closest-corner|farthest-side|farthest-corner)?(?:\\s*at [\\w %]+)?),?\\s*(${et}+)\\)`,"g");for(;null!==(r=a.exec(s));){let e;switch(r[1]){case"linear":void 0===r[2]&&(r[2]="to bottom"),e={type:"linear",angle:(()=>{switch(r[2]){case"to top":return 0;case"to right top":return 45;case"to right":return 90;case"to right bottom":return 135;case"to bottom":return 180;case"to left bottom":return 225;case"to left":return 270;case"to left top":return 315;default:return rt(r[2])}})(),colorStops:st(r[3],n)};break;case"radial":e={type:"radial",position:(()=>{const e=["center","ellipse"];if(r[2]){const t=tt.exec(r[2]);if(t){if(t[1])switch(t[1]){case"ellipse":case"circle":case"closest-side":case"closest-corner":case"farthest-side":case"farthest-corner":e[1]=t[1]}t[2]&&(e[0]=t[2])}}return e})(),colorStops:st(r[3],n)};break;case"conic":e={type:"conic",angle:rt(r[2]),position:(()=>{if(r[2]){const e=tt.exec(r[2]);if(e)return[e[2]]}return["center"]})(),colorStops:st(r[3],n,!0)}}e.colorStops.length>1&&i.push(e)}if(i.length)t.backgroundGradient=i;else{const e=[];for(a=RegExp(c.CSS_URL,"g");null!==(r=a.exec(s));)e.push(r[0]);e.length&&(t.backgroundImage=e)}}break;case"backgroundSize":case"backgroundRepeat":case"backgroundPositionX":case"backgroundPositionY":t[n]=s}}const n=JSON.stringify(t.borderTop);n===JSON.stringify(t.borderRight)&&n===JSON.stringify(t.borderBottom)&&n===JSON.stringify(t.borderLeft)&&(t.border=t.borderTop),e.data(ot.KEY_NAME,"boxStyle",t)}}setFontStyle(){for(const e of this.cache){const t=ot.hasDrawableBackground(e.data(ot.KEY_NAME,"boxStyle"));if(!(e.renderChildren.length||void 0===e.baseElement||e.imageElement||e.svgElement||"HR"===e.tagName||e.inlineText&&!t&&!e.preserveWhiteSpace&&""===e.element.innerHTML.trim())){const i=e.css("opacity"),n=ze(e.css("color"),i);let s;s=t||e.cssAscend("backgroundColor",!1,!0)===e.css("backgroundColor")&&(e.plainText||e.style.backgroundColor!==e.cssInitial("backgroundColor"))||!e.has("backgroundColor")&&e.documentParent.visible&&pe(e.element,"backgroundColor")?void 0:ze(e.css("backgroundColor"),i);let r=e.css("fontFamily"),a=e.css("fontSize"),o=e.css("fontWeight");if(ee(8)&&!e.has("fontFamily"))switch(e.tagName){case"TT":case"CODE":case"KBD":case"SAMP":r="monospace"}if(0===v(a))switch(a){case"xx-small":a="8px";break;case"x-small":a="10px";break;case"small":a="13px";break;case"medium":a="16px";break;case"large":a="18px";break;case"x-large":a="24px";break;case"xx-large":a="32px"}if(!k(o))switch(o){case"lighter":o="200";break;case"bold":o="700";break;case"bolder":o="900";break;default:o="400"}const l={fontFamily:r,fontStyle:e.css("fontStyle"),fontSize:a,fontWeight:o,color:n?n.valueAsRGBA:"",backgroundColor:s?s.valueAsRGBA:""};e.data(ot.KEY_NAME,"fontStyle",l)}}}setValueString(){for(const e of this.cache.visible){const t=e.baseElement;if(t){let i="",n="",s=!1,r=!0;if(t instanceof HTMLInputElement)switch(t.type){case"text":case"number":case"email":case"search":case"submit":case"reset":case"button":n=t.value.trim();break;default:e.companion&&!e.companion.visible&&(n=e.companion.textContent.trim())}else t instanceof HTMLTextAreaElement?n=t.value.trim():t instanceof HTMLElement?"BUTTON"===t.tagName?n=t.innerText:e.inlineText?(i=e.textContent.trim(),n="CODE"===t.tagName?Qe(nt(t,"innerHTML")):Ee(t,!0)?(n=(n=Qe(nt(t,"innerHTML"))).replace(/\s*<br[^>]*>\s*/g,"\\n")).replace(/(<([^>]+)>)/gi,""):Qe(nt(t,"textContent")),[n,s]=at(e,n)):""===t.innerText.trim()&&ot.hasDrawableBackground(e.data(ot.KEY_NAME,"boxStyle"))&&(n=Qe(t.innerText),r=!1):e.plainText&&(i=e.textContent.trim(),n=(n=Qe(e.textContent)).replace(/&[A-Za-z]+;/g,e=>e.replace("&","&amp;")),[n,s]=at(e,n));if(""!==n){if(r){const i=e.previousSiblings().pop(),r=e.nextSiblings().shift();let a=!1;if(void 0===i||i.multiLine||i.lineBreak||i.plainText&&/\s+$/.test(i.textContent)?n=n.replace(/^\s+/,""):i.baseElement&&(a=/\s+$/.test(i.baseElement.innerText||i.textContent)),s){const e=n;n=n.trim(),!i||i.block||i.lineBreak||a||!/^\s+/.test(e)||(n="&#160;"+n),r&&!r.lineBreak&&/\s+$/.test(e)&&(n+="&#160;")}else/^\s+$/.test(n)?n.length&&(n="&#160;"+n.substring(1)):n=(n=n.replace(/^\s+/,i&&(i.block||i.lineBreak||a&&i.htmlElement&&i.textContent.length>1||e.multiLine&&Ee(t))?"":"&#160;")).replace(/\s+$/,"table-cell"===e.display||r&&r.lineBreak||e.blockStatic?"":"&#160;")}""!==n&&e.data(ot.KEY_NAME,"valueString",{name:i,value:n})}}}}get stored(){return ot.STORED}}function lt(e,t,i){const n=[];let s=t;do{if(s.dataset.use)for(const e of s.dataset.use.split(","))n.push(e.trim());s=s!==e?s.parentElement:null}while(s);if(n.length){const e=[],t=[];for(const s of i){const i=n.indexOf(s.name);-1!==i?e[i]=s:t.push(s)}return[...e.filter(e=>e),...t]}return i}function ct(e,t){const i=e.previousSiblings(),n=e.nextSiblings();return!(!e.positionAuto||0!==i.length&&i.some(e=>e.multiLine>0||e.excluded&&!e.blockStatic)||0!==n.length&&!n.every(e=>e.blockStatic||e.lineBreak||e.excluded)&&e.element!==xe(t.element))&&(e.cssApply({position:"static",display:"inline-block",verticalAlign:"top"},!0),!0)}function ht(e,t,i){switch(e){case"<=":return t<=i;case"<":return t<i;case">=":return t>=i;case">":return t>i;default:return t===i}}ot.KEY_NAME="androme.resource",ot.ASSETS={ids:new Map,images:new Map},ot.STORED={strings:new Map,arrays:new Map,fonts:new Map,colors:new Map,styles:new Map,dimens:new Map,drawables:new Map,images:new Map};class dt{constructor(e,t,i,n){this.name=e,this.framework=t,this.tagNames=[],this.documentRoot=!1,this.eventOnly=!1,this.preloaded=!1,this.options={},this.dependencies=[],this.subscribers=new Set,this.subscribersChild=new Set,Array.isArray(i)&&(this.tagNames=i.map(e=>e.trim().toUpperCase())),n&&Object.assign(this.options,n)}static findNestedByName(e,t){return Ie(e)&&Array.from(e.children).find(e=>R(e.dataset.use,t))||null}is(e){return!!e.styleElement&&(0===this.tagNames.length||this.tagNames.includes(e.element.tagName))}require(e,t=!1){this.dependencies.push({name:e,preload:t})}included(e){return R(e.dataset.use,this.name)}beforeInit(e,t=!1){!t&&this.included(e)&&this.dependencies.filter(e=>e.preload).forEach(t=>{const i=this.application.extensionManager.retrieve(t.name);i&&!i.preloaded&&(i.beforeInit(e,!0),i.preloaded=!0)})}init(e){return!1}afterInit(e,t=!1){!t&&this.included(e)&&this.dependencies.filter(e=>e.preload).forEach(t=>{const i=this.application.extensionManager.retrieve(t.name);i&&i.preloaded&&(i.afterInit(e,!0),i.preloaded=!1)})}condition(e,t){if(Ie(e.element)){return e.dataset.use?this.included(e.element):this.tagNames.length>0}return!1}processNode(e,t){return{output:"",complete:!1}}processChild(e,t){return{output:"",complete:!1}}postBaseLayout(e){}postConstraints(e){}postParseDocument(e){}postProcedure(e){}beforeParseDocument(){}afterDepthLevel(){}afterBaseLayout(){}afterConstraints(){}afterResources(){}afterParseDocument(){}afterProcedure(){}afterFinalize(){}set application(e){this._application=e}get application(){return this._application||{}}get installed(){return!!this.application.extensions&&this.application.extensions.has(this)}}class ut{constructor(e){this.resource=e,this.appName="",this.assets=[],e.fileHandler=this}static downloadToDisk(e,t,i=""){const n=new Blob([e],{type:i||"application/octet-stream"});if(void 0!==window.navigator.msSaveBlob)return void window.navigator.msSaveBlob(n,t);const s=window.URL.createObjectURL(n),r=document.createElement("a");r.style.display="none",r.href=s,r.setAttribute("download",t),void 0===r.download&&r.setAttribute("target","_blank"),document.body.appendChild(r),r.click(),document.body.removeChild(r),setTimeout(()=>window.URL.revokeObjectURL(s),1)}addAsset(e,t,i="",n=""){if(""!==i||""!==n){const s=this.assets.findIndex(i=>i.pathname===e&&i.filename===t);-1!==s?(this.assets[s].content=i||"",this.assets[s].uri=n||""):this.assets.push({pathname:e,filename:t,content:i,uri:n})}}reset(){this.assets.length=0}saveToDisk(e){const t=this.userSettings;location.protocol.startsWith("http")?e.length&&(e.push(...this.assets),fetch("/api/savetodisk"+`?directory=${encodeURIComponent(P(t.outputDirectory,"/"))}`+`&appname=${encodeURIComponent(this.appName.trim())}`+`&filetype=${t.outputArchiveFileType.toLowerCase()}`+`&processingtime=${(""+t.outputMaxProcessingTime).trim()}`,{method:"POST",body:JSON.stringify(e),headers:new Headers({Accept:"application/json, text/plain, */*","Content-Type":"application/json"})}).then(e=>e.json()).then(e=>{e&&(e.zipname?fetch(`/api/downloadtobrowser?filename=${encodeURIComponent(e.zipname)}`).then(e=>e.blob()).then(t=>ut.downloadToDisk(t,H(e.zipname))):e.system&&alert(`${e.application}\n\n${e.system}`))}).catch(e=>alert(`ERROR: ${e}`))):alert("SERVER (required): See README for instructions")}get stored(){return this.resource.stored}}class pt extends J{constructor(e,t){super(),this.id=e,this.alignmentType=0,this.depth=-1,this.siblingIndex=Number.MAX_VALUE,this.renderPosition=-1,this.documentRoot=!1,this.visible=!0,this.excluded=!1,this.rendered=!1,this.baselineActive=!1,this.positioned=!1,this.renderExtension=new Set,this.controlId="",this._cached={},this._styleMap={},this._initial={iteration:-1,children:[],styleMap:{}},this._renderDepth=-1,this._data={},this._excludeSection=0,this._excludeProcedure=0,this._excludeResource=0,this._element=null,t?(this._element=t,this.init()):this.style={}}init(){const e=this._element;if(e&&(Ce(e,"node",this),this.style=Ne(e,"style")||he(e,!1)),this.styleElement){const t=Ne(e,"styleMap")||{},i=v(this.style.fontSize);for(let n of Array.from(e.style)){const s=te(e,n=m(n),e.style[n],this.style,i);""!==s&&(t[n]=s)}this._styleMap=Object.assign({},t)}}saveAsInitial(){-1===this._initial.iteration&&(this._initial.children=this.duplicate(),this._initial.styleMap=Object.assign({},this._styleMap),this._initial.documentParent=this._documentParent),this._bounds&&(this._initial.bounds=ce(this._bounds),this._initial.linear=ce(this.linear),this._initial.box=ce(this.box)),this._initial.iteration++}is(...e){return e.some(e=>this.containerType===e)}of(e,...t){return this.containerType===e&&t.some(e=>this.hasAlign(e))}unsafe(e){return this[`_${e}`]||void 0}attr(e,t,i="",n=!0){const s=`__${e}`;if(X(i)){if(void 0===this[s]&&(this._namespaces.add(e),this[s]={}),!n&&void 0!==this[s][t])return"";this[s][t]=""+i}return this[s][t]||""}namespace(e){return this[`__${e}`]||{}}delete(e,...t){const i=`__${e}`;if(this[i])for(const e of t)if(-1!==e.indexOf("*"))for(const[t]of z(this[i],e))delete this[i][t];else delete this[i][e]}apply(e){for(const t in e){const i=e[t];if("object"==typeof i){for(const e in i)this.attr(t,e,i[e]);delete e[t]}}}render(e){this.renderParent=e,this.renderDepth=this.documentRoot||this===e||X(e.dataset.target)?0:e.renderDepth+1,this.rendered=!0}renderEach(e){for(let t=0;t<this.renderChildren.length;t++)this.renderChildren[t].visible&&e(this.renderChildren[t],t,this.renderChildren);return this}renderFilter(e){return Y(this.renderChildren,e)}hide(e){this.rendered=!0,this.visible=!1}data(e,t,i,n=!0){return X(i)?(void 0===this._data[e]&&(this._data[e]={}),"object"==typeof this._data[e]&&(n||void 0===this._data[e][t])&&(this._data[e][t]=i)):null===i&&delete this._data[e],void 0===this._data[e]||void 0===this._data[e][t]?void 0:this._data[e][t]}unsetCache(...e){if(e.length)for(const t of e){switch(t){case"position":return void(this._cached={});case"width":case"minWidth":this._cached.hasWidth=void 0;break;case"height":case"minHeight":this._cached.hasHeight=void 0;break;case"verticalAlign":this._cached.baseline=void 0;break;case"display":this._cached.inline=void 0,this._cached.inlineVertical=void 0,this._cached.inlineFlow=void 0,this._cached.block=void 0,this._cached.blockDimension=void 0,this._cached.blockStatic=void 0,this._cached.autoMargin=void 0;break;case"pageFlow":this._cached.positionAuto=void 0,this._cached.blockStatic=void 0,this._cached.baseline=void 0,this._cached.floating=void 0,this._cached.autoMargin=void 0,this._cached.rightAligned=void 0,this._cached.bottomAligned=void 0;break;default:t.startsWith("margin")&&(this._cached.autoMargin=void 0)}this._cached[t]=void 0}else this._cached={}}ascend(e=!1,t=-1){const i=[],n=e?this.renderParent?"renderParent":"parent":"actualParent";let s=this[n],r=-1;for(;s&&0!==s.id&&!i.includes(s)&&(i.push(s),++r!==t);)s=s[n];return i}cascade(e=!1){return function t(i){const n=[];for(const s of i.children)e&&!s.baseElement||n.push(s),s.length&&n.push(...t(s));return n}(this)}inherit(e,...t){const i=e.unsafe("initial");for(const n of t)switch(n){case"initial":Object.assign(this._initial,i);break;case"base":this._documentParent=e.documentParent,this._bounds=ce(e.bounds),this._linear=ce(e.linear),this._box=ce(e.box);const t=e.actualParent;t&&(this.dir=t.dir);break;case"alignment":["position","top","right","bottom","left","display","verticalAlign","cssFloat","clear","zIndex"].forEach(t=>{this._styleMap[t]=e.css(t),this._initial.styleMap[t]=i.styleMap[t]}),["marginTop","marginRight","marginBottom","marginLeft"].forEach(t=>{"auto"===e.cssInitial(t)&&(this._initial.styleMap[t]="auto"),"auto"===e.cssInitial(t,!0)&&(this._styleMap[t]="auto")});break;case"styleMap":j(this._styleMap,e.unsafe("styleMap"));break;case"textStyle":const s={whiteSpace:e.css("whiteSpace")};for(const t in e.style)if(t.startsWith("font")||t.startsWith("color")){const i=m(t);s[i]=e.style[i]}this.cssApply(s)}}alignedVertically(e,t,i,n=!0){if(this.lineBreak)return!0;if(this.pageFlow&&e.length){if(N(t)&&this!==t[0]){if(i&&i.has(this))return!0;if(n){const e=t[t.length-1];if(this.floating&&(this.linear.top>=e.linear.bottom||"left"===this.float&&t.filter(e=>e.siblingIndex<this.siblingIndex&&U(this.linear.left,e.linear.left)).length>0||"right"===this.float&&t.filter(e=>e.siblingIndex<this.siblingIndex&&U(this.linear.right,e.linear.right)).length>0))return!0}}const s=this.actualParent;for(const n of e){if(n.blockStatic||this.blockStatic&&(!n.inlineFlow||!!i&&i.has(n))||!!i&&"both"===i.get(n)&&(!N(t)||t[0]!==n)||!n.floating&&(this.blockStatic||!this.floating&&!this.inlineFlow)||s&&n.bounds.width>(s.has("width",2)?s.width:s.box.width)&&(!n.textElement||n.textElement&&"nowrap"===n.css("whiteSpace"))||n.lineBreak||n.autoMargin.leftRight||"left"===n.float&&this.autoMargin.right||"right"===n.float&&this.autoMargin.left)return!0}}return!1}intersectX(e,t="linear"){const i=this[t];return e.top>=i.top&&e.top<i.bottom||e.bottom>i.top&&e.bottom<=i.bottom||i.top>=e.top&&i.bottom<=e.bottom||e.top>=i.top&&e.bottom<=i.bottom}intersectY(e,t="linear"){const i=this[t];return e.left>=i.left&&e.left<i.right||e.right>i.left&&e.right<=i.right||i.left>=e.left&&i.right<=e.right||e.left>=i.left&&e.right<=i.right}withinX(e,t="linear"){const i=this[t];return Math.ceil(i.top)>=Math.floor(e.top)&&Math.floor(i.bottom)<=Math.ceil(e.bottom)}withinY(e,t="linear"){const i=this[t];return Math.ceil(i.left)>=Math.floor(e.left)&&Math.floor(i.right)<=Math.ceil(e.right)}outsideX(e,t="linear"){const i=this[t];return Math.ceil(i.left)<Math.floor(e.left)||Math.ceil(i.left)>=Math.floor(e.right)}outsideY(e,t="linear"){const i=this[t];return Math.ceil(i.top)<Math.floor(e.top)||Math.ceil(i.top)>=Math.floor(e.bottom)}css(e,t="",i=!1){return arguments.length>=2&&(this._styleMap[e]=t,i&&this.unsetCache(e)),this._styleMap[e]||this.style&&this.style[e]||""}cssApply(e,t=!1){if(Object.assign(this._styleMap,e),t)for(const t in e)this.unsetCache(t);return this}cssInitial(e,t=!1,i=!1){-1!==this._initial.iteration||t||(i=!0);let n=t?this._styleMap[e]:this._initial.styleMap[e];return i&&!X(n)&&(n=this.style[e]),n||""}cssAscend(e,t=!1,i=!1){let n="",s=t?this:this.actualParent;for(;s;){if(""!==(n=s.cssInitial(e))){if(!i||s.visible)break;n=""}if(s.documentBody)break;s=s.actualParent}return n}cssSort(e,t=!1,i=!1){const n=i?this.duplicate():this.children;return n.sort((i,n)=>{const s=i.toInt(e),r=n.toInt(e);return s===r?0:t?s>r?-1:1:s<r?-1:1}),n}cssPX(e,t,i=!1,n=!1){const s=this._styleMap[e];if(s&&B(s)){t+=parseFloat(S(s,this.fontSize)),i||(t=Math.max(0,t));const r=_(t);return this.css(e,r),n&&this.unsetCache(e),r}return""}cssTry(e,t){if(this.styleElement){const i=this._element,n=this.css(e);if(i.style[e]=t,i.style[e]===t)return Ce(i,e,n),!0}return!1}cssFinally(e){if(this.styleElement){const t=this._element,i=Ne(t,e);if(i)return t.style[e]=i,Be(t,e),!0}return!1}toInt(e,t=!1,i=0){return parseInt((t?this._initial.styleMap:this._styleMap)[e])||i}convertPX(e,t=!0,i=!0){return this.convertPercent(e,t,i)||S(e,this.fontSize)}convertPercent(e,t,i=!0){if(M(e)){const n=(i?this.absoluteParent:null)||this,s=t?"width":"height";let r;return r=n.has(s,2)?n.toInt(s):n[i?"box":"bounds"][s],`${Math.round((parseFloat(e)>=1?parseInt(e)/100:parseFloat(e))*r)}px`}return""}has(e,t=0,i){const n=(i&&"initial"===i.map?this._initial.styleMap:this._styleMap)[e];if(X(n))switch(n){case"0px":if(I(t,64))return!0;switch(e){case"top":case"right":case"bottom":case"left":return!0}case"left":if(I(t,8))return!0;case"baseline":if(I(t,16))return!0;case"auto":if(I(t,4))return!0;case"none":case"initial":case"unset":case"normal":case"transparent":case"rgba(0, 0, 0, 0)":return!1;default:if(i&&i.not)if(Array.isArray(i.not)){for(const e of i.not)if(n===e)return!1}else if(n===i.not)return!1;let s=0===t;return I(t,2)&&B(n)&&(s=!0),I(t,32)&&M(n)&&(s=!0),I(t,4)&&(s=!1),s}return!1}hasBit(e,t){return void 0!==this[e]&&I(this[e],t)}hasAlign(e){return I(this.alignmentType,e)}exclude({section:e=0,procedure:t=0,resource:i=0}){e>0&&!I(this._excludeSection,e)&&(this._excludeSection|=e),t>0&&!I(this._excludeProcedure,t)&&(this._excludeProcedure|=t),i>0&&!I(this._excludeResource,i)&&(this._excludeResource|=i)}setExclusions(){if(this.styleElement){const e=(e,t)=>{const i=this.actualParent,n=[D(this.dataset[`exclude${e}`]),i?D(i.dataset[`exclude${e}Child`]):""].filter(e=>e).join("|");let s=0;n.split("|").map(e=>e.toUpperCase().trim()).forEach(e=>{void 0!==t[e]&&(s|=t[e])}),s>0&&this.exclude({[e.toLowerCase()]:s})};e("Section",t),e("Procedure",n),e("Resource",i)}}setBounds(e=!1){const t=this._element;if(t&&!e)if(this.styleElement){if(this._bounds=ce(t.getBoundingClientRect()),this.documentBody){if(this.marginTop>0){const e=this.firstChild;e&&!e.lineBreak&&e.blockStatic&&e.marginTop>=this.marginTop&&this.css("marginTop","0px",!0)}this._bounds.top=this.marginTop}}else if(this.plainText){const e=le(t);this._bounds=ce(e)}}appendTry(e,t,i=!0){for(let i=0;i<this.length;i++)if(e===this.item(i))return t.siblingIndex=e.siblingIndex,this.item(i,t),t.parent=this,!0;if(i){let e=-1;return this.each(t=>{t.siblingIndex!==Number.MAX_VALUE&&(e=Math.max(t.siblingIndex,e))}),t.siblingIndex=e+1,t.parent=this,!0}return!1}modifyBox(e,t,i=!0){if(0!==t){const n=r.get(e);n&&(null===t?this._boxReset[n]=1:(this._boxAdjustment[n]+=t,!i&&this._boxAdjustment[n]<0&&(this._boxAdjustment[n]=0)))}}valueBox(e){const t=r.get(e);return t?[this._boxReset[t],this._boxAdjustment[t]]:[0,0]}resetBox(e,t,i=!1){const n=Array.from(r.keys()),s=(e,s,a)=>{let o=0;for(const l of Array.from(r.values()).slice(e,s)){if(this._boxReset[l]=1,t){const e=r.get(a?n[o]:n[o+4]);e&&t.modifyBox(i?n[o]:n[o+4],this[e])}o++}};I(e,30)&&s(0,4,!0),I(e,480)&&s(4,8,!1)}inheritBox(e,t){const i=Array.from(r.keys()),n=(e,n,s)=>{let a=s?0:4;for(const s of Array.from(r.values()).slice(e,n)){this._boxAdjustment[s]>0&&(t.modifyBox(i[a],this._boxAdjustment[s],!1),this._boxAdjustment[s]=0),a++}};I(e,30)&&n(0,4,!0),I(e,480)&&n(4,8,!1)}previousSiblings(e=!0,t=!0,i=!1){let n=null;const s=[];if(this._element)n=this._element.previousSibling;else if(this._initial.children.length){const e=this._initial.children.filter(e=>e.pageFlow);n=e.length&&e[0].element?e[0].element.previousSibling:null}for(;n;){const r=Me(n);if(r)if(e&&r.lineBreak||t&&r.excluded)s.push(r);else if(!r.excluded&&r.pageFlow&&(s.push(r),!i||r.visible&&!r.floating))break;n=n.previousSibling}return s}nextSiblings(e=!0,t=!0,i=!1){let n=null;const s=[];if(this._element)n=this._element.nextSibling;else if(this._initial.children.length){const e=this._initial.children.filter(e=>e.pageFlow);if(e.length){const t=e[e.length-1];n=t.element?t.element.nextSibling:null}}for(;n;){const r=Me(n);if(r)if(e&&r.lineBreak||t&&r.excluded)s.push(r);else if(!r.excluded&&r.pageFlow&&(s.push(r),!i||r.visible&&!r.floating))break;n=n.nextSibling}return s}actualRight(e="linear"){return(this.companion&&!this.companion.visible&&this.companion[e].right>this[e].right?this.companion:this)[e].right}setDimensions(e){const t=this.unsafe(e);if(t){if(t.width=this.bounds.width,t.height=t.bottom-t.top,this.styleElement)switch(e){case"linear":t.width+=(this.marginLeft>0?this.marginLeft:0)+this.marginRight;break;case"box":t.width-=this.contentBoxWidth}void 0===this._initial[e]&&(this._initial[e]=ce(t))}}convertPosition(e){let t=0;if(!this.positionStatic){const i=this.cssInitial(e);(B(i)||M(i))&&(t=v(this.convertUnit(e,i,"left"===e||"right"===e)))}return t}convertBox(e,t){const i=e+t;return v(this.convertUnit(i,this.css(i),"Left"===t||"Right"===t))}convertUnit(e,t,i,n=!0){return M(t)?B(this.style[e])?this.style[e]:this.convertPercent(t,i,n):t}set parent(e){e&&(e!==this._parent&&(this._parent&&this._parent.remove(this),this._parent=e),e.contains(this)||e.append(this),-1===this.depth&&(this.depth=e.depth+1))}get parent(){return this._parent}set tagName(e){this._cached.tagName=e.toUpperCase()}get tagName(){if(void 0===this._cached.tagName){const e=this._element;let t="";e&&(this.styleElement?t=("INPUT"===e.tagName?e.type:e.tagName).toUpperCase():"#text"===e.nodeName&&(t="PLAINTEXT")),this._cached.tagName=t}return this._cached.tagName}get element(){if(this._element)return this._element;{const e=re(null,this.block);return Ce(e,"node",this),e}}get baseElement(){return this._element}get htmlElement(){return this._element instanceof HTMLElement&&("none"!==this.display||""!==this._element.innerHTML)}get svgElement(){return this._element instanceof SVGSVGElement}get styleElement(){return Ie(this._element)}get naturalElement(){return this.styleElement&&("none"!==this.display||""!==this.element.innerHTML)||this.plainText}get imageElement(){return"IMG"===this.tagName}get flexElement(){return"flex"===this.display||"inline-flex"===this.display}get gridElement(){return"grid"===this.display}get textElement(){return this.plainText||this.inlineText}get tableElement(){return"TABLE"===this.tagName||"table"===this.display}get groupParent(){return!1}get plainText(){return"PLAINTEXT"===this.tagName}get lineBreak(){return"BR"===this.tagName}get documentBody(){return this._element===document.body}get bounds(){return this._bounds||se()}get linear(){if(void 0===this._linear&&this._bounds){if(this._element){const e=this._bounds;this._linear={top:e.top-(this.marginTop>0?this.marginTop:0),right:e.right+this.marginRight,bottom:e.bottom+this.marginBottom,left:e.left-(this.marginLeft>0?this.marginLeft:0),width:0,height:0}}else this._linear=ce(this._bounds);this.setDimensions("linear")}return this._linear||se()}get box(){if(void 0===this._box&&this._bounds){if(this._element){const e=this._bounds;this._box={top:e.top+(this.paddingTop+this.borderTopWidth),right:e.right-(this.paddingRight+this.borderRightWidth),bottom:e.bottom-(this.paddingBottom+this.borderBottomWidth),left:e.left+(this.paddingLeft+this.borderLeftWidth),width:0,height:0}}else this._box=ce(this._bounds);this.setDimensions("box")}return this._box||se()}set renderAs(e){this.rendered||!e||e.rendered||(this._renderAs=e)}get renderAs(){return this._renderAs}set renderDepth(e){this._renderDepth=e}get renderDepth(){return-1!==this._renderDepth?this._renderDepth:0}get dataset(){return this._element instanceof HTMLElement?this._element.dataset:{}}get excludeSection(){return this._excludeSection}get excludeProcedure(){return this._excludeProcedure}get excludeResource(){return this._excludeResource}get extensions(){return this.dataset.use?this.dataset.use.split(",").map(e=>e.trim()).filter(e=>e):[]}get flexbox(){if(void 0===this._cached.flexbox){const e=this.actualParent;this._cached.flexbox={order:v(this.css("order")),wrap:this.css("flexWrap"),direction:this.css("flexDirection"),alignSelf:!this.has("alignSelf")&&e&&e.has("alignItems")?e.css("alignItems"):this.css("alignSelf"),justifyContent:this.css("justifyContent"),basis:this.css("flexBasis"),grow:v(this.css("flexGrow")),shrink:v(this.css("flexShrink"))}}return this._cached.flexbox}get width(){if(void 0===this._cached.width){let e=0;for(const t of[this._styleMap.width,this._styleMap.minWidth])if((B(t)||M(t))&&(e=v(this.convertPX(t)))>0)break;this._cached.width=e}return this._cached.width}get height(){if(void 0===this._cached.height){let e=0;for(const t of[this._styleMap.height,this._styleMap.minHeight])if((B(t)||this.hasHeight&&M(t))&&(e=v(this.convertPX(t,!0)))>0)break;this._cached.height=e}return this._cached.height}get hasWidth(){if(void 0===this._cached.hasWidth){const e=this.cssInitial("width",!0);this._cached.hasWidth=(()=>!this.inlineStatic&&(M(e)?"0%"!==e:!!(B(e)&&"0px"!==e||this.toInt("minWidth")>0)))()}return this._cached.hasWidth}get hasHeight(){if(void 0===this._cached.hasHeight){const e=this.cssInitial("height",!0);this._cached.hasHeight=(()=>{if(this.inlineStatic)return!1;if(M(e)){const t=this.actualParent;if(t&&t.hasHeight)return"0%"!==e}else if(B(e)&&"0px"!==e||this.toInt("minHeight")>0)return!0;return!1})()}return this._cached.hasHeight}get lineHeight(){if(void 0===this._cached.lineHeight)if(0===this.length||this.textElement)this._cached.lineHeight=this.toInt("lineHeight");else{const e=v(this.cssAscend("lineHeight",!0));this._cached.lineHeight=e>this.bounds.height||this.some(e=>e.plainText)?e:0}return this._cached.lineHeight}get display(){return this.css("display")}get position(){return this.css("position")}get positionStatic(){return void 0===this._cached.positionStatic&&(this._cached.positionStatic=(()=>{switch(this.position){case"fixed":case"absolute":return!1;case"sticky":case"relative":return 0===this.toInt("top")&&0===this.toInt("right")&&0===this.toInt("bottom")&&0===this.toInt("left");case"inherit":const e=this._element?me(this._element.parentElement,"position"):"";return""!==e&&!("absolute"===e||"fixed"===e);default:return!0}})()),this._cached.positionStatic}get positionRelative(){const e=this.position;return"relative"===e||"sticky"===e}get positionAuto(){if(void 0===this._cached.positionAuto){const e=-1===this._initial.iteration?this._styleMap:this._initial.styleMap;this._cached.positionAuto=!(this.pageFlow||"auto"!==e.top&&e.top||"auto"!==e.right&&e.right||"auto"!==e.bottom&&e.bottom||"auto"!==e.left&&e.left)}return this._cached.positionAuto}get top(){return void 0===this._cached.top&&(this._cached.top=this.convertPosition("top")),this._cached.top}get right(){return void 0===this._cached.right&&(this._cached.right=this.convertPosition("right")),this._cached.right}get bottom(){return void 0===this._cached.bottom&&(this._cached.bottom=this.convertPosition("bottom")),this._cached.bottom}get left(){return void 0===this._cached.left&&(this._cached.left=this.convertPosition("left")),this._cached.left}get marginTop(){return void 0===this._cached.marginTop&&(this._cached.marginTop=this.inlineStatic&&!this.baselineActive?0:this.convertBox("margin","Top")),this._cached.marginTop}get marginRight(){return void 0===this._cached.marginRight&&(this._cached.marginRight=this.convertBox("margin","Right")),this._cached.marginRight}get marginBottom(){return void 0===this._cached.marginBottom&&(this._cached.marginBottom=this.inlineStatic&&!this.baselineActive?0:this.convertBox("margin","Bottom")),this._cached.marginBottom}get marginLeft(){return void 0===this._cached.marginLeft&&(this._cached.marginLeft=this.convertBox("margin","Left")),this._cached.marginLeft}get borderTopWidth(){return"none"!==this.css("borderTopStyle")?v(this.css("borderTopWidth")):0}get borderRightWidth(){return"none"!==this.css("borderRightStyle")?v(this.css("borderRightWidth")):0}get borderBottomWidth(){return"none"!==this.css("borderBottomStyle")?v(this.css("borderBottomWidth")):0}get borderLeftWidth(){return"none"!==this.css("borderLeftStyle")?v(this.css("borderLeftWidth")):0}get paddingTop(){return void 0===this._cached.paddingTop&&(this._cached.paddingTop=this.convertBox("padding","Top")),this._cached.paddingTop}get paddingRight(){return void 0===this._cached.paddingRight&&(this._cached.paddingRight=this.convertBox("padding","Right")),this._cached.paddingRight}get paddingBottom(){return void 0===this._cached.paddingBottom&&(this._cached.paddingBottom=this.convertBox("padding","Bottom")),this._cached.paddingBottom}get paddingLeft(){return void 0===this._cached.paddingLeft&&(this._cached.paddingLeft=this.convertBox("padding","Left")),this._cached.paddingLeft}get contentBoxWidth(){return this.tableElement&&"collapse"===this.css("borderCollapse")?0:this.borderLeftWidth+this.paddingLeft+this.paddingRight+this.borderRightWidth}get contentBoxHeight(){return this.tableElement&&"collapse"===this.css("borderCollapse")?0:this.borderTopWidth+this.paddingTop+this.paddingBottom+this.borderBottomWidth}get inline(){if(void 0===this._cached.inline){const e=this.display;this._cached.inline="inline"===e||("initial"===e||"unset"===e)&&o.includes(this.tagName)}return this._cached.inline}get inlineStatic(){return void 0===this._cached.inlineStatic&&(this._cached.inlineStatic=this.inline&&!this.floating&&!this.imageElement),this._cached.inlineStatic}get inlineVertical(){if(void 0===this._cached.inlineVertical){const e=this.display;this._cached.inlineVertical=(e.startsWith("inline")||"table-cell"===e)&&!this.floating&&!this.plainText}return this._cached.inlineVertical}set inlineText(e){this._cached.inlineText=e}get inlineText(){if(void 0===this._cached.inlineText){let e=!1;const t=this._element;if(t&&this.htmlElement&&!this.svgElement)switch(t.tagName){case"INPUT":case"BUTTON":case"IMG":case"SELECT":case"TEXTAREA":break;default:Se(t)&&(e=Array.from(t.children).every(e=>{const t=Me(e);return void 0===t||t.excluded||X(t.dataset.target)}))}this._cached.inlineText=e}return this._cached.inlineText}get block(){if(void 0===this._cached.block){const e=this.display;this._cached.block="block"===e||"list-item"===e||"initial"===e&&a.includes(this.tagName)}return this._cached.block}get blockStatic(){return void 0===this._cached.blockStatic&&(this._cached.blockStatic=this.block&&this.pageFlow&&(!this.floating||"100%"===this.cssInitial("width"))),this._cached.blockStatic}get blockDimension(){if(void 0===this._cached.blockDimension){const e=this.display;this._cached.blockDimension=this.block||"inline-block"===e||"table-cell"===e}return this._cached.blockDimension}get pageFlow(){return void 0===this._cached.pageFlow&&(this._cached.pageFlow=this.positionStatic||this.positionRelative),this._cached.pageFlow}get inlineFlow(){if(void 0===this._cached.inlineFlow){const e=this.display;this._cached.inlineFlow=this.inline||e.startsWith("inline")||"table-cell"===e||this.imageElement||this.floating}return this._cached.inlineFlow}get rightAligned(){return void 0===this._cached.rightAligned&&(this._cached.rightAligned="right"===this.float||this.autoMargin.left||this.inlineVertical&&"right"===this.cssAscend("textAlign",!0)||!this.pageFlow&&this.has("right")),this._cached.rightAligned||this.hasAlign(512)}get bottomAligned(){return void 0===this._cached.bottomAligned&&(this._cached.bottomAligned=!this.pageFlow&&this.has("bottom")&&this.bottom>=0),this._cached.bottomAligned}get autoMargin(){if(void 0===this._cached.autoMargin)if(!this.pageFlow||this.blockStatic||"table"===this.display){const e=-1===this._initial.iteration?this._styleMap:this._initial.styleMap,t="auto"===e.marginLeft&&(this.pageFlow||this.has("right")),i="auto"===e.marginRight&&(this.pageFlow||this.has("left")),n="auto"===e.marginTop&&(this.pageFlow||this.has("bottom")),s="auto"===e.marginBottom&&(this.pageFlow||this.has("top"));this._cached.autoMargin={horizontal:t||i,left:t&&!i,right:!t&&i,leftRight:t&&i,vertical:n||s,top:n&&!s,bottom:!n&&s,topBottom:n&&s}}else this._cached.autoMargin={horizontal:!1,left:!1,right:!1,leftRight:!1,top:!1,bottom:!1,vertical:!1,topBottom:!1};return this._cached.autoMargin}get floating(){if(void 0===this._cached.floating)if(this.pageFlow){const e=this.css("cssFloat");this._cached.floating="left"===e||"right"===e}else this._cached.floating=!1;return this._cached.floating}get float(){return void 0===this._cached.float&&(this._cached.float=this.floating?this.css("cssFloat"):"none"),this._cached.float}get zIndex(){return this.toInt("zIndex")}get textContent(){if(void 0===this._cached.textContent){const e=this._element;let t="";e&&(e instanceof HTMLElement?t=e.textContent||e.innerText:this.plainText&&(t=e.textContent||"")),this._cached.textContent=t}return this._cached.textContent}set overflow(e){0!==e&&16!==e&&8!==e&&24!==e||(this._cached.overflow=e)}get overflow(){if(void 0===this._cached.overflow){const[e,t,i]=[this.css("overflow"),this.css("overflowX"),this.css("overflowY")],n=this._element;let s=0;this.hasWidth&&("scroll"===e||"scroll"===t||"auto"===t&&n&&n.clientWidth!==n.scrollWidth)&&(s|=8),this.hasHeight&&("scroll"===e||"scroll"===i||"auto"===i&&n&&n.clientHeight!==n.scrollHeight)&&(s|=16),this._cached.overflow=s}return this._cached.overflow}get overflowX(){return I(this.overflow,8)}get overflowY(){return I(this.overflow,16)}get baseline(){if(void 0===this._cached.baseline){const e=this.verticalAlign,t=this.cssInitial("verticalAlign");this._cached.baseline=this.pageFlow&&!this.floating&&("baseline"===e||"initial"===e||B(t)&&0===parseInt(t))}return this._cached.baseline}get verticalAlign(){return this.css("verticalAlign")}set multiLine(e){this._cached.multiLine=e}get multiLine(){return void 0===this._cached.multiLine&&(this._cached.multiLine=this.plainText||this.inlineFlow&&this.inlineText?le(this._element).multiLine:0),this._cached.multiLine}get visibleStyle(){if(void 0===this._cached.visibleStyle){const e=this.borderTopWidth>0||this.borderRightWidth>0||this.borderBottomWidth>0||this.borderLeftWidth>0,t=c.CSS_URL.test(this.css("backgroundImage"))||c.CSS_URL.test(this.css("background")),i=this.has("backgroundColor"),n=this.css("backgroundRepeat"),s=this.paddingLeft+this.paddingRight>0,r=this.paddingTop+this.paddingBottom>0;this._cached.visibleStyle={padding:s||r,paddingHorizontal:s,paddingVertical:r,background:e||t||i,borderWidth:e,backgroundImage:t,backgroundColor:i,backgroundRepeat:"no-repeat"!==n,backgroundRepeatX:"repeat"===n||"repeat-x"===n||n.startsWith("repeat "),backgroundRepeatY:"repeat"===n||"repeat-y"===n||n.endsWith(" repeat")}}return this._cached.visibleStyle}get preserveWhiteSpace(){if(void 0===this._cached.preserveWhiteSpace){const e=this.css("whiteSpace");this._cached.preserveWhiteSpace="pre"===e||"pre-wrap"===e}return this._cached.preserveWhiteSpace}get layoutHorizontal(){return this.hasAlign(8)}get layoutVertical(){return this.hasAlign(16)}set controlName(e){this.rendered&&void 0!==this._controlName||(this._controlName=e)}get controlName(){return this._controlName||""}set documentParent(e){this._documentParent=e}get documentParent(){return this._documentParent||this.actualParent||this.parent||this}get absoluteParent(){let e=this.actualParent;if(!this.pageFlow)for(;e&&0!==e.id;){const t=e.cssInitial("position",!1,!0);if(e.documentBody||"static"!==t&&"initial"!==t&&"unset"!==t)return e;e=e.actualParent}return e}set renderParent(e){e&&(e!==this&&-1===e.renderChildren.indexOf(this)&&e.renderChildren.push(this),this._renderParent=e)}get renderParent(){return this._renderParent}set renderPositionId(e){this._renderPositionId=e}get renderPositionId(){return this._renderPositionId||this.id+(-1!==this.renderPosition?`^${this.renderPosition}`:"")}get actualParent(){return this.baseElement&&this.baseElement.parentElement?Me(this.baseElement.parentElement):void 0}get actualChildren(){if(void 0===this._cached.actualChildren)if(this.htmlElement){const e=[];this._element.childNodes.forEach(t=>{const i=Me(t);i&&e.push(i)}),this._cached.actualChildren=e}else this._cached.actualChildren=this.groupParent?this._initial.children.slice(0):[];return this._cached.actualChildren}get actualHeight(){return this.plainText?this.bounds.bottom-this.bounds.top:this.bounds.height}get firstChild(){const e=this._element;if(e)for(let t=0;t<e.childNodes.length;t++){const i=Me(e.childNodes[t]);if(i)return i}}get lastChild(){const e=this._element;if(e)for(let t=e.childNodes.length-1;t>=0;t--){const i=Me(e.childNodes[t]);if(i)return i}}get singleChild(){return this.renderParent?1===this.renderParent.length:!(!this.parent||0===this.parent.id)&&1===this.parent.length}set dir(e){this._cached.dir=e}get dir(){if(void 0===this._cached.dir){let e=this.naturalElement&&this.styleElement?this._element.dir:"";switch(e){case"ltr":case"rtl":break;default:let t=this.actualParent;for(;t;){if(e=t.dir){this._cached.dir=e;break}t=t.actualParent}}this._cached.dir=e||document.body.dir}return this._cached.dir}get nodes(){return this.rendered?this.renderChildren:this.children}get center(){return{x:this.bounds.left+Math.floor(this.bounds.width/2),y:this.bounds.top+Math.floor(this.actualHeight/2)}}}function ft(e){switch(e.tagName){case"path":case"circle":case"ellipse":case"line":case"rect":case"polygon":case"polyline":return!0}return!1}function gt(e){return"image"===e.tagName}function mt(e){const t=ge(e,"transform-origin");if(""!==t){const i=e.parentElement;let n,s;if(i instanceof SVGSVGElement)n=i.viewBox.baseVal.width,s=i.viewBox.baseVal.height;else{if(!(i instanceof SVGGElement&&i.viewportElement instanceof SVGSVGElement))return;n=i.viewportElement.viewBox.baseVal.width,s=i.viewportElement.viewBox.baseVal.height}let r=t.split(" ");1===r.length&&r.push("center"),r=r.slice(0,2);const a={x:null,y:null};if(r.includes("left")?a.x=0:r.includes("right")&&(a.x=n),r.includes("top")?a.y=0:r.includes("bottom")&&(a.y=s),["x","y"].forEach(t=>{if(null===a[t])for(let i=0;i<r.length;i++){let o=r[i];if(""!==o&&("center"===o&&(o="50%"),B(o)?a[t]=parseInt(o.endsWith("px")?o:S(o,v(he(e).fontSize||"16"))):M(o)&&(a[t]=("x"===t?n:s)*(parseInt(o)/100)),null!==a[t])){r[i]="";break}}}),a.x||a.y)return a.x=a.x||0,a.y=a.y||0,a}}function bt(e,t,i){return e.a*t+e.c*i+e.e}function yt(e,t,i){return e.b*t+e.d*i+e.f}function vt(e,t){return t*Math.cos(e*Math.PI/180)*-1}function xt(e){const t=ge(e,"visibility",!0);return"hidden"!==t&&"collapse"!==t&&"none"!==ge(e,"display",!0)}var St=Object.freeze({isSvgShape:ft,isSvgImage:gt,createTransformData:function(e){const t={operations:[],translateX:0,translateY:0,scaleX:1,scaleY:1,rotateAngle:0,skewX:0,skewY:0,origin:mt(e)};for(let i=0;i<e.transform.baseVal.numberOfItems;i++){const n=e.transform.baseVal.getItem(i);if(!t.operations.includes(n.type))switch(n.type){case SVGTransform.SVG_TRANSFORM_TRANSLATE:0===n.matrix.e&&0===n.matrix.f||(t.translateX=n.matrix.e,t.translateY=n.matrix.f,t.operations.push(n.type));break;case SVGTransform.SVG_TRANSFORM_SCALE:1===n.matrix.a&&1===n.matrix.d||(t.scaleX=n.matrix.a,t.scaleY=n.matrix.d,t.operations.push(n.type));break;case SVGTransform.SVG_TRANSFORM_ROTATE:if(0!==n.angle){t.rotateAngle=n.angle;const i=e.attributes.getNamedItem("transform");if(i&&i.nodeValue){const e=/rotate\((\d+), (\d+), (\d+)\)/.exec(i.nodeValue);e&&(t.rotateOriginX=parseInt(e[2]),t.rotateOriginY=parseInt(e[3]))}t.matrixRotate=n.matrix,t.operations.push(n.type)}break;case SVGTransform.SVG_TRANSFORM_SKEWX:0!==n.angle&&(t.skewX+=n.angle,t.matrixSkewX=n.matrix,t.operations.push(n.type));break;case SVGTransform.SVG_TRANSFORM_SKEWY:0!==n.angle&&(t.skewY+=n.angle,t.matrixSkewY=n.matrix,t.operations.push(n.type))}}return t},getTransformOrigin:mt,applyMatrixX:bt,applyMatrixY:yt,getRadiusX:function(e,t){return t*Math.sin(e*Math.PI/180)},getRadiusY:vt,isVisible:xt});const At={};class Et{static setName(e){let t,i="";return e.id?(void 0===At[e.id]&&(i=e.id),t=e.id):t=e.tagName,void 0===At[t]&&(At[t]=0),""!==i?i:`${t}_${++At[t]}`}static applyTransforms(e,t,i){const n=[];for(const e of t)n.push({x:e.x,y:e.y});for(let t=e.numberOfItems-1;t>=0;t--){const s=e.getItem(t);let r=0,a=0,o=0,l=0,c=0,h=0;if(i)switch(s.type){case SVGTransform.SVG_TRANSFORM_SCALE:r+=i.x,l+=i.y;break;case SVGTransform.SVG_TRANSFORM_SKEWX:a-=i.y;break;case SVGTransform.SVG_TRANSFORM_SKEWY:o-=i.x;break;case SVGTransform.SVG_TRANSFORM_ROTATE:o-=i.x,a-=i.y,c=i.x+vt(s.angle,i.x),h=i.y+vt(s.angle,i.y)}for(const e of n){const t=e.x,i=e.y;e.x=bt(s.matrix,t+r,i+a)+c,e.y=yt(s.matrix,t+o,i+l)+h}}return n}static toPointList(e){const t=[];for(let i=0;i<e.numberOfItems;i++){const n=e.getItem(i);t.push({x:n.x,y:n.y})}return t}static toCoordinateList(e){const t=[],i=/-?[\d.]+/g;let n;for(;null!==(n=i.exec(e));){const e=parseFloat(n[0]);isNaN(e)||t.push(e)}return t}static toPathCommandList(e){const t=[],i=/([A-Za-z])([^A-Za-z]+)?/g;let n;for(e=e.trim();null!==(n=i.exec(e))&&(0!==t.length||"M"===n[1].toUpperCase());){n[2]=(n[2]||"").trim();const e=this.toCoordinateList(n[2]),i=t[t.length-1],s=i?i.command.toUpperCase():"",r=i?i.points[i.points.length-1]:void 0;let a,o,l,c,h;switch(n[1].toUpperCase()){case"M":case"L":if(e.length>=2){e.length=2;break}continue;case"H":if(r&&e.length){e[1]="h"===n[1]?0:r.y,e.length=2;break}continue;case"V":if(r&&e.length){const t=e[0];e[0]="v"===n[1]?0:r.x,e[1]=t,e.length=2;break}continue;case"Z":if(t.length){e.push(...t[0].coordinates),n[1]="Z";break}continue;case"C":if(e.length>=6){e.length=6;break}continue;case"S":if(e.length>=4&&("C"===s||"S"===s)){e.length=4;break}continue;case"Q":if(e.length>=4){e.length=4;break}continue;case"T":if(e.length>=2&&("Q"===s||"T"===s)){e.length=2;break}continue;case"A":if(e.length>=7){[a,o,l,c,h]=e.splice(0,5),e.length=2;break}continue;default:continue}if(e.length>1){const i=[],s=/[a-z]/.test(n[1]);for(let t=0;t<e.length;t+=2){let n=e[t],a=e[t+1];s&&r&&(n+=r.x,a+=r.y),i.push({x:n,y:a})}t.push({command:n[1],relative:s,coordinates:e,points:i,radiusX:a,radiusY:o,xAxisRotation:l,largeArcFlag:c,sweepFlag:h})}}return t}static createColorStops(e){const t=[];for(const i of Array.from(e.getElementsByTagName("stop"))){const e=ze(ge(i,"stop-color"),ge(i,"stop-opacity"));e&&e.visible&&t.push({color:e.valueAsRGBA,offset:ge(i,"offset"),opacity:e.alpha})}return t}static fromCoordinateList(e){const t=[];for(let i=0;i<e.length;i+=2)t.push({x:e[i],y:e[i+1]});return t.length%2==0?t:[]}static fromPathCommandList(e){let t="";for(const i of e)switch(t+=(""!==t?" ":"")+i.command,i.command.toUpperCase()){case"M":case"L":case"C":case"S":case"Q":case"T":t+=i.coordinates.join(",");break;case"H":t+=i.coordinates[0];break;case"V":t+=i.coordinates[1];break;case"A":t+=`${i.radiusX},${i.radiusY},${i.xAxisRotation},${i.largeArcFlag},${i.sweepFlag},${i.coordinates.join(",")}`}return t}}class wt{constructor(e,t){this.element=e,this.parentElement=t,this.attributeName="",this.attributeType="",this.to="",this._begin=0,this._beginMS=0,this._duration=0,this._durationMS=0,this.init()}static convertClockTime(e){let t=0,i=0;if(/\d+ms$/.test(e))i=parseInt(e);else if(/\d+s$/.test(e))t=parseInt(e);else if(/\d+min$/.test(e))t=60*parseInt(e);else if(/\d+(.\d+)?h$/.test(e))t=60*parseFloat(e)*60;else{const n=/^(?:(\d?\d):)?(?:(\d?\d):)?(\d?\d)\.?(\d?\d?\d)?$/.exec(e);n&&(n[1]&&(t+=60*parseInt(n[1])*60),n[2]&&(t+=60*parseInt(n[2])),n[3]&&(t+=parseInt(n[3])),n[4]&&(i=parseInt(n[4])*(n[4].length<3?Math.pow(10,3-n[4].length):1)))}return[t,i]}init(){const e=this.element,t=e.attributes.getNamedItem("attributeName");t&&(this.attributeName=t.value.trim());const i=e.attributes.getNamedItem("attributeType");i&&(this.attributeType=i.value.trim());const n=e.attributes.getNamedItem("to");n&&(this.to=n.value.trim());const s=e.attributes.getNamedItem("begin"),r=e.attributes.getNamedItem("dur");s&&("indefinite"===s.value?this._begin=-1:[this._begin,this._beginMS]=wt.convertClockTime(s.value)),r&&("indefinite"===r.value?this._duration=-1:[this._duration,this._durationMS]=wt.convertClockTime(r.value))}get duration(){return-1!==this._duration?1e3*this._duration+this._durationMS:this._duration}get begin(){return-1!==this._begin?1e3*this._begin+this._beginMS:this._begin}}class _t extends wt{constructor(e,t){super(e,t),this.element=e,this.parentElement=t,this.from="",this.by="",this.values=[],this.keyTimes=[],this.calcMode="",this.additive=!1,this.accumulate=!1,this.freeze=!1,this._end=0,this._endMS=0,this._repeatDurationMS=0;const i=e.attributes.getNamedItem("attributeName");i&&(this.attributeName=i.value.trim());const n=e.attributes.getNamedItem("attributeType");n&&(this.attributeType=n.value.trim());const s=e.attributes.getNamedItem("values");if(s){if(this.values.push(...K(s.value.split(";"),e=>e.trim())),this.values.length>1){this.from=this.values[0],this.to=this.values[this.values.length-1];const t=e.attributes.getNamedItem("keyTimes");if(t){const e=_t.toFractionList(t.value);e.length===this.values.length&&this.keyTimes.push(...e)}}}else if(this.to){this.values.push(this.from,this.to),this.keyTimes.push(0,1);const t=e.attributes.getNamedItem("by");t&&(this.by=t.value.trim())}const r=e.attributes.getNamedItem("end"),a=e.attributes.getNamedItem("repeatDur"),o=e.attributes.getNamedItem("repeatCount");if(r&&("indefinite"===r.value?this._end=-1:[this._end,this._endMS]=_t.convertClockTime(r.value)),a&&("indefinite"===a.value?this.repeatDur=-1:[this.repeatDur,this._repeatDurationMS]=_t.convertClockTime(a.value)),o)if("indefinite"===o.value)this.repeatCount=-1;else{const e=parseInt(o.value);isNaN(e)||(this.repeatCount=e)}const l=e.attributes.getNamedItem("calcMode");if(l)switch(l.value){case"discrete":case"linear":case"paced":case"spline":this.calcMode=l.value}const c=e.attributes.getNamedItem("additive");c&&(this.additive="sum"===c.value);const h=e.attributes.getNamedItem("accumulate");h&&(this.accumulate="sum"===h.value);const d=e.attributes.getNamedItem("fill");d&&(this.freeze="freeze"===d.value)}static toFractionList(e,t=";"){let i=-1;const n=K(e.split(t),e=>{const t=parseFloat(e);return!isNaN(t)&&t<=1&&(-1===i||t>i)?(i=t,t):-1});return n.length>1&&n.some(e=>-1!==e)&&0===n[0]?n:[]}get end(){return-1!==this._end?1e3*this._end+this._endMS:this._end}get repeatDuration(){return void 0!==this.repeatDur&&-1!==this.repeatDur?1e3*this.repeatDur+this._repeatDurationMS:0}}class Tt extends _t{constructor(e,t){super(e,t),this.path="",this.keyPoints=[],this.rotate=0,this.rotateAuto=!1,this.rotateAutoReverse=!1;const i=e.attributes.getNamedItem("path");i&&(this.path=i.value.trim());const n=e.attributes.getNamedItem("rotate");if(n)switch(n.value){case"auto":this.rotateAuto=!0;break;case"auto-reverse":this.rotateAutoReverse=!0;break;default:this.rotate=v(n.value)}if(this.keyTimes.length){const t=e.attributes.getNamedItem("keyPoints");if(t){const e=_t.toFractionList(t.value);e.length===this.keyTimes.length&&(this.keyPoints=e)}}}}class It extends _t{constructor(e,t){super(e,t),this.type=0;const i=e.attributes.getNamedItem("type");if(i)switch(i.value){case"translate":this.type=SVGTransform.SVG_TRANSFORM_TRANSLATE;break;case"scale":this.type=SVGTransform.SVG_TRANSFORM_SCALE;break;case"rotate":this.type=SVGTransform.SVG_TRANSFORM_ROTATE;break;case"skewX":this.type=SVGTransform.SVG_TRANSFORM_SKEWX;break;case"skewY":this.type=SVGTransform.SVG_TRANSFORM_SKEWY}}static toRotateList(e){const t=e.map(e=>{if(""===e)return[null,null,null];{const t=Et.toCoordinateList(e);return 1===t.length||3===t.length?t:[]}});return t.some(e=>0===e.length)?void 0:t}static toScaleList(e){const t=e.map(e=>{if(""===e)return[null,null];{const t=Et.toCoordinateList(e);return 1===t.length?[t[0],t[0]]:2===t.length?t:[]}});return t.some(e=>0===e.length)?void 0:t}static toTranslateList(e){const t=e.map(e=>{if(""===e)return[null,null];{const t=Et.toCoordinateList(e);return 1===t.length||2===t.length?t:[]}});return t.some(e=>0===e.length)?void 0:t}}class kt{constructor(e,t=""){this.element=e,this.d=t,this.transformed=!1,this.opacity=1,this.color="",this.fillRule="",this.fill="",this.fillOpacity="",this.stroke="",this.strokeWidth="",this.strokeOpacity="",this.strokeLinecap="",this.strokeLinejoin="",this.strokeMiterlimit="",this.clipPath="",this.clipRule="",this.init()}static getLine(e,t,i=0,n=0){return 0!==e||0!==t||0!==i||0!==n?`M${e},${t} L${i},${n}`:""}static getRect(e,t,i=0,n=0){return e>0&&t>0?`M${i},${n} h${e} v${t} h${-e} Z`:""}static getPolyline(e){return(e=e instanceof SVGPointList?Et.toPointList(e):e).length?`M${e.map(e=>`${e.x},${e.y}`).join(" ")}`:""}static getPolygon(e){const t=this.getPolyline(e);return""!==t?t+" Z":""}static getCircle(e,t,i){return i>0?this.getEllipse(e,t,i,i):""}static getEllipse(e,t,i,n){return i>0&&n>0?`M${e-i},${t} a${i},${n},0,1,0,${2*i},0 a${i},${n},0,1,0,-${2*i},0`:""}setColor(e){let t=ge(this.element,e);const i=c.LINK_HREF.exec(t);if(i)t=`@${i[1]}`;else if(""!==t)switch(t.toLowerCase()){case"none":case"transparent":case"rgba(0, 0, 0, 0)":t="";break;case"currentcolor":{const e=ze(ge(this.element,"color",!0));t=e?e.valueAsRGB:"#000000";break}default:{const e=ze(t);e&&(t=e.valueAsRGB);break}}else"fill"!==e||this.element.parentElement instanceof SVGGElement||(t="#000000");this[e]=t}setOpacity(e){const t=ge(this.element,`${e}-opacity`);this[`${e}Opacity`]=t?""+parseFloat(t)*this.opacity:""+this.opacity}init(){const e=this.element;if(""===this.d){const t=e.transform.baseVal;switch(e.tagName){case"path":this.d=ge(e,"d");break;case"circle":this.d=kt.getCircle(e.cx.baseVal.value,e.cy.baseVal.value,e.r.baseVal.value);break;case"ellipse":this.d=kt.getEllipse(e.cx.baseVal.value,e.cy.baseVal.value,e.rx.baseVal.value,e.ry.baseVal.value);break;case"line":{const i=e.x1.baseVal.value,n=e.y1.baseVal.value,s=e.x2.baseVal.value,r=e.y2.baseVal.value;if(t.numberOfItems){this.d=kt.getPolyline(Et.applyTransforms(t,[{x:i,y:n},{x:s,y:r}],mt(e))),this.transformed=!0}else this.d=kt.getLine(i,n,s,r);break}case"rect":{const i=e.x.baseVal.value,n=e.y.baseVal.value,s=e.width.baseVal.value,r=e.height.baseVal.value;if(t.numberOfItems){this.d=kt.getPolygon(Et.applyTransforms(t,[{x:i,y:n},{x:i+s,y:n},{x:i+s,y:n+r},{x:i,y:n+r}],mt(e))),this.transformed=!0}else this.d=kt.getRect(s,r,i,n);break}case"polyline":case"polygon":{let i=Et.toPointList(e.points);t.numberOfItems&&(i=Et.applyTransforms(t,i,mt(e)),this.transformed=!0),this.d="polygon"===e.tagName?kt.getPolygon(i):kt.getPolyline(i);break}}}const t=c.LINK_HREF.exec(ge(e,"clip-path"));t&&(this.clipPath=t[1],this.clipRule=ge(e,"clip-rule",!0));const i=ge(e,"opacity");i&&(this.opacity=Math.min(parseFloat(i),1)),this.setColor("fill"),this.fill&&(this.setOpacity("fill"),this.fillRule=ge(e,"fill-rule",!0)),this.setColor("stroke"),this.stroke&&(this.setOpacity("stroke"),this.strokeWidth=ge(e,"stroke-width")||"1",this.strokeLinecap=ge(e,"stroke-linecap",!0),this.strokeLinejoin=ge(e,"stroke-linejoin",!0),this.strokeMiterlimit=ge(e,"stroke-miterlimit",!0))}}class Ct{constructor(e){if(this.element=e,this.name=Et.setName(e),this.animate=this.animatable?Ct.toAnimateList(e):[],this.visible=xt(e),this.drawable){const t=new kt(e);t.d&&"none"!==t.d&&(this.path=t)}}static toAnimateList(e){const t=[];for(let i=0;i<e.children.length;i++){const n=e.children[i];n instanceof SVGAnimateTransformElement?t.push(new It(n,e)):n instanceof SVGAnimateMotionElement?t.push(new Tt(n,e)):n instanceof SVGAnimateElement?t.push(new _t(n,e)):n instanceof SVGAnimationElement&&t.push(new wt(n,e))}return t}get transform(){return this.element.transform.baseVal}get drawable(){return!0}get animatable(){return!0}get transformable(){return this.transform.numberOfItems>0}}class Nt extends J{constructor(e){super(),this.element=e,this.visible=!0,this.name=Et.setName(e),this.animate=this.animatable?Ct.toAnimateList(e):[],this.visible=xt(e)}get transform(){return this.element.transform.baseVal}get animatable(){return this.element instanceof SVGGElement}get transformable(){return this.element instanceof SVGGElement&&this.element.transform.baseVal.numberOfItems>0}}class Bt extends Nt{constructor(e){super(e),this.element=e,this.x=e.x.baseVal.value,this.y=e.y.baseVal.value,this.width=e.width.baseVal.value,this.height=e.height.baseVal.value}get animatable(){return!0}get transformable(){return this.transform.numberOfItems>0}}class Mt extends Ct{constructor(e){super(e),this.element=e,this.uri="",this.x=e.x.baseVal.value,this.y=e.y.baseVal.value,this.width=e.width.baseVal.value,this.height=e.height.baseVal.value,this.uri=L(e.href.baseVal)}setExternal(){const e=this.element.transform.baseVal;if(e.numberOfItems){let t=this.x,i=this.y;for(let n=e.numberOfItems-1;n>=0;n--){const s=e.getItem(n),r=s.matrix;switch(s.type){case SVGTransform.SVG_TRANSFORM_TRANSLATE:t+=r.e,i+=r.f;break;case SVGTransform.SVG_TRANSFORM_SCALE:t*=r.a,i*=r.d,this.width*=r.a,this.height*=r.d;break;case SVGTransform.SVG_TRANSFORM_ROTATE:t=bt(r,t,t),i=yt(r,i,i),r.a<0&&(t+=r.a*this.width),r.c<0&&(t+=r.c*this.width),r.b<0&&(i+=r.b*this.height),r.d<0&&(i+=r.d*this.height)}}this.x=t,this.y=i}}get drawable(){return!1}}class Rt extends Bt{constructor(e,t){super(e),this.element=e,t&&this.setPath(t)}setPath(e){this.path=new kt(this.element,e)}}const Ft={UNIT:"[\\d.]+[a-z%]+|auto|max-content|min-content",MINMAX:"minmax\\((.*?), (.*?)\\)",FIT_CONTENT:"fit-content\\(([\\d.]+[a-z%]+)\\)",REPEAT:"repeat\\((auto-fit|auto-fill|[0-9]+), ((?:minmax|fit-content)\\(.*?\\)|.*?)\\)",NAMED:"\\[([\\w\\-\\s]+)\\]"},Lt={UNIT:RegExp(`^(${Ft.UNIT})$`),NAMED:RegExp(`\\s*(${Ft.NAMED}|${Ft.REPEAT}|${Ft.MINMAX}|${Ft.FIT_CONTENT}|${Ft.UNIT})\\s*`,"g")};class Dt extends dt{static createDataAttribute(){return{children:new Set,rowData:[],templateAreas:{},row:Dt.createDataRowAttribute(),column:Dt.createDataRowAttribute(),emptyRows:[],alignItems:"",alignContent:"",justifyItems:"",justifyContent:""}}static createDataRowAttribute(){return{count:0,gap:0,unit:[],unitMin:[],repeat:[],auto:[],autoFill:!1,autoFit:!1,name:{},normal:!0}}condition(e){return e.gridElement&&e.length>0}processNode(e){const t=Object.assign(Dt.createDataAttribute(),{alignItems:e.css("alignItems"),alignContent:e.css("alignContent"),justifyItems:e.css("justifyItems"),justifyContent:e.css("justifyContent")}),i=e.css("gridAutoFlow"),n=-1!==i.indexOf("row"),s=-1!==i.indexOf("dense"),r=[],a=[],o=[];let c={};function h(t){return B(t)?e.convertPX(t):t}if(t.row.gap=parseInt(e.convertPX(e.css("rowGap"),!1,!1)),t.column.gap=parseInt(e.convertPX(e.css("columnGap"),!0,!1)),[e.cssInitial("gridTemplateRows",!0),e.cssInitial("gridTemplateColumns",!0),e.css("gridAutoRows"),e.css("gridAutoColumns")].forEach((i,n)=>{if(i&&"none"!==i&&"auto"!==i){let s,r=1;for(;null!==(s=Lt.NAMED.exec(i));)if(n<2){const e=t[0===n?"row":"column"];if("["===s[1].charAt(0))void 0===e.name[s[2]]&&(e.name[s[2]]=[]),e.name[s[2]].push(r);else if(s[1].startsWith("minmax"))e.unit.push(h(s[6])),e.unitMin.push(h(s[5])),e.repeat.push(!1),r++;else if(s[1].startsWith("repeat")){let t=1;switch(s[3]){case"auto-fit":e.autoFit=!0;break;case"auto-fill":e.autoFill=!0;break;default:t=v(s[3])}if(s[4].startsWith("minmax")){const t=RegExp(Ft.MINMAX,"g");let i;for(;null!==(i=t.exec(s[4]));)e.unit.push(h(i[2])),e.unitMin.push(h(i[1])),e.repeat.push(!0),r++}else if("["===s[4].charAt(0)){const i=s[4].split(" ");if(2===i.length){const n=i[0].substring(1,i[0].length-1);void 0===e.name[n]&&(e.name[n]=[]);for(let s=0;s<t;s++)e.name[n].push(r),e.unit.push(i[1]),e.unitMin.push(""),e.repeat.push(!0),r++}}else s[4].split(" ").forEach(i=>{if(Lt.UNIT.test(i))for(let n=0;n<t;n++)e.unit.push(i),e.unitMin.push(""),e.repeat.push(!0),r++})}else Lt.UNIT.test(s[1])&&(e.unit.push(h(s[1])),e.unitMin.push(""),e.repeat.push(!1),r++)}else t[2===n?"row":"column"].auto.push(e.convertPX(s[1]))}}),e.cssSort("order"),!e.has("gridTemplateAreas")&&e.every(e=>"auto"===e.css("gridRowStart")&&"auto"===e.css("gridColumnStart"))){const i=n?["top","bottom"]:["left","right"];let s,r=0,a=0,l=0;e.each((e,c)=>{(void 0===s||e.linear[i[0]]>=s.linear[i[1]]||a>0&&a===l)&&(l=Math.max(a,l),r++,a=1);const h=e.css("gridRowEnd"),d=e.css("gridColumnEnd");let u=1,p=1;if(h.startsWith("span")?u=parseInt(h.split(" ")[1]):k(h)&&(u=parseInt(h)-r),d.startsWith("span")?p=parseInt(d.split(" ")[1]):k(d)&&(p=parseInt(d)-a),1===a&&l>0){const e=n?[2,1,3]:[3,0,2];let i=!1;do{const n=[].fill(1);for(const t of o){const i=t.placement;if(i[e[0]]>r)for(let t=i[e[1]];t<i[e[2]];t++)n[t-1]=0}for(let e=0,t=0,s=0;e<n.length;e++)if(n[e]){if(0===t&&(s=e),++t===p){a=s+1,i=!0;break}}else t=0;i||(t.emptyRows[r-1]=n,r++)}while(!i)}o[c]={placement:n?[r,a,r+u,a+p]:[a,r,a+p,r+u],rowSpan:u,columnSpan:p},a+=p,s=e})}else e.css("gridTemplateAreas").split(/"[\s\n]+"/).map(e=>P(e.trim(),'"')).forEach((e,i)=>{e.split(" ").forEach((e,n)=>{"."!==e&&(void 0===t.templateAreas[e]?t.templateAreas[e]={rowStart:i,rowSpan:1,columnStart:n,columnSpan:1}:(t.templateAreas[e].rowSpan=i-t.templateAreas[e].rowStart+1,t.templateAreas[e].columnSpan++))})}),e.each((e,i)=>{const n=[e.css("gridRowStart"),e.css("gridColumnStart"),e.css("gridRowEnd"),e.css("gridColumnEnd")],s=[];let r=1,a=1;for(let e=0;e<n.length;e++){const i=n[e];let r=t.templateAreas[i];if(void 0===r){const n=/^([\w\-]+)-(start|end)$/.exec(i);if(n&&(r=t.templateAreas[n[1]]))if("start"===n[2])switch(e){case 0:case 2:s[e]=r.rowStart+1;break;case 1:case 3:s[e]=r.columnStart+1}else switch(e){case 0:case 2:s[e]=r.rowStart+r.rowSpan+1;break;case 1:case 3:s[e]=r.columnStart+r.columnSpan+1}}else switch(e){case 0:s[e]=r.rowStart+1;break;case 1:s[e]=r.columnStart+1;break;case 2:s[e]=r.rowStart+r.rowSpan+1;break;case 3:s[e]=r.columnStart+r.columnSpan+1}}if(s.filter(e=>e).length<4){function l(e,t){if(k(e))return s[t]=parseInt(e),!0;if(e.startsWith("span")){const i=parseInt(e.split(" ")[1]);return s[t-2]?s[t]=s[t-2]+i:t%2==0?r=i:a=i,!0}return!1}for(let e=0;e<n.length;e++){const i=n[e];if("auto"!==i&&!s[e]&&!l(i,e)){const r=t[e%2==0?"row":"column"],a=i.split(" ");1===a.length&&(a[1]=a[0],a[0]="1");const o=parseInt(a[0]);if(r.name[a[1]]){const t=r.name[a[1]].length;o<=t?s[e]=r.name[a[1]][o-1]+(a[1]===n[e-2]?1:0):r.autoFill&&o>t&&(s[e]=o+(a[1]===n[e-2]?1:0))}}s[e]||l(i,e)}}o[i]={placement:s,rowSpan:r,columnSpan:a}});{const e=t[n?"column":"row"];e.count=Math.max(e.unit.length,1);for(let t=0;t<o.length;t++){const i=o[t];i&&(e.count=W([e.count,n?i.columnSpan:i.rowSpan,i.placement[n?1:0]||0,(i.placement[n?3:2]||0)-1]))}if(e.autoFill||e.autoFit){function d(t){const i=[],n=[];for(let s=0;s<t.length;s++)e.repeat[s]?n.push(t[s]):i.push(t[s]);const s=e.count-i.length,r=[];for(let t=0;t<e.count;t++){if(e.repeat[t]){for(let e=0,i=0;e<s;t++,e++,i++)i===n.length&&(i=0),r[t]=n[i];break}i.length&&(r[t]=i.shift())}return r}0===e.unit.length&&(e.unit.push("auto"),e.unitMin.push(""),e.repeat.push(!0)),e.unit=d(e.unit),e.unitMin=d(e.unitMin)}}if(e.each((e,i)=>{const h=o[i],d=h.placement,u=n?h.rowSpan:h.columnSpan,p=n?h.columnSpan:h.rowSpan,f=n?t.column.count:t.row.count,g=n?0:1,m=n?1:0,b=n?2:3,y=n?3:2;for(;!d[0]||!d[1];){const e=d.slice(0);if(!e[g]){let t=r.length;for(let i=0,n=0,s=-1;i<t;i++)if(!c[i])if(void 0===a[i]||a[i]<f){if(0===n&&(s=i,t=Math.max(t,i+u)),++n===u){e[g]=s+1;break}}else n=0,s=-1,t=r.length}if(e[g]){if(!e[m]){e[b]||(e[b]=e[g]+u);const t=[];for(let i=e[g]-1;i<e[b]-1;i++)if(void 0===r[i])t.push([[0,-1]]);else{if(!(r[i].map(e=>e).length+p<=f))break;{const e=[];let n=0;for(let t=0,s=-1;t<f;t++)void 0===r[i][t]&&(-1===s&&(s=t),n++),(r[i][t]||t===f-1)&&(n>=p&&e.push([s,s+n]),s=-1,n=0);if(!e.length)break;t.push(e)}}if(p===t.length)if(t.length>1)e:for(const i of t[0])for(let n=i[0];n<i[1];n++)for(let i=1;i<t.length;i++)for(let s=0;s<t[i].length;s++){const r=t[i][s];if(n>=r[0]&&(-1===r[1]||n+p<=r[1])){e[m]=n+1;break e}}else e[m]=t[0][0][0]+1}}else d[g]=r.length+1,d[m]||(d[m]=1);e[g]&&e[m]?(d[g]=e[g],d[m]=e[m]):e[g]&&(c[e[g]-1]=!0)}d[b]||(d[b]=d[g]+u),d[y]||(d[y]=d[m]+p),function(e,t){if(t.every(e=>e>0)){for(let i=t[n?0:1]-1;i<t[n?2:3]-1;i++){void 0===r[i]&&(r[i]=[]);for(let s=t[n?1:0]-1;s<t[n?3:2]-1;s++)void 0===a[i]&&(a[i]=0),void 0===r[i][s]&&(r[i][s]=[],a[i]++),r[i][s].push(e)}return!0}return!1}(e,d)&&(e.data(l.CSS_GRID,"cellData",{rowStart:d[0]-1,rowSpan:d[2]-d[0],columnStart:d[1]-1,columnSpan:d[3]-d[1]}),s&&(c={}))}),n)t.rowData=r;else for(let e=0;e<r.length;e++)for(let i=0;i<r[e].length;i++)void 0===t.rowData[i]&&(t.rowData[i]=[]),t.rowData[i][e]=r[e][i];if(t.rowData.length){for(const e of t.rowData){t.column.count=Math.max(e.length,t.column.count);for(const i of e)i&&i.forEach(e=>t.children.add(e))}if(t.children.size===e.length){t.row.count=t.rowData.length;const i=new Set;for(let e=0;e<t.row.count;e++)for(let n=0;n<t.column.count;n++){const s=t.rowData[e][n];s&&s.forEach(s=>{if(s&&!i.has(s)){const r=s.data(l.CSS_GRID,"cellData"),a=e+(r?r.rowSpan-1:0);n+(r?r.columnSpan-1:0)<t.column.count-1&&s.modifyBox(4,t.column.gap),a<t.row.count-1&&s.modifyBox(8,t.row.gap),i.add(s)}})}e.retain(Array.from(t.children)),e.cssSort("zIndex"),e.data(l.CSS_GRID,"mainData",t)}}return{output:""}}}class Pt extends dt{static createDataAttribute(e,t){const i=e.flexbox;return{wrap:i.wrap.startsWith("wrap"),wrapReverse:"wrap-reverse"===i.wrap,directionReverse:i.direction.endsWith("reverse"),justifyContent:i.justifyContent,rowDirection:i.direction.startsWith("row"),rowCount:0,columnDirection:i.direction.startsWith("column"),columnCount:0,children:t}}condition(e){return e.flexElement&&e.length>0}processNode(e){const t=this.application.controllerHandler,i=e.children.filter(e=>e.pageFlow),n=Pt.createDataAttribute(e,i);if(e.cssTry("display","block")){for(const e of i)if(e.element){const t=e.element.getBoundingClientRect(),i=e.unsafe("initial");Object.assign(i.bounds,{width:t.width,height:t.height})}e.cssFinally("display")}if(n.wrap){function s(s,r,a){const o=new Map;i.sort((e,t)=>U(e.linear[s],t.linear[s])?e.linear[r]>=t.linear[r]?1:-1:e.linear[s]<t.linear[s]?-1:1);for(const e of i){const t=Math.round(e.linear[s]),i=o.get(t)||[];i.push(e),o.set(t,i)}let l=0,c=0;for(const i of o.values()){const n=t.createNodeGroup(i[0],i,e);n.siblingIndex=c++;const s=n.unsafe("box");s&&(s[a]=e.box[a]),n.alignmentType|=128,l=Math.max(i.length,l)}e.sort(Fe.siblingIndex),n.rowDirection?(n.rowCount=o.size,n.columnCount=l):(n.rowCount=l,n.columnCount=o.size)}n.rowDirection?s(n.wrapReverse?"bottom":"top","left","right"):s("left","top","bottom")}else i.some(e=>0!==e.flexbox.order)&&e.sort(n.directionReverse?(e,t)=>e.flexbox.order<=t.flexbox.order?1:-1:(e,t)=>e.flexbox.order>=t.flexbox.order?1:-1),n.rowDirection?(n.rowCount=1,n.columnCount=e.length):(n.rowCount=e.length,n.columnCount=1);return e.data(l.FLEXBOX,"mainData",n),{output:""}}}class Vt extends dt{constructor(){super(...arguments),this.options={columnBalanceEqual:!1}}static createDataAttribute(){return{paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,columnCount:0}}static createDataCellAttribute(){return{rowSpan:0,columnSpan:0,index:-1,cellStart:!1,cellEnd:!1,rowEnd:!1,rowStart:!1,siblings:[]}}condition(e){return e.length>1&&!e.flexElement&&!e.gridElement&&!e.has("listStyle")&&(e.every(e=>e.pageFlow&&!e.visibleStyle.background&&(!e.inlineFlow||e.blockStatic))&&(e.some(e=>e.length>1)&&e.every(e=>e.length>0&&Fe.linearX(e.children))||e.every(e=>"list-item"===e.display&&!e.has("listStyleType")))||"table"===e.display&&e.every(e=>"table-row"===e.display&&e.every(e=>"table-cell"===e.display)))}processNode(e){const t=[],i=this.options.columnBalanceEqual;let n=[];if(i){const t=[];e.each((e,i)=>{t[i]=[],e.each(e=>t[i].push(e.bounds.width)),n.push(e.duplicate())});const i=n[t.findIndex(e=>{return e===t.reduce((e,t)=>{if(e.length===t.length){return e.reduce((e,t)=>e+t,0)<t.reduce((e,t)=>e+t,0)?e:t}return e.length<t.length?e:t})})];if(i&&i.length>1){let e=-1,t=[],s=!1;for(let r=0;r<i.length;r++){const a=i[r].bounds,o=[];if(r<i.length-1)for(let e=0;e<n.length;e++)if(n[e]===i)o.push(r);else{const t=n[e].findIndex((t,i)=>i>=r&&Math.floor(t.bounds.width)===Math.floor(a.width)&&i<n[e].length-1);if(-1===t){o.length=0;break}o.push(t)}else for(let e=0;e<n.length;e++)if(n[e].length>i.length){const r=n[e].splice(t[e]+(s?2:1),n[e].length-i.length);n[e][t[e]+(s?1:0)].data(l.GRID,"cellData",{siblings:[...r]})}if(o.length===n.length){const i=o.reduce((e,t)=>Math.min(e,t));if((e=o.reduce((e,t)=>Math.max(e,t)))>i)for(let e=0;e<n.length;e++)if(o[e]>i){const r=n[e].splice(i,o[e]-i);n[e][t[e]+(s?1:0)].data(l.GRID,"cellData",{siblings:[...r]})}t=o,s=!0}else t=[].fill(r),s=!1}}else n.length=0}else{function s(e){for(const t of n){const i=t.findIndex(t=>U(e.linear.top,t.linear.top)||e.linear.top>t.linear.top&&e.linear.top<t.linear.bottom);if(-1!==i)return i}return-1}const i={};for(const t of e)for(const e of t){const t=Math.floor(e.linear.left);void 0===i[t]&&(i[t]=[]),i[t].push(e)}const r=Object.keys(i);if(r.length){const e=[];for(let t=0;t<r.length;t++){const a=i[r[t]];if(0===t&&0===a.length)return{output:""};e[t]=0===t?0:e[t-1];for(let i=0;i<a.length;i++){const r=a[i],[o,l]=[r.linear.left,r.linear.right];if(0===t||o>=e[t-1])if(void 0===n[t]&&(n[t]=[]),0===t||n[0].length===a.length)n[t][i]=r;else{const e=s(r);if(-1===e)return{output:""};n[t][e]=r}else{const e=n.length-1;if(n[e]){const t=$(n[e].map(e=>e.linear.left)),i=W(n[e].map(e=>e.linear.right));if(o>t&&l>i){const t=n.filter(e=>e),i=s(r);-1!==i&&void 0===t[t.length-1][i]&&(n[e].length=0)}}}e[t]=Math.max(l,e[t])}}for(let t=0,i=-1;t<e.length;t++)void 0===n[t]?-1===i?i=t-1:t===e.length-1&&(e[i]=e[t]):-1!==i&&(e[i]=e[t-1],i=-1);const a=(n=n.filter((i,n)=>!!(i&&i.length>0)&&(t.push(e[n]),!0))).reduce((e,t)=>Math.max(e,t.length),0);for(let e=0;e<a;e++)for(let t=0;t<n.length;t++)void 0===n[t][e]&&(n[t][e]={spacer:1})}t.push(e.box.right)}if(n.length>1&&n[0].length===e.length){const s=Object.assign(Vt.createDataAttribute(),{columnCount:i?n[0].length:n.length});e.duplicate().forEach(t=>e.remove(t)&&t.hide());for(let s=0,r=0;s<n.length;s++){let a=0;for(let o=0,c=0;o<n[s].length;o++){const h=n[s][o];if(h.spacer)1===h.spacer&&a++;else{h.parent=e;const d=Object.assign(Vt.createDataCellAttribute(),h.data(l.GRID,"cellData")||{});if(i)d.rowStart=0===o,d.rowEnd=o===n[s].length-1,d.cellStart=0===s&&0===o,d.cellEnd=s===n.length-1&&d.rowEnd,d.index=o;else{let e=1,i=1+a;for(let e=s+1;e<n.length&&1===n[e][o].spacer;e++)i++,n[e][o].spacer=2;if(1===i)for(let t=o+1;t<n[s].length&&1===n[s][t].spacer;t++)e++,n[s][t].spacer=2;const l=Math.min(s+(i-1),t.length-1);d.siblings.push(...K(Array.from(h.documentParent.element.children),e=>{const i=Me(e);return i&&i.visible&&!i.rendered&&i.linear.left>=h.linear.right&&i.linear.right<=t[l]?i:null})),d.rowSpan=e,d.columnSpan=i,d.rowStart=0==c++,d.rowEnd=i+s===n.length,d.cellStart=0==r++,d.cellEnd=d.rowEnd&&o===n[s].length-1,d.index=s,a=0}h.data(l.GRID,"cellData",d)}}}Z(e.children,"documentParent.siblingIndex","siblingIndex"),e.each((e,t)=>e.siblingIndex=t),e.tableElement&&"collapse"===e.css("borderCollapse")&&(e.modifyBox(32,null),e.modifyBox(64,null),e.modifyBox(128,null),e.modifyBox(256,null)),e.data(l.GRID,"mainData",s)}return{output:""}}}function Ot(e){return e.visibleStyle.backgroundImage&&!e.visibleStyle.backgroundRepeat}class Gt extends dt{static createDataAttribute(){return{ordinal:"",imageSrc:"",imagePosition:""}}condition(e){return super.condition(e)&&e.length>0&&(e.every(e=>e.blockStatic)||e.every(e=>e.inlineVertical)||e.every(e=>e.floating)&&1===Fe.floated(e.children).size||e.every((t,i)=>!t.floating&&(0===i||i===e.length-1||t.blockStatic||t.inlineFlow&&e.item(i-1).blockStatic&&e.item(i+1).blockStatic)))&&(e.some(e=>"list-item"===e.display&&("none"!==e.css("listStyleType")||Ot(e)))||e.every(e=>"LI"!==e.tagName&&"none"===e.cssInitial("listStyleType")&&Ot(e)))}processNode(e){let t=0;return e.each(e=>{const n=Gt.createDataAttribute();if("list-item"===e.display||e.has("listStyleType")||Ot(e)){let s=e.css("listStyleImage");if(s&&"none"!==s)n.imageSrc=s;else switch(e.css("listStyleType")){case"disc":n.ordinal="●";break;case"square":n.ordinal="■";break;case"decimal":n.ordinal=`${""+(t+1)}.`;break;case"decimal-leading-zero":n.ordinal=`${(t<9?"0":"")+(t+1)}.`;break;case"lower-alpha":case"lower-latin":n.ordinal=`${E(t).toLowerCase()}.`;break;case"upper-alpha":case"upper-latin":n.ordinal=`${E(t)}.`;break;case"lower-roman":n.ordinal=`${w(t+1).toLowerCase()}.`;break;case"upper-roman":n.ordinal=`${w(t+1)}.`;break;case"none":s="";let r="";e.visibleStyle.backgroundRepeat||(s=e.css("backgroundImage"),r=e.css("backgroundPosition")),s&&"none"!==s&&(n.imageSrc=s,n.imagePosition=r,e.exclude({resource:i.IMAGE_SOURCE}));break;default:n.ordinal="○"}t++}e.data(l.LIST,"mainData",n)}),{output:""}}postBaseLayout(e){e.modifyBox(16,null),e.modifyBox(256,null)}}class Ht extends dt{static createDataAttribute(){return{layoutType:0,rowCount:0,columnCount:0,expand:!1}}processNode(e){function t(t){t.data(l.TABLE,"percent",`${Math.round(t.bounds.width/e.bounds.width*100)}%`),t.data(l.TABLE,"expand",!0)}function i(e){e.css("width",_(e.bounds.width),!0)}const n=Ht.createDataAttribute(),s=[],r=e.filter(e=>"THEAD"===e.tagName),a=e.filter(e=>"TBODY"===e.tagName),o=e.filter(e=>"TFOOT"===e.tagName),c=Array.from(e.element.children).find(e=>"COLGROUP"===e.tagName);r.length&&(r[0].cascade().filter(e=>"TH"===e.tagName||"TD"===e.tagName).forEach(e=>e.inherit(r[0],"styleMap")),s.push(...r[0].children),r.forEach(e=>e.hide())),a.length&&a.forEach(e=>{s.push(...e.children),e.hide()}),o.length&&(o[0].cascade().filter(e=>"TH"===e.tagName||"TD"===e.tagName).forEach(e=>e.inherit(o[0],"styleMap")),s.push(...o[0].children),o.forEach(e=>e.hide()));const h="fixed"===e.css("tableLayout"),d="collapse"===e.css("borderCollapse"),[u,p]=d?[0,0]:e.css("borderSpacing").split(" ").map(e=>parseInt(e));u>0?(e.modifyBox(256,u),e.modifyBox(64,u)):(e.modifyBox(256,null),e.modifyBox(64,null)),p>0?(e.modifyBox(32,p),e.modifyBox(128,p)):(e.modifyBox(32,null),e.modifyBox(128,null));const f=_(u>1?Math.round(u/2):u),g=_(p>1?Math.round(p/2):p),m=[],b=[],y=[];let S=[].fill(0),A=[],E=0;for(let e=0;e<s.length;e++){const t=s[e];m[e]=u,y[e]=[];for(let i=0;i<t.length;i++){const n=t.item(i),r=n.element;for(let t=0;t<r.rowSpan-1;t++){const i=e+1+t;void 0!==S[i]&&(S[i]+=r.colSpan)}if(!n.visibleStyle.backgroundImage&&!n.visibleStyle.backgroundColor)if(c){const t=he(c.children[S[e]]);t.background?r.style.background=t.background:t.backgroundColor&&(r.style.backgroundColor=t.backgroundColor)}else{let e=be(r,"background",["rgba(0, 0, 0, 0)","transparent"],["TABLE"]);""!==e?r.style.background=e:""!==(e=be(r,"backgroundColor",["rgba(0, 0, 0, 0)","transparent"],["TABLE"]))&&(r.style.backgroundColor=e)}switch(n.tagName){case"TH":n.cssInitial("textAlign")||n.css("textAlign","center");case"TD":n.cssInitial("verticalAlign")||n.css("verticalAlign","middle")}const a=n.cssInitial("width"),o=S[e],l=void 0===A[o]||"auto"===A[o];if(0===e||l||!h)if(""===a||"auto"===a)void 0===A[o]?(A[o]=a||"0px",b[o]=0):e===s.length-1&&l&&0===b[o]&&(b[o]=n.bounds.width);else{const e=B(A[o]),t=M(a);(l||n.bounds.width<b[o]||n.bounds.width===b[o]&&(e||t||e&&t||t&&M(A[o])&&x(a)>x(A[o])||e&&B(a)&&v(a)>v(A[o])))&&(A[o]=a),(l||1===r.colSpan)&&(b[o]=n.bounds.width)}0===E&&(E=n.multiLine),(n.length||n.inlineText)&&(m[e]+=n.bounds.width+u),n.cssApply({marginTop:0===e?"0px":g,marginRight:i<t.length-1?f:"0px",marginBottom:e+r.rowSpan-1>=s.length-1?"0px":g,marginLeft:0===S[e]?"0px":f},!0),S[e]+=r.colSpan}}if(e.has("width",2)&&A.some(e=>M(e))&&(A=A.map((e,t)=>("auto"===e&&b[t]>0&&(e=_(b[t])),e))),A.every(e=>M(e))&&A.reduce((e,t)=>e+parseFloat(t),0)>1){let e=100;A=A.map(t=>{const i=parseFloat(t);return e<=0?t="0px":e-i<0&&(t=T(e)),e-=i,t})}else if(A.every(e=>B(e))){const t=A.reduce((e,t)=>e+parseInt(t),0);t<e.width?A=A.map(e=>"0px"!==e?`${parseInt(e)/t*100}%`:e):t>e.width&&(e.css("width","auto",!0),h||e.cascade().forEach(e=>e.css("width","auto",!0)))}const w=A.reduce((e,t)=>e+(M(t)?parseFloat(t):0),0);n.layoutType=(()=>{if(A.some(e=>M(e))||A.every(e=>B(e)&&"0px"!==e))return 3;if(A.every(e=>e===A[0])){if(E)return e.some(e=>e.has("height"))?2:3;if("auto"===A[0])return e.has("width")?3:0;if(e.hasWidth)return 2}return A.every(e=>"auto"===e||B(e)&&"0px"!==e)?1:0})(),(E||1===n.layoutType&&!e.hasWidth)&&(n.expand=!0);const I=W(S);let k=s.length;const C=e.find(e=>"CAPTION"===e.tagName);e.clear(),C&&(C.hasWidth||ee(8)||(C.textElement?C.has("maxWidth")||C.css("maxWidth",_(C.bounds.width)):C.bounds.width>W(m)&&i(C)),C.cssInitial("textAlign")||C.css("textAlign","center"),k++,C.data(l.TABLE,"colSpan",I),C.parent=e),S=[].fill(0);const N=e.hasWidth;for(let r=0;r<s.length;r++){const a=s[r],o=a.duplicate();for(let s=0;s<o.length;s++){const a=o[s],c=a.element,d=c.rowSpan,u=c.colSpan;for(let e=0;e<d-1;e++){const t=r+1+e;void 0!==S[t]&&(S[t]+=u)}d>1&&a.data(l.TABLE,"rowSpan",d),u>1&&a.data(l.TABLE,"colSpan",u),a.has("verticalAlign")||a.css("verticalAlign","middle");const p=A[S[r]];if("undefined"!==p)switch(n.layoutType){case 3:"auto"===p?w>=1?(i(a),a.data(l.TABLE,"exceed",!N),a.data(l.TABLE,"downsized",!0)):t(a):M(p)?(a.data(l.TABLE,"percent",p),a.data(l.TABLE,"expand",!0)):B(p)&&parseInt(p)>0?a.bounds.width>=parseInt(p)?(i(a),a.data(l.TABLE,"expand",!1),a.data(l.TABLE,"downsized",!1)):h?(t(a),a.data(l.TABLE,"downsized",!0)):(i(a),a.data(l.TABLE,"expand",!1)):(a.has("width")&&!a.has("width",32)||i(a),a.data(l.TABLE,"expand",!1));break;case 2:a.css("width","0px");break;case 1:"auto"===p?a.css("width","0px"):(h?a.data(l.TABLE,"downsized",!0):i(a),a.data(l.TABLE,"expand",!1))}S[r]+=u;for(let e=0;e<d;e++)for(let t=0;t<u;t++)y[r+e].push(a);a.parent=e}if(S[r]<I){o[o.length-1].data(l.TABLE,"spaceSpan",I-S[r])}a.hide()}if(d){const t=e.css("borderTopColor"),i=e.css("borderTopStyle"),n=e.css("borderTopWidth"),s=e.css("borderRightColor"),r=e.css("borderRightStyle"),a=e.css("borderRightWidth"),o=e.css("borderBottomColor"),l=e.css("borderBottomStyle"),c=e.css("borderBottomWidth"),h=e.css("borderLeftColor"),d=e.css("borderLeftStyle"),u=e.css("borderLeftWidth");for(let e=0;e<k;e++)for(let p=0;p<I;p++){const f=y[e][p];if(f&&"visible"===f.css("visibility")){if(0===e&&f.borderTopWidth<parseInt(n)&&f.cssApply({borderTopColor:t,borderTopStyle:i,borderTopWidth:n}),e>=0&&e<k-1){const t=y[e+1][p];t&&t!==f&&"visible"===t.css("visibility")&&(f.borderBottomWidth>=t.borderTopWidth?t.css("borderTopWidth","0px"):f.css("borderBottomWidth","0px"))}if(e===k-1&&f.borderBottomWidth<parseInt(c)&&f.cssApply({borderBottomColor:o,borderBottomStyle:l,borderBottomWidth:c}),0===p&&f.borderLeftWidth<parseInt(u)&&f.cssApply({borderLeftColor:h,borderLeftStyle:d,borderLeftWidth:u}),p>=0&&p<I-1){const t=y[e][p+1];t&&t!==f&&"visible"===t.css("visibility")&&(f.borderRightWidth>=t.borderLeftWidth?t.css("borderLeftWidth","0px"):f.css("borderRightWidth","0px"))}p===I-1&&f.borderRightWidth<parseInt(a)&&f.cssApply({borderRightColor:s,borderRightStyle:r,borderRightWidth:a})}}e.cssApply({borderTopWidth:"0px",borderRightWidth:"0px",borderBottomWidth:"0px",borderLeftWidth:"0px"})}return n.rowCount=k,n.columnCount=I,e.data(l.TABLE,"mainData",n),{output:""}}}function $t(e,t){const i=e.has("minHeight",2)?e.toInt("minHeight"):0;e.css("minHeight",_(Math.max(t,i)))}function Wt(e,t,i){!t.lineBreak&&!t.plainText&&t===e[i?"firstChild":"lastChild"]&&e[i?"marginTop":"marginBottom"]>0&&0===e[i?"borderTopWidth":"borderBottomWidth"]&&0===e[i?"paddingTop":"paddingBottom"]&&t.modifyBox(i?2:8,null)}let zt,Xt;e.settings={},e.system={};const Ut=new Set,jt=new Map;function Yt(e){if(zt){if(e instanceof dt)return zt.extensionManager.include(e);if(C(e)){e=e.trim();const t=zt.builtInExtensions[e]||Kt(e);if(t)return zt.extensionManager.include(t)}}return!1}function qt(t,i){if("object"==typeof i){if(t instanceof dt)return Object.assign(t.options,i),!0;if(C(t)&&zt){t=t.trim();const n=zt.extensionManager.retrieve(t)||Array.from(Ut).find(e=>e.name===t);if(n)return Object.assign(n.options,i),!0;if(jt.set(t,i),e.settings.handleExtensionsAsync)return!0}}return!1}function Kt(e){return zt&&zt.extensionManager.retrieve(e)}function Zt(){zt&&zt.reset()}const Qt={base:{Application:class{constructor(e,t,i,n,s){this.framework=e,this.nodeConstructor=s,this.initialized=!1,this.closed=!1,this.builtInExtensions={},this.extensions=new Set,this.parseElements=new Set,this.session={cache:new Fe,image:new Map,renderQueue:new Map,excluded:new Fe},this.processing={cache:new Fe,depthMap:new Map,node:null,layout:null,excluded:new Fe},this._renderPosition=new Map,this._views=[],this._includes=[],this.controllerHandler=new t(this,this.processing.cache),this.resourceHandler=new i(this,this.processing.cache),this.extensionManager=new n(this,this.processing.cache)}registerController(e){e.application=this,e.cache=this.processing.cache,this.controllerHandler=e}registerResource(e){e.application=this,e.cache=this.processing.cache,this.resourceHandler=e}finalize(){const e=this.rendered;for(const t of e)t.hasBit("excludeProcedure",n.LAYOUT)||t.setLayout(),t.hasBit("excludeProcedure",n.ALIGNMENT)||t.setAlignment();for(const t of e)t.hasBit("excludeProcedure",n.OPTIMIZATION)||t.applyOptimizations(),t.hasBit("excludeProcedure",n.CUSTOMIZATION)||t.applyCustomizations();for(const e of this.extensions)for(const t of e.subscribers)e.postProcedure(t);for(const e of this.rendered)e.hasBit("excludeResource",i.BOX_SPACING)||e.setBoxSpacing();for(const e of this.extensions)e.afterProcedure();this.processRenderQueue(),this.resourceHandler.finalize(this.sessionData),this.controllerHandler.finalize(this.sessionData);for(const e of this.extensions)e.afterFinalize();ae("__css.placeholder"),this.closed=!0}saveAllToDisk(){this.resourceHandler.fileHandler&&this.resourceHandler.fileHandler.saveAllToDisk(this.sessionData)}reset(){this.session.cache.each(e=>e.baseElement&&Be(e.baseElement,"node","style","styleMap"));for(const e of this.parseElements)delete e.dataset.iteration,delete e.dataset.layoutName;this.appName="",this.session.renderQueue.clear(),this.session.image.clear(),this.session.cache.reset(),this.session.excluded.reset(),this.processing.cache.reset(),this.controllerHandler.reset(),this.resourceHandler.reset(),this._views.length=0,this._includes.length=0,this._renderPosition.clear();for(const e of this.extensions)e.subscribers.clear(),e.subscribersChild.clear();this.closed=!1}parseDocument(...e){let t;this.parseElements.clear(),this.initialized=!1,this.setStyleMap(),""===this.appName&&0===e.length&&e.push(document.body);for(const t of e){const e="string"==typeof t?document.getElementById(t):t;Ie(e)&&this.parseElements.add(e)}const i=this.parseElements.values().next().value,n=()=>{this.initialized=!1,this.userSettings.preloadImages&&ae("__css.preload");for(const[e,t]of this.session.image.entries())ot.ASSETS.images.set(e,t);for(const e of this.extensions)e.beforeParseDocument();for(const e of this.parseElements){""===this.appName&&(this.appName=e.id||"untitled");let t=D(e.dataset.filename).replace(RegExp(`.${this.controllerHandler.localSettings.layout.fileExtension}$`),"");""===t&&(t=e.id||`document_${this.size}`);const i=parseInt(e.dataset.iteration||"0")+1;e.dataset.iteration=""+i,e.dataset.layoutName=b(i>1?`${t}_${i}`:t),this.createCache(e)&&(this.setBaseLayout(),this.setConstraints(),this.setResources())}for(const e of this.extensions)for(const t of e.subscribers)e.postParseDocument(t);for(const e of this.extensions)e.afterParseDocument();"function"==typeof t&&t.call(this)};if(this.userSettings.preloadImages){Array.from(this.parseElements).forEach(e=>{e.querySelectorAll("svg image").forEach(e=>{const t=L(e.href.baseVal);this.session.image.set(t,{width:e.width.baseVal.value,height:e.height.baseVal.value,uri:t})})});for(const e of this.session.image.values())if(0===e.width&&0===e.height&&e.uri){const t=document.createElement("img");t.src=e.uri,t.complete&&t.naturalWidth>0&&t.naturalHeight>0?(e.width=t.naturalWidth,e.height=t.naturalHeight):(t.className="__css.preload",t.style.display="none",i.appendChild(t))}}const s=[];for(const e of this.parseElements)Array.from(e.querySelectorAll("IMG")).forEach(e=>{e instanceof SVGImageElement||(e.complete?this.addImagePreload(e):s.push(e))});return 0===s.length?n():(this.initialized=!0,Promise.all(s.map(e=>new Promise((t,i)=>{e.onload=t,e.onerror=i}))).then(e=>{if(Array.isArray(e))for(const t of e)try{this.addImagePreload(t.target)}catch(e){}n()}).catch(e=>{const t=e.target?e.target.src:"";X(t)&&!confirm(`FAIL: ${t}`)||n()})),{then:e=>{this.initialized?t=e:e()}}}renderNode(e){return 0===e.itemCount?this.controllerHandler.renderNode(e):(this.saveRenderPosition(e.node,e.renderPosition),this.controllerHandler.renderNodeGroup(e))}renderLayout(e){let t="";const i=I(e.renderType,64);return i&&I(e.renderType,8)?t=this.processFloatHorizontal(e):i&&I(e.renderType,16)?t=this.processFloatVertical(e):0!==e.containerType&&(t=this.renderNode(e)),t}addLayoutFile(e,t,i,n=!1){const s={pathname:i=i||this.controllerHandler.localSettings.layout.pathName,filename:e,content:t};n&&this._views.length&&""===this._views[0].content?this._views[0]=s:this._views.push(s),this.processing.layout=s}addIncludeFile(e,t){this._includes.push({filename:e,content:t,pathname:this.controllerHandler.localSettings.layout.pathName})}addRenderTemplate(e,t,i,n=!1){if(""!==i){if(n&&t.renderChildren.some(e=>{for(const i of this.processing.depthMap.values()){const n=e.renderPositionId,s=i.get(n);if(s){const r=t.renderDepth+1;return e.renderDepth!==r&&i.set(n,this.controllerHandler.replaceIndent(s,r,this.processing.cache.children)),!0}}return!1}),!this.parseElements.has(t.element))if(t.dataset.target){const n=document.getElementById(t.dataset.target);if(n&&n!==e.element)return this.addRenderQueue(t.dataset.target,i),void(t.positioned=!0)}else if(e.dataset.target&&document.getElementById(e.dataset.target))return this.addRenderQueue(e.controlId,i),void(t.dataset.target=e.controlId);this.processing.depthMap.has(e.id)||this.processing.depthMap.set(e.id,new Map);const s=this.processing.depthMap.get(e.id);s&&s.set(t.renderPositionId,i)}}addRenderQueue(e,t){const i=this.session.renderQueue.get(e)||[];i.push(t),this.session.renderQueue.set(e,i)}addImagePreload(e){e&&e.complete&&X(e.src)&&this.session.image.set(e.src,{width:e.naturalWidth,height:e.naturalHeight,uri:e.src})}saveRenderPosition(e,t){let i;if(e.groupParent){const t=e.parent;if(t){const i=t.id,n=this._renderPosition.get(i);let s;if(n){const r=n.children.filter(t=>!e.contains(t));if(e.siblingIndex<r.length){r.splice(e.siblingIndex,0,e);for(let t=e.siblingIndex+1;t<r.length;t++)r[t].siblingIndex=t;s=r}else e.siblingIndex=r.length,r.push(e);this._renderPosition.set(i,{parent:t,children:r})}else s=t.children;if(s)for(let t=e.siblingIndex+1;t<s.length;t++)s[t]&&(s[t].siblingIndex=t)}}if(t){const t=this._renderPosition.get(e.id);t?(i=t.children.filter(t=>!e.contains(t))).push(...e.children):i=e.duplicate(),this._renderPosition.set(e.id,{parent:e,children:i})}}createNode(e){return new this.nodeConstructor(this.nextId,e,this.controllerHandler.afterInsertNode)}toString(){return this._views.length?this._views[0].content:""}createCache(e){const t=(()=>{if(e===document.body){let e=0;return document.querySelectorAll(Array.from(document.body.childNodes).some(t=>this.conditionElement(t)&&++e>1)?"body, body *":"body *")}return e.querySelectorAll("*")})();this.processing.cache.afterAppend=void 0,this.processing.cache.clear(),this.processing.excluded.clear(),this.processing.node=null;for(const t of this.extensions)t.beforeInit(e);const i=this.insertNode(e);if(!i)return!1;i.parent=new this.nodeConstructor(0,e.parentElement||document.body,this.controllerHandler.afterInsertNode),i.documentRoot=!0,i.documentParent=i.parent,this.processing.node=i;const n=this.controllerHandler.localSettings;for(const i of Array.from(t))if(!this.parseElements.has(i)&&(lt(e,i,Array.from(this.extensions)).some(e=>e.init(i)),!this.parseElements.has(i)&&!(n.unsupported.tagName.has(i.tagName)||i instanceof HTMLInputElement&&n.unsupported.tagName.has(`${i.tagName}:${i.type}`)))){let t=!0,n=i.parentElement;for(;n&&n!==e;){if(this.parseElements.has(n)){t=!1;break}n=n.parentElement}t&&this.insertNode(i)}if(this.processing.cache.length){for(const e of this.processing.cache)if("SELECT"!==e.element.tagName){const t=[];let i=!1;Array.from(e.element.childNodes).forEach(e=>{if("#text"===e.nodeName)t.push(e);else if("BR"!==e.tagName){const t=Me(e);t&&!t.excluded&&(i=!0)}}),i&&t.forEach(t=>this.insertNode(t,e))}const t={},n=new Set;for(const e of this.processing.cache)if(e.styleElement){const i=e.element,s={};if("BUTTON"!==i.tagName&&"button"!==i.type){const t=e.css("textAlign");switch(t){case"center":case"right":case"end":s.textAlign=t,i.style.textAlign="left"}}e.positionRelative&&!e.positionStatic&&["top","right","bottom","left"].forEach(t=>{e.has(t)&&(s[t]=e.css(t),i.style[t]="auto")}),"rtl"===i.dir&&(i.dir="ltr",n.add(i)),t[e.id]=s}i.parent.setBounds();for(const e of this.processing.cache)e.setBounds();for(const e of this.processing.excluded)e.lineBreak||e.setBounds();for(const e of this.processing.cache)if(e.styleElement){const i=t[e.id];if(i){const t=e.element;for(const e in i)t.style[e]=i[e];n.has(t)&&(t.dir="rtl")}}for(const e of this.processing.cache)if(!e.documentRoot){let t=e.actualParent;switch(e.position){case"fixed":if(!e.positionAuto){t=i;break}case"absolute":if(t&&ct(e,t))break;if(this.userSettings.supportNegativeLeftTop){const n=e.absoluteParent;let s,r=!1;for(;t&&(t!==i||0!==t.id);){if(void 0===s){if(n===t){if(s=t,"hidden"===t.css("overflow"))break;if(e.has("right")&&!(e.right<0)||e.has("bottom")&&!(e.bottom<0)||!(e.left<0&&e.outsideX(t.box)||!e.has("left")&&e.right<0&&e.outsideX(t.box)||e.top<0&&e.outsideY(t.box)||!e.has("top")&&e.bottom<0&&e.outsideX(t.box)))break;r=!0}}else if(r&&(t.documentRoot||"hidden"===t.css("overflow")||e.withinX(t.box)&&e.withinY(t.box))){s=t;break}t=t.actualParent}s&&(t=s);break}t=e.absoluteParent}e.pageFlow||void 0!==t&&0!==t.id||(t=i),t?(e.parent=t,e.documentParent=t):e.hide()}for(const e of this.processing.cache){if(e.htmlElement&&e.length){let t=0;Array.from(e.element.childNodes).forEach(i=>{const n=Me(i);!n||n.excluded||!n.pageFlow&&n.documentParent!==e||(n.siblingIndex=t++)});const i=[];e.each(t=>{if(t.siblingIndex===Number.MAX_VALUE)for(const n of e.children)if(n.actualChildren.includes(t)||t.ascend().some(e=>n.cascade().includes(e))){let e=-1;void 0===i[e=t.zIndex>=0||n!==t.actualParent?n.siblingIndex+1:n.siblingIndex-1]&&(i[e]=[]),i[e].push(t);break}});for(let t=0;t<i.length;t++){const n=i[t];if(n){n.sort((e,t)=>e.zIndex===t.zIndex?e.id<t.id?-1:1:e.zIndex<t.zIndex?-1:1),e.each(e=>{e.siblingIndex!==Number.MAX_VALUE&&e.siblingIndex>=t&&(e.siblingIndex+=n.length)});for(let e=0;e<n.length;e++)n[e].siblingIndex=t+e}}e.sort(Fe.siblingIndex)}e.saveAsInitial()}Z(this.processing.cache.children,"depth","id");for(const t of this.extensions)t.afterInit(e);return!0}return!1}setBaseLayout(){const e=this.userSettings,i=this.controllerHandler.localSettings,n=this.processing.node,s=Array.from(this.extensions).filter(e=>!e.eventOnly),r=new Map;let a=i.baseTemplate,o=!0;function l(e,t,i){const n=r.get(e)||new Map;n.set(t,i),r.set(e,n)}function c(e){for(const t of r.values())for(const i of t.values())if(i.id===e)return void t.delete(i.id)}l(-1,0,n.parent);let h=0;for(const e of this.processing.cache.visible)l(e.depth,e.id,e),h=Math.max(e.depth,h);for(let e=0;e<h;e++)r.set(-1*e-2,new Map);this.processing.cache.afterAppend=(e=>{c(e.id),l(-1*e.depth-2,e.id,e),e.cascade().forEach(e=>{c(e.id),l(-1*e.depth-2,e.id,e)})});for(const i of r.values()){this.processing.depthMap.clear();for(const r of i.values()){if(0===r.length||r.every(e=>e.rendered))continue;const i=r.duplicate(),a=i.some(e=>e.floating),o=a?Fe.clearedAll(r):new Map,l=r.renderExtension.size?Array.from(r.renderExtension):[],c=s.filter(e=>e.subscribersChild.size);let h=-1;for(;++h<i.length;){let r=i[h];if(r.rendered||!r.visible)continue;if(r.htmlElement){const e=r.element;if(this.parseElements.has(e)&&!r.documentRoot&&!r.documentBody)continue;0===r.length&&e.children.length&&Array.from(e.children).every(e=>this.parseElements.has(e))&&(r.inlineText=!1)}let p=r.parent,f=p.hasAlign(2);const g=r.hasAlign(8192);if(r.pageFlow&&i.length>1&&h<i.length-1&&!p.hasAlign(4)&&(0===p.alignmentType||f||g)&&!r.hasBit("excludeSection",t.DOM_TRAVERSE)){const t=[],n=[],s=new Set;let l=!1;function d(e){return!n.length&&!l&&(t.push(e),!0)}function u(e){if(p.layoutVertical&&n.length){const t=n[n.length-1];if(t.layoutVertical)return e.parent=t,!0}return n.push(e),!0}let c,m,b=h,y=0;g&&p.layoutVertical&&(t.push(r),b++,y++);e:for(;b<i.length;b++,y++){const r=i[b];if(r.pageFlow){if(a){const e=o.get(r);e&&("both"===e?s.clear():s.delete(e)),r.floating&&s.add(r.float)}const i=r.previousSiblings(),c=i[i.length-1],h=r.nextSiblings().shift();if(0===y&&h)r.blockStatic||h.alignedVertically([r],[r],o)?n.push(r):t.push(r);else{if(!c)break e;if(a){const a=r.alignedVertically(i,[...t,...n,r],o,!1);if(a||e.floatOverlapDisabled&&c.floating&&r.blockStatic&&2===s.size){if(t.length){if(!e.floatOverlapDisabled&&s.size&&!c.autoMargin.horizontal&&!i.some(e=>e.lineBreak&&!o.has(e))&&"both"!==o.get(r)){const e=W(t.filter(e=>e.floating).map(e=>e.linear.bottom));if(!r.floating||r.linear.top<e){const i=Fe.floated(t);if(o.has(r)){if(!r.floating&&s.size<2&&2===i.size){r.alignmentType|=8192,l=!0,t.push(r);continue}break e}if(!a||1===i.size&&(!r.floating||s.has(r.float))){if(t.push(r),r.linear.bottom>e)break e;continue}}}break e}u(r)}else if(!d(r))break e}else if(r.alignedVertically(i))u(r);else if(!d(r))break e}}}if(t.length>1){const e=new Le(p,r,0,0,t.length,t);e.init(),c=this.controllerHandler.processTraverseHorizontal(e,i),m=t[t.length-1]}else if(n.length>1){const e=new Le(p,r,0,0,n.length,n);e.init(),c=this.controllerHandler.processTraverseVertical(e,i),(m=n[n.length-1]).blockStatic||m===i[i.length-1]||(m.alignmentType|=8192)}if(f&&m===i[i.length-1]&&(p.alignmentType^=2,f=!1),c){const e=c.layout,t=this.renderLayout(e);""!==t&&(this.addRenderTemplate(p,e.node,t,!0),p=r.parent)}}if(f&&h===i.length-1&&(p.alignmentType^=2),g&&(r.alignmentType^=8192),r.renderAs&&p.appendTry(r,r.renderAs,!1)&&(r.hide(),(r=r.renderAs).positioned&&(p=r.parent)),!r.rendered&&!r.hasBit("excludeSection",t.EXTENSION)){let e=!1;if(l.length||c.length){const t=l.slice(0);c.length&&t.push(...c.filter(e=>e.subscribersChild.has(r)));for(const i of t){const t=i.processChild(r,p);if(t.output&&this.addRenderTemplate(p,r,t.output),t.renderAs&&t.outputAs&&this.addRenderTemplate(p,t.renderAs,t.outputAs),t.parent&&(p=t.parent),e=!0===t.next,t.complete||t.next)break}}if(e)continue;if(r.styleElement&&(lt(n.element,r.element,s).some(t=>{if(t.is(r)&&t.condition(r,p)){const i=t.processNode(r,p);if(i.output&&this.addRenderTemplate(p,r,i.output),i.renderAs&&i.outputAs&&this.addRenderTemplate(p,i.renderAs,i.outputAs),i.parent&&(p=i.parent),(i.output||!0===i.include)&&(t.subscribers.add(r),r.renderExtension.add(t)),e=!0===i.next,i.complete||i.next)return!0}return!1}),e))continue}if(!r.rendered&&!r.hasBit("excludeSection",t.RENDER)){let e=new Le(p,r,r.containerType,r.alignmentType,r.length,r.children);if(0===e.containerType){let t;if(!0===(t=r.length?this.controllerHandler.processUnknownParent(e):this.controllerHandler.processUnknownChild(e)).next)continue;if(t.renderAs){i[h]=t.renderAs,h--;continue}e=t.layout}const t=this.renderLayout(e);""!==t&&this.addRenderTemplate(p,r,t)}}}for(const[e,t]of this.processing.depthMap.entries()){const i=this._renderPosition.get(e);let n;if(i)n=this.controllerHandler.sortRenderPosition(i.parent,i.children);else if(0!==e){const t=this.processing.cache.find("id",e);n=t?this.controllerHandler.sortRenderPosition(t,t.children):[]}if(n&&n.length){const i=new Map;n.forEach(e=>{const n=e.renderPositionId,s=t.get(n)||(e.companion?t.get(e.companion.renderPositionId):null);s&&i.set(n,s)}),i.size===t.size&&this.processing.depthMap.set(e,i)}}for(const e of this.extensions)e.afterDepthLevel();for(const[e,t]of this.processing.depthMap.entries())for(const[i,n]of t.entries()){const t=qe(-1!==i.indexOf("^")?i:e);-1!==a.indexOf(t)?(a=Ke(a,t,n),o=!1):this.addRenderQueue(-1!==i.indexOf("^")?`${e}|${i}`:""+e,n)}}!n.dataset.layoutName||X(n.dataset.target)&&0!==n.renderExtension.size||this.addLayoutFile(n.dataset.layoutName,o?"":a,P(D(n.dataset.pathname),"/"),n.renderExtension.size>0&&Array.from(n.renderExtension).some(e=>e.documentRoot)),o&&0===n.renderExtension.size&&n.hide(),this.processing.cache.sort((e,t)=>e.visible&&e.rendered?e.renderDepth!==t.renderDepth?e.renderDepth<t.renderDepth?-1:1:e.renderParent!==t.renderParent?e.documentParent.id<t.documentParent.id?-1:1:e.siblingIndex<t.siblingIndex?-1:1:1),this.session.cache.children.push(...this.processing.cache),this.session.excluded.children.push(...this.processing.excluded);for(const e of this.extensions)for(const t of e.subscribers)e.postBaseLayout(t);for(const e of this.extensions)e.afterBaseLayout()}setConstraints(){this.controllerHandler.setConstraints();for(const e of this.extensions)for(const t of e.subscribers)e.postConstraints(t);for(const e of this.extensions)e.afterConstraints()}setResources(){this.resourceHandler.setBoxStyle(),this.resourceHandler.setFontStyle(),this.resourceHandler.setValueString();for(const e of this.extensions)e.afterResources()}processRenderQueue(){const e={};for(const[t,i]of this.session.renderQueue.entries()){const[n,s]=t.split("|");let r=n;if(!k(r)){const e=document.getElementById(r);if(e){const t=Me(e);t&&(r=""+t.id)}}let a=i.join("\n");if(r!==n){const e=this.session.cache.find("id",parseInt(r));e&&(a=this.controllerHandler.replaceIndent(a,e.renderDepth+1,this.session.cache.children))}e[s||r]=a}for(const t of this.viewData){for(const i in e)t.content=t.content.replace(qe(i),e[i]);t.content=this.controllerHandler.replaceRenderQueue(t.content)}}processFloatHorizontal(e){const t=this.userSettings;let i=[],n="";if(0===e.cleared.size&&!e.some(e=>e.autoMargin.horizontal)){const t=[],s=[],r=[];for(const i of e)"right"===i.float?r.push(i):"left"===i.float?s.push(i):t.push(i);const a=new Le(e.parent,e.node,0,0,e.itemCount,e.children);if(a.init(),t.length===a.itemCount||s.length===a.itemCount||r.length===a.itemCount)return this.controllerHandler.processLayoutHorizontal(a),this.renderNode(a);if((0===s.length||0===r.length)&&(this.userSettings.floatOverlapDisabled||!t.some(e=>e.blockStatic))){const e=[];if(0===r.length){e.push(...s,...t);const n=this.controllerHandler.containerTypeHorizontal;a.setType(n.containerType,n.alignmentType),i=[s,t]}else{e.push(...t,...r);const n=this.controllerHandler.containerTypeVerticalMargin;a.setType(n.containerType,n.alignmentType),i=[t,r]}a.retain(e),n=this.renderNode(a)}}const s=[],r=[],a=[],o=[],l=[],c=[];let h=[],d=[];if(0===i.length){let u="",p=0;for(let i=0;i<e.length;i++){const n=e.item(i);if(e.cleared.has(n)){const t=e.cleared.get(n);if(I(p,"right"===t?4:2)||0!==p&&"both"===t)switch(t){case"left":p^=2,u="left";break;case"right":p^=4,u="right";break;case"both":switch(p){case 2:u="left";break;case 4:u="right";break;default:u="both"}p=0}}if(""===u)"right"===n.float?(o.push(n),n.floating&&(p|=4)):"left"===n.float?(a.push(n),n.floating&&(p|=2)):n.autoMargin.horizontal?n.autoMargin.left?o.length?c.push(n):o.push(n):n.autoMargin.right?a.length?l.push(n):a.push(n):s.length?0===a.length?a.push(n):o.push(n):s.push(n):s.push(n);else if("right"===n.float)0===c.length&&(p|=4),!t.floatOverlapDisabled&&"right"!==u&&o.length?o.push(n):c.push(n);else if("left"===n.float)0===l.length&&(p|=2),!t.floatOverlapDisabled&&"left"!==u&&a.length?a.push(n):l.push(n);else if(n.autoMargin.horizontal)n.autoMargin.left&&c.length?c.push(n):n.autoMargin.right&&l.length?l.push(n):r.push(n);else switch(u){case"left":l.push(n);break;case"right":c.push(n);break;default:r.push(n)}}a.length&&l.length?h=[a,l]:a.length?h=a:l.length&&(h=l),o.length&&c.length?d=[o,c]:o.length?d=o:c.length&&(d=c);const f=new Le(e.parent,e.node,0,o.length+c.length===e.length?512:0);if(t.floatOverlapDisabled){if(e.node.groupParent&&e.parent.layoutVertical)e.node.alignmentType|=f.alignmentType,n=qe(e.node.id),e.node.render(e.parent),e.node.renderDepth--;else{const e=this.controllerHandler.containerTypeVertical;f.setType(e.containerType,e.alignmentType),n=this.renderNode(f)}s.length&&i.push(s),(a.length||o.length)&&i.push([a,o]),(l.length||c.length)&&i.push([l,c]),r.length&&i.push(r),f.itemCount=i.length}else{s.length?c.length?i.push(h=[s,a],d):l.length?i.push(d=[s,o],h):i.push(s,h,d):h===l&&d===o||h===a&&d===c?i.push(0===l.length?[a,c]:[o,l]):i.push(h,d),i=i.filter(e=>e.length>0),f.itemCount=i.length;const e=0!==s.length||0!==h.length&&0!==d.length?this.controllerHandler.containerTypeVerticalMargin:this.controllerHandler.containerTypeVertical;f.setType(e.containerType,e.alignmentType),n=this.renderNode(f)}}if(i.length){const r=[s,a,l,o,c];let h;i.forEach((i,l)=>{if(Array.isArray(i[0])){const s=[];i.forEach(e=>s.push(...e)),s.sort(Fe.siblingIndex),h=this.controllerHandler.createNodeGroup(s[0],s,e.node);const r=new Le(e.node,h,0,i.some(e=>e===d||e===o)?512:0,i.length);let a;t.floatOverlapDisabled?a=this.controllerHandler.containerTypeVerticalMargin:e.node.layoutVertical?h=e.node:a=this.controllerHandler.containerTypeVertical,a&&(r.setType(a.containerType,a.alignmentType),n=Ke(n,e.node.id,this.renderNode(r)))}else h=void 0;(Array.isArray(i[0])?i:[i]).forEach(i=>{let c,d=e.node;if(h&&r.includes(i)&&(d=h),i.length>1){c=this.controllerHandler.createNodeGroup(i[0],i,d);const e=new Le(d,c,0,128,i.length,i);if(e.linearY){const t=this.controllerHandler.containerTypeVertical;e.setType(t.containerType,t.alignmentType)}else e.init(),this.controllerHandler.processLayoutHorizontal(e);n=Ke(n,d.id,this.renderNode(e))}else i.length&&((c=i[0]).alignmentType|=2048,c.renderPosition=l,n=Ke(n,d.id,qe(c.renderPositionId)));if(!t.floatOverlapDisabled&&c&&i===s&&i.some(e=>e.blockStatic&&!e.hasWidth)){const e=this.controllerHandler.containerTypeVertical,t=c.of(e.containerType,e.alignmentType)?c.children:[c];if(a.length){const e=W(a.map(e=>e.linear.right)),n=$(i.map(e=>e.bounds.left));t.forEach(t=>t.modifyBox(256,e-n))}if(o.length){const e=$(o.map(e=>e.linear.left)),n=W(i.map(e=>e.bounds.right));t.forEach(t=>t.modifyBox(64,n-e))}}})})}return n}processFloatVertical(e){const t=this.controllerHandler,i=t.containerTypeVertical,n=e.node,s=new Le(e.parent,n,i.containerType,i.alignmentType,e.length);let r=this.renderNode(s);const a=[],o=[],l=[],c=[];let h=!1,d=!1,u=!0;for(const t of e)t.blockStatic&&0===c.length?(l.push(t),d=!0):(e.cleared.has(t)&&(t.floating?h=!0:(t.modifyBox(2,null),a.push(l.slice(0)),l.length=0,o.push(c.slice(0)),c.length=0)),t.floating?(d&&(a.push(l.slice(0)),o.push(null),l.length=0,c.length=0,d=!1),c.push(t)):(h&&!e.cleared.has(t)&&(u=!1),l.push(t)));if(c.length&&o.push(c),l.length&&a.push(l),!u){let s="";for(let l=0;l<Math.max(o.length,a.length);l++){const c=a[l]||[];if(null===o[l]&&c.length)if(c.length>1){const e=t.containerTypeVertical;e.alignmentType|=128;const i=new Le(n,t.createNodeGroup(c[0],c,n),e.containerType,e.alignmentType,c.length,c);s+=this.renderNode(i)}else{const e=c[0];e.alignmentType|=2048,e.renderPosition=l,r=Ke(r,n.id,qe(e.renderPositionId))}else{const r=o[l]||[];if(c.length||r.length){const a=t.createNodeGroup(r[0]||c[0],[],n),o=t.containerTypeVerticalMargin,l=new Le(n,a,o.containerType,o.alignmentType),h=[];let d;r.length&&(r.length>1?(d=t.createNodeGroup(r[0],r,a),l.add(64),0===c.length&&r.every(e=>"right"===e.float)&&l.add(512)):(d=r[0]).parent=a),d&&(h.push(d),d=void 0),c.length&&(c.length>1?d=t.createNodeGroup(c[0],c,a):(d=c[0]).parent=a),d&&h.push(d),a.init(),l.itemCount=h.length,s+=this.renderNode(l),h.forEach(t=>{if(e.contains(t)||0===t.length)s=Ke(s,a.id,qe(t.id));else{const e=new Le(a,t,i.containerType,128|i.alignmentType,t.length,t.children);s=Ke(s,a.id,this.renderNode(e))}})}}}r=Ke(r,n.id,s)}return r}insertNode(e,t){let i=null;if(Ie(e)){const t=this.createNode(e);!this.controllerHandler.localSettings.unsupported.excluded.has(e.tagName)&&this.conditionElement(e)?(i=t).setExclusions():(t.visible=!1,t.excluded=!0,this.processing.excluded.append(t))}else"#"===e.nodeName.charAt(0)&&"#text"===e.nodeName&&(Ae(e,!0)||ue(e,"whiteSpace","pre","pre-wrap"))&&(i=this.createNode(e),t?i.inherit(t,"textStyle"):i.css("whiteSpace",he(e.parentElement).whiteSpace||"normal"),i.cssApply({position:"static",display:"inline",verticalAlign:"baseline",cssFloat:"none",clear:"none"}));return i&&this.processing.cache.append(i),i}conditionElement(e){if(e.parentElement instanceof SVGSVGElement)return!1;if(Ie(e)){if(X(e.dataset.use))return!0;if(ke(e))return!0;{let t=e.parentElement,i=!0;for(;t;){if("none"===he(t).display){i=!1;break}t=t.parentElement}if(i&&e.children.length)return Array.from(e.children).some(e=>{const t=he(e),i=t.cssFloat,n=t.position;return"absolute"===n||"fixed"===n||"left"===i||"right"===i})}return!1}return Ae(e)}setStyleMap(){e:for(let e=0;e<document.styleSheets.length;e++){const t=document.styleSheets[e];if(t.cssRules)for(let e=0;e<t.cssRules.length;e++){const i=t.cssRules[e];try{switch(i.type){case CSSRule.STYLE_RULE:this.applyStyleRule(i);break;case CSSRule.MEDIA_RULE:const e=/(?:(not|only)?\s*(?:all|screen) and )?((?:\([^)]+\)(?: and )?)+),?\s*/g;let t,n=!1;for(;!n&&null!==(t=e.exec(i.conditionText));){const e="not"===t[1],i=/\(([a-z\-]+)\s*(:|<?=?|=?>?)?\s*([\w.%]+)?\)(?: and )?/g;let s,r=!1;for(;!n&&null!==(s=i.exec(t[2]));){const e=s[1];let i;i=s[1].startsWith("min")?">=":s[1].startsWith("max")?"<=":t[2];const n=s[3];switch(e){case"aspect-ratio":case"min-aspect-ratio":case"max-aspect-ratio":const[t,s]=n.split("/").map(e=>parseInt(e));r=ht(i,window.innerWidth/window.innerHeight,t/s);break;case"width":case"min-width":case"max-width":case"height":case"min-height":case"max-height":r=ht(i,-1!==e.indexOf("width")?window.innerWidth:window.innerHeight,parseFloat(S(n,v(he(document.body).fontSize||"16"))));break;case"orientation":r="portrait"===n&&window.innerWidth<=window.innerHeight||"landscape"===n&&window.innerWidth>window.innerHeight;break;case"resolution":case"min-resolution":case"max-resolution":let a=parseFloat(n);n.endsWith("dpcm")?a*=2.54:(n.endsWith("dppx")||n.endsWith("x"))&&(a*=96),r=ht(i,96*window.devicePixelRatio,a);break;case"grid":r="0"===n;break;case"color":r=void 0===n||v(n)>0;break;case"min-color":r=v(n)<=screen.colorDepth/3;break;case"max-color":r=v(n)>=screen.colorDepth/3;break;case"color-index":case"min-color-index":case"monochrome":case"min-monochrome":r="0"===n;break;case"max-color-index":case"max-monochrome":r=v(n)>=0;break;default:r=!1}if(!r)break}(!e&&r||e&&!r)&&(n=!0)}if(n){const e=i.cssRules;for(let t=0;t<e.length;t++)this.applyStyleRule(e[t])}}}catch(e){alert("External CSS files cannot be parsed with some browsers when loading HTML pages directly from your hard drive. Either use a local web server, embed your CSS into a <style> element, or you can also try a different browser. See the README for more detailed instructions.\n\n"+`${t.href}\n\n${e}`);break e}}}}applyStyleRule(e){const t=ee(16),i=[];for(const t of Array.from(e.style))i.push(m(t));document.querySelectorAll(e.selectorText).forEach(n=>{const s=he(n),r=parseInt(S(s.fontSize||"16px",0)),a={};for(const t of i){const i=te(n,t,e.style[t],s,r);""!==i&&(a[t]=i)}for(let e of Array.from(n.style)){const t=te(n,e=m(e),n.style[e],s,r);""!==t&&(a[e]=t)}if(this.userSettings.preloadImages&&X(a.backgroundImage)&&"initial"!==a.backgroundImage)for(const e of a.backgroundImage.split(",")){const t=de(e.trim());""===t||this.session.image.has(t)||this.session.image.set(t,{width:0,height:0,uri:t})}if(t&&void 0===a.display)switch(n.tagName){case"INPUT":case"TEXTAREA":case"SELECT":case"BUTTON":a.display="inline-block"}const o=Ne(n,"styleMap");o?Object.assign(o,a):(Ce(n,"style",s),Ce(n,"styleMap",a))})}set appName(e){this.resourceHandler.fileHandler&&(this.resourceHandler.fileHandler.appName=e)}get appName(){return this.resourceHandler.fileHandler?this.resourceHandler.fileHandler.appName:""}set userSettings(e){this._userSettings=e}get userSettings(){return this._userSettings||{}}get viewData(){return[...this._views,...this._includes]}get sessionData(){return{cache:this.session.cache,views:this._views,includes:this._includes}}get rendered(){return this.session.cache.filter(e=>e.visible&&e.rendered)}get nextId(){return this.processing.cache.nextId}get size(){return this._views.length+this._includes.length}},Container:J,Controller:class{constructor(e,t){this.application=e,this.cache=t,this._before={},this._after={}}reset(){this._before={},this._after={}}replaceRenderQueue(e){for(const t in this._before)e=e.replace(`{<${t}}`,this._before[t].join(""));for(const t in this._after)e=e.replace(`{>${t}}`,this._after[t].join(""));return e}prependBefore(e,t,i=-1){void 0===this._before[e]&&(this._before[e]=[]),-1!==i&&i<this._before[e].length?this._before[e].splice(i,0,t):this._before[e].push(t)}appendAfter(e,t,i=-1){void 0===this._after[e]&&(this._after[e]=[]),-1!==i&&i<this._after[e].length?this._after[e].splice(i,0,t):this._after[e].push(t)}hasAppendProcessing(e){return void 0!==this._before[e]||void 0!==this._after[e]}getEnclosingTag(e,t,i,n=""){const s=G(Math.max(0,i));let r=`{<${t}}`;return r+=""!==n?s+`<${e}${0===i?"{#0}":""}{@${t}}>\n`+n+s+`</${e}>\n`:s+`<${e}${0===i?"{#0}":""}{@${t}} />\n`,r+=`{>${t}}`}removePlaceholders(e){return e.replace(/{[<:@#>]\d+(\^\d+)?}/g,"").trim()}replaceIndent(e,t,i){if(e=Ze(e,t,/^({.*?})(\t*)(<.*)/),i){const n=/{@(\d+)}/g;let s,r=0;for(;null!==(s=n.exec(e));){const e=parseInt(s[1]),n=i.find(t=>t.id===e);n&&(0==r++?n.renderDepth=t:n.renderParent&&(n.renderDepth=n.renderParent.renderDepth+1))}}return e}},Extension:dt,ExtensionManager:class{constructor(e){this.application=e}include(e){const t=this.retrieve(e.name);return t?(Array.isArray(e.tagNames)&&(t.tagNames=e.tagNames),Object.assign(t.options,e.options),!0):!(0!==e.framework&&!I(e.framework,this.application.framework)||!e.dependencies.every(e=>!!this.retrieve(e.name))||(e.application=this.application,this.application.extensions.add(e),0))}exclude(e){return this.application.extensions.delete(e)}retrieve(e){return Array.from(this.application.extensions).find(t=>t.name===e)||null}optionValue(e,t){const i=this.retrieve(e);if(i&&"object"==typeof i.options)return i.options[t]}optionValueAsObject(e,t){const i=this.optionValue(e,t);return"object"==typeof i?i:null}optionValueAsString(e,t){const i=this.optionValue(e,t);return"string"==typeof i?i:""}optionValueAsNumber(e,t){const i=this.optionValue(e,t);return"number"==typeof i?i:0}optionValueAsBoolean(e,t){const i=this.optionValue(e,t);return"boolean"==typeof i&&i}},File:ut,Layout:Le,Node:pt,NodeGroup:class extends pt{init(){if(this.length){let e=Number.MAX_VALUE;for(const t of this.children)e=Math.min(e,t.siblingIndex),t.parent=this;this.siblingIndex===Number.MAX_VALUE&&(this.siblingIndex=e),this.parent&&this.parent.sort(Fe.siblingIndex),this.setBounds();const t=this.actualParent;t&&(this.dir=t.dir),this.saveAsInitial()}}setBounds(e=!1){if(!e&&this.length){const e=this.outerRegion;this._bounds=Object.assign({width:e.right-e.left,height:e.bottom-e.top},e)}}previousSiblings(e=!0,t=!0,i=!1){const n=this.item(0);return n?n.previousSiblings(e,t,i):[]}nextSiblings(e=!0,t=!0,i=!1){const n=this.item();return n?n.nextSiblings(e,t,i):[]}get actualParent(){return Fe.actualParent(this._initial.children)}get firstChild(){const e=Fe.actualParent(this.nodes);if(e){const t=e.element;for(let i=0;i<e.element.childNodes.length;i++){const e=Me(t.childNodes[i]);if(e&&this.nodes.includes(e))return e}}if(this._initial.children.length)return this._initial.children[0]}get lastChild(){const e=Fe.actualParent(this.nodes);if(e){const t=e.element;for(let i=e.element.childNodes.length-1;i>=0;i--){const e=Me(t.childNodes[i]);if(e&&this.nodes.includes(e))return e}}if(this._initial.children.length)return this._initial.children[this._initial.children.length-1]}get inline(){return this.every(e=>e.inline)}get pageFlow(){return this.every(e=>e.pageFlow)}get inlineFlow(){return this.inlineStatic||this.hasAlign(128)}get inlineStatic(){return this.every(e=>e.inlineStatic)}get inlineVertical(){return this.every(e=>e.inlineVertical)}get block(){return this.some(e=>e.block)}get blockStatic(){return this.some(e=>e.blockStatic)}get blockDimension(){return this.some(e=>e.blockDimension)}get floating(){return this.every(e=>e.floating)}get float(){return this.floating?this.hasAlign(512)?"right":"left":"none"}get baseline(){const e=this.cssInitial("verticalAlign",!0);return""!==e?"baseline"===e:this.every(e=>e.baseline)}get multiLine(){return this.children.reduce((e,t)=>e+t.multiLine,0)}get display(){return this.css("display")||this.some(e=>e.block)?"block":this.some(e=>e.blockDimension)?"inline-block":"inline"}get element(){const e=this.cascade(!0);return e.length?e[0].element:super.element}get groupParent(){return!0}get outerRegion(){const e=this.children.slice(0);let t=e[0],i=t,n=t,s=t;this.each(t=>t.companion&&!t.companion.visible&&e.push(t.companion));for(let r=1;r<e.length;r++){const a=e[r];a.linear.top<t.linear.top&&(t=a),a.linear.right>i.linear.right&&(i=a),a.linear.bottom>n.linear.bottom&&(n=a),a.linear.left<s.linear.left&&(s=a)}return{top:t.linear.top,right:i.linear.right,bottom:n.linear.bottom,left:s.linear.left}}},NodeList:Fe,Resource:ot,Svg:class extends J{constructor(e){super(),this.element=e,this.animatable=!0,this.transformable=!1,this.defs={clipPath:new Map,gradient:new Map},this._width=0,this._height=0,this._viewBoxWidth=0,this._viewBoxHeight=0,this._opacity=1,this.name=Et.setName(e),this.animate=Ct.toAnimateList(e),this.visible=xt(e),this.init()}setDimensions(e,t){this._width=e,this._height=t}setViewBox(e,t){this._viewBoxWidth=e,this._viewBoxHeight=t}setOpacity(e){this._opacity=!isNaN(e=parseFloat(""+e))&&e<1?e:1}init(){const e=this.element;if(this.setViewBox(e.viewBox.baseVal.width,e.viewBox.baseVal.height),this.setOpacity(ge(e,"opacity")),this.setDimensions(e.width.baseVal.value,e.height.baseVal.value),ee(16)){const t=Me(e);t&&t.bounds.width>this.width&&t.bounds.height>this.height&&this.setDimensions(t.bounds.width,t.bounds.height)}e.querySelectorAll("clipPath, linearGradient, radialGradient").forEach(e=>{if(e.id)if(e instanceof SVGClipPathElement){const t=new Nt(e);for(const i of Array.from(e.children))if(ft(i)){const e=new Ct(i);e.path&&t.append(e)}t.length&&this.defs.clipPath.set(e.id,t)}else e instanceof SVGLinearGradientElement?this.defs.gradient.set(`@${e.id}`,{type:"linear",x1:e.x1.baseVal.value,x2:e.x2.baseVal.value,y1:e.y1.baseVal.value,y2:e.y2.baseVal.value,x1AsString:e.x1.baseVal.valueAsString,x2AsString:e.x2.baseVal.valueAsString,y1AsString:e.y1.baseVal.valueAsString,y2AsString:e.y2.baseVal.valueAsString,colorStops:Et.createColorStops(e)}):e instanceof SVGRadialGradientElement&&this.defs.gradient.set(`@${e.id}`,{type:"radial",cx:e.cx.baseVal.value,cy:e.cy.baseVal.value,r:e.r.baseVal.value,cxAsString:e.cx.baseVal.valueAsString,cyAsString:e.cy.baseVal.valueAsString,rAsString:e.r.baseVal.valueAsString,fx:e.fx.baseVal.value,fy:e.fy.baseVal.value,fxAsString:e.fx.baseVal.valueAsString,fyAsString:e.fy.baseVal.valueAsString,colorStops:Et.createColorStops(e)})});const t=new Map;let i;function n(e){let n;ft(e)?(n=new Ct(e),e.id&&n.path&&t.set(`#${e.id}`,n.path.d)):gt(e)&&(n=new Mt(e)),i&&n&&i.append(n)}for(let t=0;t<e.children.length;t++){const s=e.children[t];if(s instanceof SVGSVGElement)i=new Bt(s),this.append(i);else if(s instanceof SVGGElement)i=new Nt(s),this.append(i);else{if(!(s instanceof SVGUseElement)){void 0===i&&(i=new Nt(e),this.append(i)),n(s);continue}i=new Rt(s),this.append(i)}for(let e=0;e<s.children.length;e++)n(s.children[e]);i=void 0}this.each(e=>{if(e instanceof Rt){const i=t.get(e.element.href.baseVal);i&&e.setPath(i)}}),this.retain(this.filter(e=>e.length>0||e instanceof Rt&&void 0!==e.path))}get width(){return this._width}get height(){return this._height}get viewBoxWidth(){return this._viewBoxWidth}get viewBoxHeight(){return this._viewBoxHeight}get opacity(){return this._opacity}get transform(){return this.element.transform.baseVal}},SvgAnimate:_t,SvgAnimateMotion:Tt,SvgAnimateTransform:It,SvgAnimation:wt,SvgBuild:Et,SvgElement:Ct,SvgGroup:Nt,SvgGroupViewBox:Bt,SvgImage:Mt,SvgPath:kt,SvgUse:Rt},extensions:{Accessibility:class extends dt{afterInit(){for(const e of this.application.processing.cache.elements){const t=e.baseElement;if(t instanceof HTMLInputElement&&!e.hasBit("excludeProcedure",n.ACCESSIBILITY))switch(t.type){case"radio":case"checkbox":[_e(t),Te(t)].some(i=>{if(i){const n=Me(i),s=i.parentElement&&"LABEL"===i.parentElement.tagName?Me(i.parentElement):null;if(n&&n.visible&&n.pageFlow&&(X(i.htmlFor)&&i.htmlFor===t.id?e.companion=n:n.textElement&&s&&(e.companion=n,s.renderAs=e),e.companion))return this.options&&!this.options.showLabel&&n.hide(),!0}return!1})}}}},CssGrid:Dt,External:class extends dt{beforeInit(e,t=!1){if((t||this.included(e))&&!Ne(e,"andromeExternalDisplay")){const t=[];let i=e;for(;i;)t.push(he(i).display),i.style.display="block",i=i.parentElement;Ce(e,"andromeExternalDisplay",t)}}init(e){return this.included(e)&&this.application.parseElements.add(e),!1}afterInit(e,t=!1){if(t||this.included(e)){const t=Ne(e,"andromeExternalDisplay");if(t){const i=t;let n=e,s=0;for(;n;)n.style.display=i[s],n=n.parentElement,s++;Be(e,"andromeExternalDisplay")}}}},Flexbox:Pt,Grid:Vt,List:Gt,Relative:class extends dt{condition(e){return e.positionRelative&&!e.positionStatic||0!==v(e.cssInitial("verticalAlign"))}processNode(){return{output:"",include:!0}}postProcedure(e){const t=e.renderParent;if(t){let i=e;const n=v(e.verticalAlign);if(t.support.container.positionRelative&&0===e.length&&(0!==e.top||0!==e.bottom||0!==n)){i=e.clone(this.application.nextId,!0,!0),e.hide(!0);const n=new Le(t,i,i.containerType,i.alignmentType);this.application.controllerHandler.appendAfter(e.id,this.application.renderLayout(n)),this.application.session.cache.append(i,!1),t.renderEach(t=>{t.alignSibling("topBottom")===e.documentId?t.alignSibling("topBottom",i.documentId):t.alignSibling("bottomTop")===e.documentId&&t.alignSibling("bottomTop",i.documentId)})}0!==e.top?i.modifyBox(2,e.top):0!==e.bottom&&i.modifyBox(2,-1*e.bottom),0!==n&&i.modifyBox(2,-1*n),0!==e.left?i.autoMargin.left?i.modifyBox(4,-1*e.left):i.modifyBox(16,e.left):0!==e.right&&i.modifyBox(16,-1*e.right)}}},Sprite:class extends dt{condition(e){let t=!1;if(e.hasWidth&&e.hasHeight&&0===e.length&&!e.inlineText){let i=e.css("backgroundImage");if(!X(i)||"none"===i){i="";const t=c.CSS_URL.exec(e.css("background"));t&&(i=t[0])}if(""!==i){i=de(i);const n=this.application.session.image.get(i);if(n){const i=e.fontSize,s=oe(e.has("width")?e.css("width"):e.css("minWidth"),e.bounds.width,i),r=oe(e.has("height")?e.css("width"):e.css("minHeight"),e.bounds.height,i),a=ve(`${e.css("backgroundPositionX")} ${e.css("backgroundPositionY")}`,e.bounds,i);a.left<=0&&a.top<=0&&n.width>s&&n.height>r&&(n.position={x:a.left,y:a.top},e.data(l.SPRITE,"mainData",n),t=!0)}}}return t&&(!X(e.dataset.use)||this.included(e.element))}},Substitute:class extends dt{constructor(e,t,i,n){super(e,t,i,n),this.require(l.EXTERNAL,!0)}processNode(e,t){const i=ie(e.element,this.name);let n="";return i.tag&&(e.setControlType(i.tag),e.render(t),n=this.application.controllerHandler.renderNodeStatic(i.tag,e.renderDepth,{},"","",e,e.length>0)),i.tagChild&&e.each(e=>{e.styleElement&&(e.dataset.use=this.name,e.dataset.andromeSubstituteTag=i.tagChild)}),{output:n}}},Table:Ht,VerticalAlign:class extends dt{condition(e){return e.length>1&&e.some(e=>e.inlineVertical&&0!==v(e.verticalAlign))&&Fe.linearX(e.children)}processNode(e){const t=[];let i=[],n=Number.MAX_VALUE;return e.each(e=>{e.inlineVertical&&e.linear.top<=n&&(e.linear.top<n&&(i.length=0),i.push(e),n=e.linear.top)}),e.every(e=>e.positionStatic||e.positionRelative&&e.length>0)?i.length!==e.length&&e.each(e=>{let n=!1;i.includes(e)?n=!0:e.inlineVertical&&!e.baseline&&B(e.verticalAlign)&&(e.modifyBox(2,e.linear.top-i[0].linear.top),t.push(e),n=!0),n&&e.css("verticalAlign","0px",!0)}):i=i.filter(e=>B(e.verticalAlign)&&v(e.verticalAlign)>0),i.length&&e.data(l.VERTICAL_ALIGN,"mainData",{aboveBaseline:i,belowBaseline:t}),{output:""}}postProcedure(e){const t=e.data(l.VERTICAL_ALIGN,"mainData");if(t){const i=e.find(e=>e.baselineActive);i?i.modifyBox(2,i.linear.top-t.aboveBaseline[0].linear.top):[...t.belowBaseline,...t.aboveBaseline].some(e=>{const t=v(e.cssInitial("verticalAlign"));return t>0&&(e.modifyBox(8,t),!0)})}}},WhiteSpace:class extends dt{afterBaseLayout(){const e=new Set;for(const t of this.application.processing.cache)if(t.htmlElement&&t.blockStatic){let i,n;for(let s=0;s<t.element.children.length;s++){let r=Me(t.element.children[s]);if(r&&r.pageFlow&&(void 0===i&&(i=r),n=r,!r.lineBreak&&r.blockStatic)){const t=r.previousSiblings();if(t.length){let i=t[0];if(i.blockStatic&&!i.lineBreak){i=i.renderAs||i;let t=v((r=r.renderAs||r).cssInitial("marginTop",!1,!0));const n=v(r.cssInitial("marginBottom",!1,!0)),s=v(i.cssInitial("marginTop",!1,!0));let a=v(i.cssInitial("marginBottom",!1,!0));if(i.excluded&&!r.excluded){const n=Math.min(s,a);n<0&&(r.modifyBox(2,Math.abs(n)>=t?null:n),e.add(i))}else if(!i.excluded&&r.excluded){const s=Math.min(t,n);s<0&&(i.modifyBox(8,Math.abs(s)>=a?null:s),e.add(r))}else{if(0===t&&r.length>0){const e=r.firstChild;e&&e.blockStatic&&(t=v(e.cssInitial("marginTop",!1,!0)),r=e)}if(0===a&&i.length>0){const e=i.lastChild;e&&e.blockStatic&&(a=v(e.cssInitial("marginBottom",!1,!0)),i=e)}a>0&&t>0&&(t<=a?r.modifyBox(2,null):i.modifyBox(8,null))}}}}}i&&Wt(t,i,!0),n&&Wt(t,n,!1)}this.application.processing.node&&K(Array.from(this.application.processing.node.element.getElementsByTagName("BR")),e=>Me(e)).forEach(t=>{if(!e.has(t)){const i=t.actualParent,n=t.previousSiblings(!0,!0,!0),s=t.nextSiblings(!0,!0,!0);let r=!1;if(n.length&&s.length){if(s[0].lineBreak)return;{r=!0;const a=n.pop(),o=s.pop();if(a.inlineStatic&&o.inlineStatic&&0===n.length)return void e.add(t);let l,c;a.lineHeight>0&&a.cssTry("lineHeight","0px")?(l=a.element.getBoundingClientRect().bottom+a.marginBottom,a.cssFinally("lineHeight")):l=a.linear.bottom,o.lineHeight>0&&o.cssTry("lineHeight","0px")?(c=o.element.getBoundingClientRect().top-o.marginTop,o.cssFinally("lineHeight")):c=o.linear.top;const h=a.visible?a.renderParent:void 0,d=o.visible?o.renderParent:void 0,u=c-l;u>0&&(d&&d.groupParent&&d.firstChild===o?d.modifyBox(2,u):h&&h.groupParent&&h.lastChild===a?h.modifyBox(8,u):d&&d.layoutVertical&&(o.visible||o.renderAs)?(o.renderAs||o).modifyBox(2,u):h&&h.layoutVertical&&(a.visible||a.renderAs)?(a.renderAs||a).modifyBox(8,u):!d&&!h&&i&&i.visible?o.lineBreak||o.excluded?i.modifyBox(128,u):a.lineBreak||a.excluded?i.modifyBox(32,u):r=!1:r=!1)}}else if(i&&i.visible){if(!i.documentRoot&&n.length){const e=n[n.length-1],t=i.box.bottom-e.linear[e.lineBreak||e.excluded?"top":"bottom"];t>0&&(e.visible?i.modifyBox(128,t):i.hasHeight||$t(i,t))}else if(s.length){const e=s[s.length-1],t=e.linear[e.lineBreak||e.excluded?"bottom":"top"]-i.box.top;t>0&&(e.visible?i.modifyBox(32,t):i.hasHeight||$t(i,t))}r=!0}r&&(e.add(t),n.forEach(t=>e.add(t)),s.forEach(t=>e.add(t)))}});for(const t of this.application.processing.excluded)if(!e.has(t)&&!t.lineBreak){const i=t.marginTop+t.marginBottom;if(0!==i){const n=t.nextSiblings(!0,!0,!0);if(n.length){const s=n.pop();s.visible&&(s.modifyBox(2,i),e.add(t))}}}}afterConstraints(){for(const e of this.application.processing.cache){const t=e.renderAs?e.renderAs.renderParent:e.renderParent;if(t&&e.pageFlow&&!t.hasAlign(4)&&!e.alignParent("left")&&e.styleElement&&e.inlineVertical){const t=[];let i=e;for(;;){if(t.push(...i.previousSiblings()),t.length&&!t.some(e=>e.lineBreak||e.excluded&&e.blockStatic)){const n=t[t.length-1];if(n.inlineVertical){const i=e.linear.left-t[t.length-1].actualRight();i>0&&(e.renderAs||e).modifyBox(16,i)}else if(n.floating){t.length=0,i=n;continue}}break}}}}}},color:Ye,constant:h,dom:Re,enumeration:s,svg:St,util:Q,xml:Je};e.close=function(){zt&&!zt.initialized&&zt.size&&zt.finalize()},e.configure=qt,e.exclude=function(e){if(zt){if(e instanceof dt)return Ut.has(e)?(Ut.delete(e),zt.extensionManager.exclude(e),!0):zt.extensionManager.exclude(e);if(C(e)){e=e.trim();const t=zt.extensionManager.retrieve(e);if(t)return zt.extensionManager.exclude(t)}}return!1},e.ext=function(e,t){return e instanceof dt?Yt(e):!!C(e)&&(e=e.trim(),"object"==typeof t?qt(e,t):Kt(e))},e.include=Yt,e.includeAsync=function(t){return!!Yt(t)||!!(t instanceof dt&&(Ut.add(t),e.settings.handleExtensionsAsync))},e.lib=Qt,e.parseDocument=function t(...i){if(zt&&!zt.closed){if(e.settings.handleExtensionsAsync){Ut.forEach(e=>zt.extensionManager.include(e));for(const[e,t]of jt.entries())qt(e,t);Ut.clear(),jt.clear()}return zt.parseDocument(...i)}return{then:e=>{zt?zt.closed&&confirm("ERROR: Document is closed. Reset and rerun?")&&(zt.reset(),t(...arguments).then(e)):alert("ERROR: Framework not installed.")}}},e.ready=function(){return zt&&!zt.initialized&&!zt.closed},e.reset=Zt,e.retrieve=Kt,e.saveAllToDisk=function(){zt&&!zt.initialized&&zt.size&&(zt.closed||zt.finalize(),zt.saveAllToDisk())},e.setFramework=function(t,i=!1){if(Xt!==t){const n=i?t.cached():t.create();if(e.settings=zt||0===Object.keys(e.settings).length?n.userSettings:Object.assign(n.userSettings,e.settings),(zt=n.application).userSettings=e.settings,Array.isArray(e.settings.builtInExtensions)){const t=new Set;for(let i of e.settings.builtInExtensions)if(i=i.trim(),zt.builtInExtensions[i])t.add(zt.builtInExtensions[i]);else for(const e in zt.builtInExtensions)e.startsWith(`${i}.`)&&t.add(zt.builtInExtensions[e]);t.forEach(e=>zt.extensionManager.include(e))}Xt=t,e.system=t.system}Zt()},e.toString=function(){return zt?""+zt:""},Object.defineProperty(e,"__esModule",{value:!0})});
